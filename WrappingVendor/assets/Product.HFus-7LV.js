import{u as I,o as S,m as E,A as p,a as g,n as A,e as k,j as e,f as M,h as O,k as D}from"./index.saRe6un4.js";import{u as U,P as R}from"./usePagination.B4OasDjR.js";import{u as V}from"./useModal.D92FPtk9.js";import{C as _}from"./ConfirmationModal.DlA_O5hq.js";import{C as z,E as $}from"./eye.CZ3b4Pdd.js";import{X as L}from"./x.DmoOITHN.js";import{P as T}from"./PageHeadline.DEQVQ-lh.js";const F=async t=>(await g.get("get-product",{params:t})).data,G=({pageSize:t=10,pageNumber:r=1,productStatus:a})=>I({queryKey:["products",t,r,a],queryFn:()=>F({pageSize:t,pageNumber:r,productStatus:a}),staleTime:1e3*60}),q=async t=>{const{_id:r,...a}=t;return(await g.put(`update-product/${r}`,a)).data},b=()=>{const t=S();return E({mutationFn:q,onSuccess:r=>{p.success(r?.message||"Product updated successfully!"),t.invalidateQueries({queryKey:["products"],exact:!1})},onError:r=>{p.error(r?.response?.data?.message||"Update failed!")}})},B=({isOpen:t,onClose:r,product:a})=>{const{register:n,handleSubmit:l,reset:d}=A({defaultValues:a||{}}),{mutate:c,isPending:m}=b();k.useEffect(()=>{a&&d(a)},[a,d]);const u=i=>{a&&c({_id:a._id,name:i.name,description:i.description,manufacturingInfo:i.manufacturingInfo},{onSuccess:()=>{r()}})};return!t||!a?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-lg shadow-lg p-6 overflow-y-auto max-h-[90vh]",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Update Product"}),e.jsxs("form",{onSubmit:l(u),className:"grid gap-6",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg border-b pb-1",children:"Product Details"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{...n("name",{required:!0}),placeholder:"Product Name",className:"border p-2 rounded w-full"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{...n("description"),placeholder:"Product Description",className:"border p-2 rounded w-full resize-none",rows:3})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg border-b pb-1",children:"Manufacturing Info"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Generic Name"}),e.jsx("input",{...n("manufacturingInfo.genericName"),placeholder:"Generic Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Country of Origin"}),e.jsx("input",{...n("manufacturingInfo.countryOfOrigin"),placeholder:"Country of Origin",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Manufacturer Name"}),e.jsx("input",{...n("manufacturingInfo.manufacturer.name"),placeholder:"Manufacturer Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Manufacturer Contact"}),e.jsx("input",{...n("manufacturingInfo.manufacturer.contact"),placeholder:"Manufacturer Contact",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Importer Name"}),e.jsx("input",{...n("manufacturingInfo.importer.name"),placeholder:"Importer Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Importer Contact"}),e.jsx("input",{...n("manufacturingInfo.importer.contact"),placeholder:"Importer Contact",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Packer Name"}),e.jsx("input",{...n("manufacturingInfo.packer.name"),placeholder:"Packer Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Packer Contact"}),e.jsx("input",{...n("manufacturingInfo.packer.contact"),placeholder:"Packer Contact",className:"border p-2 rounded"})]})]})]}),e.jsx("button",{type:"submit",disabled:m,className:`p-3 rounded text-white w-full mt-4 ${m?"bg-yellow-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,children:m?"Updating...":"Update Product"}),e.jsx("button",{type:"button",onClick:r,className:"p-3 rounded border mt-2 w-full hover:bg-gray-100 transition",children:"Cancel"})]})]})})},Q=({products:t,startItem:r,isPending:a})=>{const{mutate:n,isPending:l}=b(),{user:d,isLoading:c}=M(),{isModalOpen:m,openModal:u,closeModal:i,data:o}=V(),x=d?.role==="ADMIN"||d?.role==="VENDOR",h=(s,f)=>{u({isConfirm:!0},{productId:s,productStatus:f})},j=()=>{o?.productId&&o?.productStatus&&n({_id:o.productId,productStatus:o.productStatus},{onSuccess:()=>i({isConfirm:!1})})},N=s=>{n({_id:s._id,isActive:!s.isActive})},y=()=>i({isConfirm:!1}),P=s=>{switch(s){case"APPROVED":return"text-green-600 font-semibold";case"REJECTED":return"text-red-600 font-semibold";default:return"text-yellow-600 font-semibold"}},v=s=>s==="APPROVED"?"Are you sure you want to approve this product?":"Are you sure you want to reject this product?";return t.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"text-center p-4 text-gray-500",children:"No Products Found"})})}):e.jsxs(e.Fragment,{children:[e.jsx("tbody",{children:t.map((s,f)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 border text-center",children:f+r}),e.jsx("td",{className:"p-2 border font-semibold",children:s.name}),e.jsx("td",{className:"p-2 border",children:s.category?.name||"-"}),e.jsx("td",{className:"p-2 border",children:s.brand?.name||"-"}),e.jsx("td",{className:`p-2 border text-center ${P(s.productStatus||"PENDING")}`,children:s.productStatus||"PENDING"}),e.jsx("td",{className:"p-2 border",children:e.jsx("div",{className:"flex space-x-2",children:s.images?.map((w,C)=>e.jsx("img",{src:w,alt:s.name,className:"w-12 h-12 object-cover rounded"},C))})}),e.jsxs("td",{className:"p-2 border text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Generic:"})," ",s.manufacturingInfo?.genericName||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Origin:"})," ",s.manufacturingInfo?.countryOfOrigin||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Manufacturer:"})," ",s.manufacturingInfo?.manufacturer?.name," (",s.manufacturingInfo?.manufacturer?.contact,")"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Importer:"})," ",s.manufacturingInfo?.importer?.name," (",s.manufacturingInfo?.importer?.contact,")"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Packer:"})," ",s.manufacturingInfo?.packer?.name," (",s.manufacturingInfo?.packer?.contact,")"]})]}),e.jsx("td",{className:"p-3 border text-center w-1 whitespace-nowrap",children:e.jsx(J,{checked:s.isActive??!1,onChange:()=>N(s),disabled:l})}),e.jsxs("td",{className:"p-2 border text-center flex justify-center gap-2",children:[a&&x&&!c&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"p-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",title:"Approve",disabled:l,onClick:()=>h(s._id,"APPROVED"),children:e.jsx(z,{size:18})}),e.jsx("button",{className:"p-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",title:"Reject",disabled:l,onClick:()=>h(s._id,"REJECTED"),children:e.jsx(L,{size:18})})]}),s.productStatus==="APPROVED"&&x&&!c&&e.jsx("button",{className:"p-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",title:"Update Product",onClick:()=>u({isUpdate:!0},{product:s}),children:"Update"}),e.jsx(O,{to:`/products/variant/${s._id}`,className:"inline-flex items-center justify-center p-2 bg-blue-600 hover:bg-blue-700 text-white rounded",children:e.jsx($,{size:20})})]})]},s._id))}),e.jsx(_,{isOpen:m.isConfirm||!1,onClose:y,onConfirm:j,title:o?.productStatus==="APPROVED"?"Approve Product":"Reject Product",message:v(o?.productStatus),confirmText:o?.productStatus==="APPROVED"?"Approve":"Reject",confirmButtonClass:o?.productStatus==="APPROVED"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",isLoading:l}),e.jsx(B,{isOpen:m.isUpdate||!1,onClose:()=>i({isUpdate:!1}),product:o?.product||null})]})},J=({checked:t,onChange:r,disabled:a=!1})=>e.jsx("button",{type:"button",onClick:a?void 0:r,disabled:a,className:`
        relative inline-flex items-center
        h-6 w-11 rounded-full transition-colors duration-300
        ${t?"bg-green-500":"bg-gray-300"}
        ${a?"opacity-50 cursor-not-allowed":"cursor-pointer"}
      `,children:e.jsx("span",{className:`
          absolute top-0.5 left-0.5
          h-5 w-5 bg-white rounded-full shadow-md
          transform transition-transform duration-300
          ${t?"translate-x-5":""}
        `})}),se=({status:t})=>{const{startItem:r,handlePageChange:a,handlePageSizeChange:n,pageNumber:l,pageSizeValue:d}=U(),{data:c,isLoading:m}=G({pageSize:d,pageNumber:l,productStatus:t}),u=x=>x.charAt(0).toUpperCase()+x.slice(1).toLowerCase();if(m)return e.jsx(D,{});const i=t?`${u(t)} Products`:"Products",o=t?`Manage and view all ${u(t)} products here`:"Manage and view all products here";return e.jsxs("div",{className:"p-4",children:[e.jsx(T,{title:i,subtitle:o}),e.jsx("div",{className:"overflow-x-auto overflow-y-auto border rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"min-w-full border border-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"S.No"}),e.jsx("th",{className:"p-2 border",children:"Name"}),e.jsx("th",{className:"p-2 border",children:"Category"}),e.jsx("th",{className:"p-2 border",children:"Brand"}),e.jsx("th",{className:"p-2 border",children:"Status"}),e.jsx("th",{className:"p-2 border",children:"Images"}),e.jsx("th",{className:"p-2 border",children:"Manufacturing Info"}),e.jsx("th",{className:"p-2 border",children:"Active"}),e.jsx("th",{className:"p-2 border",children:"Action"})]})}),e.jsx(Q,{products:c?.results||[],startItem:r,isPending:t==="PENDING"})]})}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("span",{className:"text-gray-600 text-sm",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:c?.results?.length||0})," ","of"," ",e.jsx("span",{className:"font-medium",children:c?.pagination?.total||0})," ","products"]}),e.jsx(R,{currentPage:l,handlePageChange:a,pageSize:d,handlePageSizeChange:n,totalCount:c?.pagination?.total||0})]})]})};export{se as default};
