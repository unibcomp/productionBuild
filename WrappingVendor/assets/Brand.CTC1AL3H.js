import{m as A,o as z,z as B,a as F,j as e,e as i,k as E,E as D}from"./index.BKgSVtDm.js";import{u as I,P as M}from"./usePagination.baahLJht.js";import{b as T,u as _}from"./useCreateProduct.BTbAg1wz.js";import{X as q}from"./x.BWloLBIT.js";import{K as N}from"./transition.CcNEcUdy.js";import{h as v}from"./dialog.y9ZADTrG.js";const O=async a=>{const t=new FormData;return t.append("name",a.name),t.append("category",a.category),t.append("image",a.image),(await F.post("/create-brand",t,{headers:{"Content-Type":"multipart/form-data"}})).data},U=()=>A({mutationFn:O}),R=async({id:a,data:t})=>{const o=new FormData;return t.name&&o.append("name",t.name),t.category&&o.append("category",t.category),typeof t.isActive=="boolean"&&o.append("isActive",String(t.isActive)),t.image&&o.append("image",t.image),(await F.put(`/update-brand/${a}`,o,{headers:{"Content-Type":"multipart/form-data"}})).data},k=()=>{const a=z();return A({mutationFn:R,onSuccess:t=>{B.success(t?.message||"Brand updated successfully!"),a.invalidateQueries({queryKey:["get-brand"]})},onError:t=>{B.error(t?.message||"Failed to update brand")}})},$=({brands:a,startItem:t,refetch:o,onOpenModal:d})=>{const{mutate:m,isPending:n}=k(),c=(s,l)=>{m({id:s,data:{isActive:!l}},{onSuccess:()=>o()})};return a.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-4 text-gray-500",children:"No Brands Found"})})}):e.jsx("tbody",{children:a.map((s,l)=>e.jsxs("tr",{className:"border-t hover:bg-gray-50 text-center transition",children:[e.jsx("td",{className:"p-3 border text-sm font-medium",children:t+l}),e.jsx("td",{className:"p-3 border",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"h-10 w-20 object-contain mx-auto"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})}),e.jsx("td",{className:"p-3 border text-sm",children:s.name}),e.jsx("td",{className:"p-3 border text-sm",children:s.category.name}),e.jsx("td",{className:"p-3 border text-sm",children:s.description||"-"}),e.jsx("td",{className:"p-3 border text-sm",children:e.jsx("button",{type:"button",onClick:()=>c(s._id,s.isActive),disabled:n,className:`relative w-11 h-6 rounded-full transition-colors duration-300 ${s.isActive?"bg-green-500":"bg-gray-300"} ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-300 ${s.isActive?"translate-x-5":""}`})})}),e.jsx("td",{className:"p-3 border",children:e.jsx("button",{onClick:()=>d(s),className:"px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition",children:"Edit"})})]},s._id))})},K=({isOpen:a,onClose:t,categories:o,isCategoriesLoading:d,onSubmit:m,viewBrand:n,isUpdate:c=!1})=>{const[s,l]=i.useState(""),[u,x]=i.useState(null),[g,p]=i.useState("");i.useEffect(()=>{n?(l(n.name),p(n.category._id)):a||(l(""),x(null),p(""))},[n,a]);const j=r=>{r.preventDefault(),m({name:s,category:g,image:u})};return e.jsx(N,{appear:!0,show:a,as:i.Fragment,children:e.jsxs(v,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(N.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",children:e.jsx("div",{className:"fixed inset-0 bg-black/40"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(N.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",children:e.jsxs(v.Panel,{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(v.Title,{className:"text-lg font-semibold",children:c?"Update Brand":"Add New Brand"}),e.jsx("button",{onClick:t,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(q,{size:20})})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Name"}),e.jsx("input",{type:"text",value:s,onChange:r=>l(r.target.value),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter brand name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),d?e.jsx("p",{className:"text-gray-500 text-sm",children:"Loading categories..."}):e.jsxs("select",{value:g,onChange:r=>p(r.target.value),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500",required:!0,children:[e.jsx("option",{value:"",children:"Select category"}),o.map(r=>e.jsx("option",{value:r._id,children:r.name},r._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Logo"}),n?.image&&!u&&e.jsx("img",{src:n.image,alt:n.name,className:"w-24 h-24 object-cover rounded-lg border mb-2"}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>x(r.target.files?.[0]||null),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500",required:!c}),u&&e.jsx("img",{src:URL.createObjectURL(u),alt:"Preview",className:"w-20 h-20 object-cover rounded-lg mt-2 border"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:c?"Update Brand":"Add Brand"})]})]})]})})})]})})},W=()=>{const{startItem:a,handlePageChange:t,handlePageSizeChange:o,pageNumber:d,pageSizeValue:m}=I(),{data:n,isLoading:c,error:s,refetch:l}=T({pageNumber:d,pageSize:m}),{data:u,isLoading:x}=_(),{mutate:g}=U(),{mutate:p}=k(),[j,r]=i.useState(!1),[h,f]=i.useState(null),[w,C]=i.useState(!1);if(c)return e.jsx(E,{});if(s)return e.jsx(D,{message:"Failed to load brands",onRetry:l});const S=n?.results??[],L=n?.pagination?.total??S.length,y=()=>{r(!1),f(null)},P=b=>{w&&h?p({id:h._id,data:b},{onSuccess:()=>{l(),y()}}):g(b,{onSuccess:()=>{l(),y()}})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Brands"}),e.jsx("button",{onClick:()=>{f(null),C(!1),r(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition",children:"+ Add Brand"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-center font-semibold",children:"S.No"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Logo"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Brand"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Category"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Description"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Status"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Action"})]})}),e.jsx($,{brands:S,startItem:a,refetch:l,onOpenModal:b=>{f(b),C(!0),r(!0)}})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(M,{currentPage:d,handlePageChange:t,pageSize:m,handlePageSizeChange:o,totalCount:L})}),e.jsx(K,{isOpen:j,onClose:y,categories:u?.results??[],isCategoriesLoading:x,onSubmit:P,viewBrand:h,isUpdate:w})]})};export{W as default};
