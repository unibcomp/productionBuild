import{o as w,n as C,e as u,j as e,a as y,y as _,k as S,h as N}from"./index.saRe6un4.js";import{u as k,d as A}from"./useCreateProduct.CGS9W3yu.js";import{u as F,P}from"./usePagination.B4OasDjR.js";import{u as E}from"./useDomain.DBbHUt9K.js";import{h as b}from"./dialog.D0se9jud.js";import{X as z}from"./x.DmoOITHN.js";import{K as f}from"./transition.B7y8uWB-.js";import{u as T}from"./useModal.D92FPtk9.js";import{m as v}from"./proxy.CGF8wzVI.js";const q=({isOpen:d,onClose:r,isUpdate:n,initialData:i})=>{const x=w(),{register:s,handleSubmit:p,reset:o,watch:h,formState:{errors:l}}=C(),{data:g}=E(),m=h("website_id");u.useEffect(()=>{o(n&&i?{name:i.name||""}:{name:"",image:void 0})},[n,i,o]);const c=async a=>{try{const t=new FormData;t.append("name",a.name),a.image&&a.image.length>0&&t.append("image",a.image[0]),a.website_id&&t.append("website_id",a.website_id),n&&i?._id?await y.put(`/update-category/${i._id}`,t,{headers:{"Content-Type":"multipart/form-data"}}):await y.post("/create-category",t,{headers:{"Content-Type":"multipart/form-data"}}),await x.invalidateQueries({queryKey:["get-category"]}),r()}catch(t){console.error("Error saving category:",t)}};return e.jsx(f,{appear:!0,show:d,as:u.Fragment,children:e.jsxs(b,{as:"div",className:"relative z-50",onClose:r,children:[e.jsx(f.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(f.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(b.Panel,{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(b.Title,{className:"text-lg font-semibold",children:n?"Edit Category":"Add Category"}),e.jsx("button",{type:"button",onClick:r,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(z,{size:20})})]}),e.jsxs("form",{onSubmit:p(c),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Domain"}),e.jsxs("select",{...s("website_id",{required:"Domain is required"}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select domain"}),g?.results?.map(a=>e.jsx("option",{value:a._id,children:a.domain},a._id))]}),l.website_id&&e.jsx("p",{className:"text-red-500 text-sm",children:l.website_id.message})]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...s("name",{required:"Category name is required"}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-pink-300"}),l.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image"}),e.jsx("input",{type:"file",accept:"image/*",...s("image"),className:"w-full"}),i?.image&&n&&e.jsx("img",{src:i.image,alt:"Current",className:"mt-2 w-16 h-16 object-cover rounded border"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-pink-600 text-white hover:bg-pink-700",children:n?"Update":"Create"})]})]})]})]})})})]})})},B=()=>{const{pageNumber:d,pageSizeValue:r,handlePageChange:n,handlePageSizeChange:i}=F(),{website_id:x}=_(),{data:s,isLoading:p,isError:o}=k({pageNumber:d,pageSize:r,website_id:x}),{mutateAsync:h,isPending:l}=A(),{data:g,isModalOpen:m,openModal:c,closeModal:a}=T();return p?e.jsx(S,{}):o?e.jsx("div",{className:"p-4 text-red-500",children:"Error loading data"}):e.jsxs("div",{className:"p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"All Categories"}),e.jsx("button",{onClick:()=>c({isCreate:!0}),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition",children:"+ Add Category"})]}),!s?.results||s.results.length===0?e.jsx("p",{children:"No categories found"}):e.jsx(v.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.4},className:"overflow-x-auto overflow-y-auto max-h-[400px] rounded-lg shadow-sm custom-scrollbar",children:e.jsxs("table",{className:"min-w-full text-sm bg-white rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{className:"divide-x divide-gray-200",children:[e.jsx("th",{className:"p-3 text-left font-medium w-16",children:"S.No"}),e.jsx("th",{className:"p-3 text-center font-medium w-28",children:"Image"}),e.jsx("th",{className:"p-3 text-left font-medium w-40",children:"Name"}),e.jsx("th",{className:"p-3 text-left font-medium w-48",children:"Domain"}),e.jsx("th",{className:"p-3 text-center font-medium w-32",children:"Status"}),e.jsx("th",{className:"p-3 text-center font-medium w-28",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:s.results.length>=1&&s.results.map((t,j)=>e.jsxs(v.tr,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:j*.05},className:"hover:bg-gray-50 transition-all duration-200",children:[e.jsx("td",{className:"p-3 align-middle",children:(d-1)*r+(j+1)}),e.jsx("td",{className:"p-3 align-middle",children:t.image?e.jsx("img",{src:t.image,alt:t.name,className:"w-12 h-12 object-cover rounded-md border mx-auto"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center text-gray-500 text-xs mx-auto",children:"No Image"})}),e.jsx("td",{className:"p-3 align-middle font-medium text-gray-800",children:t.name}),e.jsx("td",{className:"p-3 align-middle text-gray-700",children:t.website_id?.domain||"N/A"}),e.jsx("td",{className:"p-3 align-middle text-center",children:e.jsx("button",{type:"button",onClick:()=>h({id:t._id,isActive:!t.isActive}),disabled:l,className:`relative w-11 h-6 rounded-full overflow-hidden transition-all duration-500 ease-in-out
              ${t.isActive?"bg-green-500":"bg-gray-300"}
              ${l?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transform transition-all duration-500 ease-in-out
                ${t.isActive?"translate-x-[20px]":"translate-x-0"}`})})}),e.jsxs("td",{className:"p-3 align-middle text-center flex gap-2 justify-center",children:[e.jsx("button",{onClick:()=>c({isUpdate:!0},t),className:"px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition",children:"Edit"}),e.jsx(N,{to:`/brand/${t._id}`,className:"px-3 py-1 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition",children:"Brand"}),e.jsx(N,{to:`/subcategory/${t._id}`,className:"px-3 py-1 bg-amber-500 text-white rounded-md hover:bg-amber-600 transition",children:"Subcategory"})]})]},t._id))})]})}),s?.pagination?.total?e.jsx(P,{currentPage:d,handlePageChange:n,pageSize:r,handlePageSizeChange:i,totalCount:s?.pagination?.total??0}):null,e.jsx(q,{isOpen:m.isCreate||m.isUpdate||!1,onClose:()=>a({isCreate:!1,isUpdate:!1}),initialData:g||void 0,isUpdate:m.isUpdate||!1})]})};export{B as default};
