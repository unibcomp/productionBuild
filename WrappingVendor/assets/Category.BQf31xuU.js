import{o as b,n as N,e as p,j as e,a as y,i as v}from"./index.Bl21YcIX.js";import{u as w,d as C}from"./useCreateProduct.SIejRaB2.js";import{u as k,P as S}from"./usePagination.Bryztp_7.js";import{h as g}from"./dialog.CLMgx9WP.js";import{X as A}from"./x.Da9aEPU9.js";import{K as f}from"./transition.C1xflrUe.js";import{u as F}from"./useModal.DWm-5Dui.js";import{m as x}from"./proxy.CKlX1Vcd.js";const E=({isOpen:n,onClose:l,isUpdate:t,initialData:s})=>{const m=b(),{register:o,handleSubmit:h,reset:d,formState:{errors:u}}=N();p.useEffect(()=>{d(t&&s?{name:s.name||""}:{name:"",image:void 0})},[t,s,d]);const c=async r=>{try{const i=new FormData;i.append("name",r.name),r.image&&r.image.length>0&&i.append("image",r.image[0]),t&&s?._id?await y.put(`/update-category/${s._id}`,i,{headers:{"Content-Type":"multipart/form-data"}}):await y.post("/create-category",i,{headers:{"Content-Type":"multipart/form-data"}}),await m.invalidateQueries({queryKey:["get-category"]}),l()}catch(i){console.error("Error saving category:",i)}};return e.jsx(f,{appear:!0,show:n,as:p.Fragment,children:e.jsxs(g,{as:"div",className:"relative z-50",onClose:l,children:[e.jsx(f.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(f.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(g.Panel,{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(g.Title,{className:"text-lg font-semibold",children:t?"Edit Category":"Add Category"}),e.jsx("button",{type:"button",onClick:l,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(A,{size:20})})]}),e.jsxs("form",{onSubmit:h(c),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...o("name",{required:"Category name is required"}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-pink-300"}),u.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:u.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image"}),e.jsx("input",{type:"file",accept:"image/*",...o("image"),className:"w-full"}),s?.image&&t&&e.jsx("img",{src:s.image,alt:"Current",className:"mt-2 w-16 h-16 object-cover rounded border"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-pink-600 text-white hover:bg-pink-700",children:t?"Update":"Create"})]})]})]})})})]})})},O=()=>{const{data:n,isLoading:l,isError:t}=w(),{mutateAsync:s}=C(),{pageNumber:m,pageSizeValue:o,handlePageChange:h,handlePageSizeChange:d}=k(),{data:u,isModalOpen:c,openModal:r,closeModal:i}=F();return l?e.jsx(v,{}):t?e.jsx("div",{className:"p-4 text-red-500",children:"Error loading data"}):e.jsxs("div",{className:"p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"All Categories"}),e.jsx("button",{onClick:()=>r({isCreate:!0}),className:"px-4 py-2 bg-pink-600 text-white rounded hover:bg-pink-700 transition-all duration-300",children:"+ Add Category"})]}),!n?.results||n.results.length===0?e.jsx("p",{children:"No categories found"}):e.jsx(x.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.4},className:"overflow-x-auto overflow-y-auto max-h-[400px] rounded-lg shadow-sm custom-scrollbar",children:e.jsxs("table",{className:"min-w-full text-sm bg-white rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left font-medium w-16",children:"S.No"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Image"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Name"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Status"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:n.results.map((a,j)=>e.jsxs(x.tr,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:j*.05},className:"border-b hover:bg-gray-50 transition-all duration-200",children:[e.jsx("td",{className:"p-3",children:(m-1)*o+(j+1)}),e.jsx("td",{className:"p-3",children:a.image?e.jsx("img",{src:a.image,alt:a.name,className:"w-12 h-12 object-cover rounded-md border"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center text-gray-500 text-xs",children:"No Image"})}),e.jsx("td",{className:"p-3",children:a.name}),e.jsx("td",{className:"p-3",children:e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.isActive,onChange:async()=>await s({id:a._id,isActive:!a.isActive})}),e.jsx(x.div,{layout:!0,className:`w-11 h-6 rounded-full transition-all relative ${a.isActive?"bg-green-500":"bg-gray-300"}`,children:e.jsx(x.div,{layout:!0,transition:{type:"spring",stiffness:500,damping:30},className:`absolute top-0.5 w-5 h-5 bg-white rounded-full shadow ${a.isActive?"left-[22px]":"left-[2px]"}`})})]})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>r({isUpdate:!0},a),className:"p-2 hover:bg-gray-100 rounded-full transition",children:e.jsx("span",{className:"material-symbols-outlined text-gray-600",children:"visibility"})})})]},a._id))})]})}),e.jsx(S,{currentPage:m,handlePageChange:h,pageSize:o,handlePageSizeChange:d,totalCount:n?.pagination.total||0}),e.jsx(E,{isOpen:c.isCreate||c.isUpdate||!1,onClose:()=>i({isCreate:!1,isUpdate:!1}),initialData:u||void 0,isUpdate:c.isUpdate||!1})]})};export{O as default};
