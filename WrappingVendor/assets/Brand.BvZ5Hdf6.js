import{m as y,a as N,o as C,z as f,j as e,e as o,k as B,E as S}from"./index.7beg4GmD.js";import{u as F,P}from"./usePagination.DdP4nXYr.js";import{b as k,u as L}from"./useCreateProduct.DVnB_dRe.js";import{X as z}from"./x.CrqfCA10.js";import{K as h}from"./transition.BaUELZUn.js";import{h as b}from"./dialog.B_JYM1mN.js";const A=async s=>{const t=new FormData;return t.append("name",s.name),t.append("category",s.category),t.append("image",s.image),(await N.post("/create-brand",t,{headers:{"Content-Type":"multipart/form-data"}})).data},E=()=>y({mutationFn:A}),T=async({id:s,data:t})=>(await N.put(`/update-brand/${s}`,t)).data,q=()=>{const s=C();return y({mutationFn:T,onSuccess:t=>{f.success(t?.message||"Brand updated successfully!"),s.invalidateQueries({queryKey:["get-brand"]})},onError:t=>{f.error(t?.message||"Failed to update brand")}})},D=({brands:s,startItem:t,refetch:l})=>{const{mutate:c,isPending:i}=q(),d=(a,n)=>{c({id:a,data:{isActive:!n}},{onSuccess:()=>{l()}})};return s.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-4 text-gray-500",children:"No Brands Found"})})}):e.jsx("tbody",{children:s.map((a,n)=>e.jsxs("tr",{className:"border-t hover:bg-gray-50 text-center transition",children:[e.jsx("td",{className:"p-3 border text-sm font-medium",children:t+n}),e.jsx("td",{className:"p-3 border",children:a.image?e.jsx("img",{src:a.image,alt:a.name,className:"h-10 w-20 object-contain mx-auto"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})}),e.jsx("td",{className:"p-3 border text-sm",children:a.name}),e.jsx("td",{className:"p-3 border text-sm",children:a.category.name}),e.jsx("td",{className:"p-3 border text-sm",children:a.description||"-"}),e.jsx("td",{className:"p-3 border text-sm",children:e.jsx("button",{type:"button",onClick:()=>d(a._id,a.isActive),disabled:i,className:`relative w-11 h-6 rounded-full transition-colors duration-300 ${a.isActive?"bg-green-500":"bg-gray-300"} ${i?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-300 ${a.isActive?"translate-x-5":""}`})})})]},a._id))})},I=({isOpen:s,onClose:t,categories:l,isCategoriesLoading:c,onSubmit:i})=>{const[d,a]=o.useState(""),[n,m]=o.useState(null),[u,x]=o.useState("");o.useEffect(()=>{s||(a(""),m(null),x(""))},[s]);const p=r=>{if(r.preventDefault(),!n||!u){alert("Please select category and image");return}i({name:d,category:u,image:n})};return e.jsx(h,{appear:!0,show:s,as:o.Fragment,children:e.jsxs(b,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(h.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(h.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(b.Panel,{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(b.Title,{className:"text-lg font-semibold",children:"Add New Brand"}),e.jsx("button",{type:"button",onClick:t,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(z,{size:20})})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Name"}),e.jsx("input",{type:"text",value:d,onChange:r=>a(r.target.value),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter brand name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),c?e.jsx("p",{className:"text-gray-500 text-sm",children:"Loading categories..."}):e.jsxs("select",{value:u,onChange:r=>x(r.target.value),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500",required:!0,children:[e.jsx("option",{value:"",children:"Select category"}),l.map(r=>e.jsx("option",{value:r._id,children:r.name},r._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Logo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:r=>m(r.target.files?.[0]||null),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-purple-500",required:!0}),n&&e.jsx("img",{src:URL.createObjectURL(n),alt:"Preview",className:"w-20 h-20 object-cover rounded-lg mt-2 border"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Add Brand"})]})]})]})})})]})})},U=()=>{const{startItem:s,handlePageChange:t,handlePageSizeChange:l,pageNumber:c,pageSizeValue:i}=F(),{data:d,isLoading:a,error:n,refetch:m}=k({pageNumber:c,pageSize:i}),{data:u,isLoading:x}=L(),{mutate:p}=E(),[r,g]=o.useState(!1);if(a)return e.jsx(B,{});if(n)return e.jsx(S,{message:"Failed to load brands",onRetry:m});const j=d?.results??[],v=d?.pagination?.total??j.length;return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Brands"}),e.jsx("button",{onClick:()=>g(!0),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition",children:"+ Add Brand"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-center font-semibold",children:"S.No"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Logo"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Brand"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Category"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Description"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Status"})]})}),e.jsx(D,{brands:j,startItem:s,refetch:m})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(P,{currentPage:c,handlePageChange:t,pageSize:i,handlePageSizeChange:l,totalCount:v})}),e.jsx(I,{isOpen:r,onClose:()=>g(!1),categories:u?.results??[],isCategoriesLoading:x,onSubmit:w=>p(w,{onSuccess:()=>{m(),g(!1)}})})]})};export{U as default};
