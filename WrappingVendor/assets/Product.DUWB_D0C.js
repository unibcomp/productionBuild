import{u as S,o as k,m as E,a as g,j as e,n as A,e as M,z as p,f as O,h as D,k as U}from"./index.7beg4GmD.js";import{u as R,P as z}from"./usePagination.DdP4nXYr.js";import{u as V}from"./useModal.CURjACdt.js";import{X as b}from"./x.CrqfCA10.js";import{C as _,E as $}from"./eye.CFduGMuB.js";import{P as F}from"./PageHeadline.BCVlOFLL.js";const G=async a=>(await g.get("get-product",{params:a})).data,T=({pageSize:a=10,pageNumber:n=1,productStatus:t})=>S({queryKey:["products",a,n,t],queryFn:()=>G({pageSize:a,pageNumber:n,productStatus:t}),staleTime:1e3*60}),q=async a=>{const{_id:n,...t}=a;return(await g.put(`update-product/${n}`,t)).data},j=()=>{const a=k();return E({mutationFn:q,onSuccess:()=>{a.invalidateQueries({queryKey:["products"],exact:!1})}})},L=({isOpen:a,onClose:n,onConfirm:t,title:r="Confirmation",message:i,confirmText:d="Confirm",cancelText:o="Cancel",confirmButtonClass:m="bg-blue-600 hover:bg-blue-700",isLoading:c=!1})=>a?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:n}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[e.jsx("button",{onClick:n,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",disabled:c,children:e.jsx(b,{size:20})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:r}),e.jsx("p",{className:"text-gray-600 mb-6",children:i}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:n,disabled:c,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50",children:o}),e.jsx("button",{onClick:t,disabled:c,className:`px-4 py-2 text-white rounded disabled:opacity-50 ${m}`,children:c?"Processing...":d})]})]})]}):null,B=({isOpen:a,onClose:n,product:t})=>{const{register:r,handleSubmit:i,reset:d}=A({defaultValues:t||{}}),{mutate:o,isPending:m}=j();M.useEffect(()=>{t&&d(t)},[t,d]);const c=u=>{t&&o({_id:t._id,name:u.name,description:u.description,manufacturingInfo:u.manufacturingInfo},{onSuccess:l=>{p.success("Product updated successfully!"),n()},onError:l=>p.error(l?.message||"Update failed!")})};return!a||!t?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-lg shadow-lg p-6 overflow-y-auto max-h-[90vh]",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Update Product"}),e.jsxs("form",{onSubmit:i(c),className:"grid gap-6",children:[e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg border-b pb-1",children:"Product Details"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Name"}),e.jsx("input",{...r("name",{required:!0}),placeholder:"Product Name",className:"border p-2 rounded w-full"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{...r("description"),placeholder:"Product Description",className:"border p-2 rounded w-full resize-none",rows:3})]})]}),e.jsxs("section",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-lg border-b pb-1",children:"Manufacturing Info"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Generic Name"}),e.jsx("input",{...r("manufacturingInfo.genericName"),placeholder:"Generic Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Country of Origin"}),e.jsx("input",{...r("manufacturingInfo.countryOfOrigin"),placeholder:"Country of Origin",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Manufacturer Name"}),e.jsx("input",{...r("manufacturingInfo.manufacturer.name"),placeholder:"Manufacturer Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Manufacturer Contact"}),e.jsx("input",{...r("manufacturingInfo.manufacturer.contact"),placeholder:"Manufacturer Contact",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Importer Name"}),e.jsx("input",{...r("manufacturingInfo.importer.name"),placeholder:"Importer Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Importer Contact"}),e.jsx("input",{...r("manufacturingInfo.importer.contact"),placeholder:"Importer Contact",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Packer Name"}),e.jsx("input",{...r("manufacturingInfo.packer.name"),placeholder:"Packer Name",className:"border p-2 rounded"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm font-medium mb-1",children:"Packer Contact"}),e.jsx("input",{...r("manufacturingInfo.packer.contact"),placeholder:"Packer Contact",className:"border p-2 rounded"})]})]})]}),e.jsx("button",{type:"submit",disabled:m,className:`p-3 rounded text-white w-full mt-4 ${m?"bg-yellow-400 cursor-not-allowed":"bg-yellow-500 hover:bg-yellow-600"}`,children:m?"Updating...":"Update Product"}),e.jsx("button",{type:"button",onClick:n,className:"p-3 rounded border mt-2 w-full hover:bg-gray-100 transition",children:"Cancel"})]})]})})},Q=({products:a,startItem:n,isPending:t})=>{const{mutate:r,isPending:i}=j(),{user:d,isLoading:o}=O(),{isModalOpen:m,openModal:c,closeModal:u,data:l}=V(),x=d?.role==="ADMIN"||d?.role==="VENDOR",f=(s,h)=>{c({isConfirm:!0},{productId:s,productStatus:h})},N=()=>{l?.productId&&l?.productStatus&&r({_id:l.productId,productStatus:l.productStatus},{onSuccess:()=>u({isConfirm:!1})})},y=s=>{r({_id:s._id,isActive:!s.isActive},{onSuccess:()=>{}})},v=()=>u({isConfirm:!1}),P=s=>{switch(s){case"APPROVED":return"text-green-600 font-semibold";case"REJECTED":return"text-red-600 font-semibold";default:return"text-yellow-600 font-semibold"}},w=s=>s==="APPROVED"?"Are you sure you want to approve this product?":"Are you sure you want to reject this product?";return a.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"text-center p-4 text-gray-500",children:"No Products Found"})})}):e.jsxs(e.Fragment,{children:[e.jsx("tbody",{children:a.map((s,h)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 border text-center",children:h+n}),e.jsx("td",{className:"p-2 border font-semibold",children:s.name}),e.jsx("td",{className:"p-2 border",children:s.category?.name||"-"}),e.jsx("td",{className:"p-2 border",children:s.brand?.name||"-"}),e.jsx("td",{className:`p-2 border text-center ${P(s.productStatus||"PENDING")}`,children:s.productStatus||"PENDING"}),e.jsx("td",{className:"p-2 border",children:e.jsx("div",{className:"flex space-x-2",children:s.images?.map((C,I)=>e.jsx("img",{src:C,alt:s.name,className:"w-12 h-12 object-cover rounded"},I))})}),e.jsxs("td",{className:"p-2 border text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Generic:"})," ",s.manufacturingInfo?.genericName||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Origin:"})," ",s.manufacturingInfo?.countryOfOrigin||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Manufacturer:"})," ",s.manufacturingInfo?.manufacturer?.name," (",s.manufacturingInfo?.manufacturer?.contact,")"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Importer:"})," ",s.manufacturingInfo?.importer?.name," (",s.manufacturingInfo?.importer?.contact,")"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Packer:"})," ",s.manufacturingInfo?.packer?.name," (",s.manufacturingInfo?.packer?.contact,")"]})]}),e.jsx("td",{className:"p-3 border text-center",children:e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:s.isActive,onChange:()=>y(s),disabled:i}),e.jsx("div",{className:`w-11 h-6 rounded-full transition-all ${s.isActive?"bg-green-500":"bg-gray-300"} relative`,children:e.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform ${s.isActive?"translate-x-5":""}`})})]})}),e.jsxs("td",{className:"p-2 border text-center flex justify-center gap-2",children:[t&&x&&!o&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"p-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",title:"Approve",disabled:i,onClick:()=>f(s._id,"APPROVED"),children:e.jsx(_,{size:18})}),e.jsx("button",{className:"p-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",title:"Reject",disabled:i,onClick:()=>f(s._id,"REJECTED"),children:e.jsx(b,{size:18})})]}),s.productStatus==="APPROVED"&&x&&!o&&e.jsx("button",{className:"p-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",title:"Update Product",onClick:()=>c({isUpdate:!0},{product:s}),children:"Update"}),e.jsx(D,{to:`/products/variant/${s._id}`,className:"inline-flex items-center justify-center p-2 bg-blue-600 hover:bg-blue-700 text-white rounded",children:e.jsx($,{size:20})})]})]},s._id))}),e.jsx(L,{isOpen:m.isConfirm||!1,onClose:v,onConfirm:N,title:l?.productStatus==="APPROVED"?"Approve Product":"Reject Product",message:w(l?.productStatus),confirmText:l?.productStatus==="APPROVED"?"Approve":"Reject",confirmButtonClass:l?.productStatus==="APPROVED"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",isLoading:i}),e.jsx(B,{isOpen:m.isUpdate||!1,onClose:()=>u({isUpdate:!1}),product:l?.product||null})]})},Z=({status:a})=>{const{startItem:n,handlePageChange:t,handlePageSizeChange:r,pageNumber:i,pageSizeValue:d}=R(),{data:o,isLoading:m}=T({pageSize:d,pageNumber:i,productStatus:a}),c=x=>x.charAt(0).toUpperCase()+x.slice(1).toLowerCase();if(m)return e.jsx(U,{});const u=a?`${c(a)} Products`:"Products",l=a?`Manage and view all ${c(a)} products here`:"Manage and view all products here";return e.jsxs("div",{className:"p-4",children:[e.jsx(F,{title:u,subtitle:l}),e.jsx("div",{className:"overflow-x-auto overflow-y-auto border rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"min-w-full border border-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"S.No"}),e.jsx("th",{className:"p-2 border",children:"Name"}),e.jsx("th",{className:"p-2 border",children:"Category"}),e.jsx("th",{className:"p-2 border",children:"Brand"}),e.jsx("th",{className:"p-2 border",children:"Description"}),e.jsx("th",{className:"p-2 border",children:"Status"}),e.jsx("th",{className:"p-2 border",children:"Images"}),e.jsx("th",{className:"p-2 border",children:"Manufacturing Info"}),e.jsx("th",{className:"p-2 border",children:"Action"})]})}),e.jsx(Q,{products:o?.results||[],startItem:n,isPending:a==="PENDING"})]})}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("span",{className:"text-gray-600 text-sm",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:o?.results?.length||0})," ","of"," ",e.jsx("span",{className:"font-medium",children:o?.pagination?.total||0})," ","products"]}),e.jsx(z,{currentPage:i,handlePageChange:t,pageSize:d,handlePageSizeChange:r,totalCount:o?.pagination?.total||0})]})]})};export{Z as default};
