import{o as N,n as v,e as x,j as e,a as j,k as w}from"./index.B52VTIO0.js";import{u as C,d as S}from"./useCreateProduct.BdWCbWfv.js";import{u as _,P as k}from"./usePagination.D6RIs4L-.js";import{u as F}from"./useDomain.CBEBt1xR.js";import{h as f}from"./dialog.D_HBAyO3.js";import{X as A}from"./x._2yihMph.js";import{K as b}from"./transition.CGxVPF2G.js";import{u as E}from"./useModal.DwttrLYQ.js";import{m as y}from"./proxy.DosI95K6.js";const P=({isOpen:o,onClose:i,isUpdate:r,initialData:a})=>{const n=N(),{register:d,handleSubmit:h,reset:m,watch:u,formState:{errors:l}}=v(),{data:c}=F(),p=u("website_id");x.useEffect(()=>{m(r&&a?{name:a.name||""}:{name:"",image:void 0})},[r,a,m]);const g=async t=>{try{const s=new FormData;s.append("name",t.name),t.image&&t.image.length>0&&s.append("image",t.image[0]),t.website_id&&s.append("website_id",t.website_id),r&&a?._id?await j.put(`/update-category/${a._id}`,s,{headers:{"Content-Type":"multipart/form-data"}}):await j.post("/create-category",s,{headers:{"Content-Type":"multipart/form-data"}}),await n.invalidateQueries({queryKey:["get-category"]}),i()}catch(s){console.error("Error saving category:",s)}};return e.jsx(b,{appear:!0,show:o,as:x.Fragment,children:e.jsxs(f,{as:"div",className:"relative z-50",onClose:i,children:[e.jsx(b.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(b.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(f.Panel,{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(f.Title,{className:"text-lg font-semibold",children:r?"Edit Category":"Add Category"}),e.jsx("button",{type:"button",onClick:i,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(A,{size:20})})]}),e.jsxs("form",{onSubmit:h(g),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Domain"}),e.jsxs("select",{...d("website_id",{required:"Domain is required"}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select domain"}),c?.results?.map(t=>e.jsx("option",{value:t._id,children:t.domain},t._id))]}),l.website_id&&e.jsx("p",{className:"text-red-500 text-sm",children:l.website_id.message})]}),p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...d("name",{required:"Category name is required"}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring focus:ring-pink-300"}),l.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:l.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image"}),e.jsx("input",{type:"file",accept:"image/*",...d("image"),className:"w-full"}),a?.image&&r&&e.jsx("img",{src:a.image,alt:"Current",className:"mt-2 w-16 h-16 object-cover rounded border"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 rounded bg-gray-200 hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-pink-600 text-white hover:bg-pink-700",children:r?"Update":"Create"})]})]})]})]})})})]})})},Q=()=>{const{pageNumber:o,pageSizeValue:i,handlePageChange:r,handlePageSizeChange:a}=_(),{data:n,isLoading:d,isError:h}=C({pageNumber:o,pageSize:i}),{mutateAsync:m,isPending:u}=S(),{data:l,isModalOpen:c,openModal:p,closeModal:g}=E();return d?e.jsx(w,{}):h?e.jsx("div",{className:"p-4 text-red-500",children:"Error loading data"}):e.jsxs("div",{className:"p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"All Categories"}),e.jsx("button",{onClick:()=>p({isCreate:!0}),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition",children:"+ Add Category"})]}),!n?.results||n.results.length===0?e.jsx("p",{children:"No categories found"}):e.jsx(y.div,{initial:{opacity:0,y:15},animate:{opacity:1,y:0},transition:{duration:.4},className:"overflow-x-auto overflow-y-auto max-h-[400px] rounded-lg shadow-sm custom-scrollbar",children:e.jsxs("table",{className:"min-w-full text-sm bg-white rounded-lg",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left font-medium w-16",children:"S.No"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Image"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Name"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Status"}),e.jsx("th",{className:"p-3 text-left font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:n.results.map((t,s)=>e.jsxs(y.tr,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:s*.05},className:"border-b hover:bg-gray-50 transition-all duration-200",children:[e.jsx("td",{className:"p-3",children:(o-1)*i+(s+1)}),e.jsx("td",{className:"p-3",children:t.image?e.jsx("img",{src:t.image,alt:t.name,className:"w-12 h-12 object-cover rounded-md border"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center text-gray-500 text-xs",children:"No Image"})}),e.jsx("td",{className:"p-3",children:t.name}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>m({id:t._id,isActive:!t.isActive}),disabled:u,className:`relative w-11 h-6 rounded-full overflow-hidden transition-all duration-500 ease-in-out
      ${t.isActive?"bg-green-500":"bg-gray-300"}
      ${u?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transform transition-all duration-500 ease-in-out
        ${t.isActive?"translate-x-[20px]":"translate-x-0"}`})})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>p({isUpdate:!0},t),className:"px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition",children:"Edit"})})]},t._id))})]})}),n?.pagination?.total?e.jsx(k,{currentPage:o,handlePageChange:r,pageSize:i,handlePageSizeChange:a,totalCount:n?.pagination?.total??0}):null,e.jsx(P,{isOpen:c.isCreate||c.isUpdate||!1,onClose:()=>g({isCreate:!1,isUpdate:!1}),initialData:l||void 0,isUpdate:c.isUpdate||!1})]})};export{Q as default};
