import{d as C,n as w,k as S,e as p,j as e,a as E,b as I,s as k}from"./index.BExXVMiE.js";import{u as A,P as D}from"./usePagination.BKxWHthg.js";import{u as M}from"./useModal.CmG-xUoC.js";import{X as f}from"./x.DzmYYptH.js";import{C as O,E as R}from"./eye.BC7HnooB.js";import{P as z}from"./PageHeadline.BlZNqQHT.js";const V=async t=>(await p.get("get-product",{params:t})).data,U=({pageSize:t=10,pageNumber:r=1,productStatus:a})=>C({queryKey:["products",t,r,a],queryFn:()=>V({pageSize:t,pageNumber:r,productStatus:a}),staleTime:1e3*60}),_=async t=>{const{_id:r,...a}=t;return(await p.put(`update-product/${r}`,a)).data},$=()=>{const t=w();return S({mutationFn:_,onSuccess:()=>{t.invalidateQueries({queryKey:["products"],exact:!1})}})},F=({isOpen:t,onClose:r,onConfirm:a,title:l="Confirmation",message:o,confirmText:d="Confirm",cancelText:c="Cancel",confirmButtonClass:u="bg-blue-600 hover:bg-blue-700",isLoading:i=!1})=>t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),e.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[e.jsx("button",{onClick:r,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",disabled:i,children:e.jsx(f,{size:20})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:l}),e.jsx("p",{className:"text-gray-600 mb-6",children:o}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,disabled:i,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50",children:c}),e.jsx("button",{onClick:a,disabled:i,className:`px-4 py-2 text-white rounded disabled:opacity-50 ${u}`,children:i?"Processing...":d})]})]})]}):null,T=({products:t,startItem:r,isPending:a})=>{const{mutate:l,isPending:o}=$(),{user:d,isLoading:c}=E(),{isModalOpen:u,openModal:i,closeModal:m,data:n}=M(),x=d?.role==="ADMIN"||d?.role==="VENDOR",g=(s,h)=>{i({isConfirm:!0},{productId:s,productStatus:h})},j=()=>{n?.productId&&n?.productStatus&&l({_id:n.productId,productStatus:n.productStatus},{onSuccess:()=>{m({isConfirm:!1})}})},b=()=>{m({isConfirm:!1})},N=s=>{switch(s){case"APPROVED":return"text-green-600 font-semibold";case"REJECTED":return"text-red-600 font-semibold";default:return"text-yellow-600 font-semibold"}},y=s=>s==="APPROVED"?"Are you sure you want to approve this product?":"Are you sure you want to reject this product?";return t.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"text-center p-4 text-gray-500",children:"No Products Found"})})}):e.jsxs(e.Fragment,{children:[e.jsx("tbody",{children:t.map((s,h)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 border text-center",children:h+r}),e.jsx("td",{className:"p-2 border font-semibold",children:s.name}),e.jsx("td",{className:"p-2 border",children:s.category?.name||"-"}),e.jsx("td",{className:"p-2 border",children:s.brand?.name||"-"}),e.jsx("td",{className:"p-2 border",children:s.description||"-"}),e.jsx("td",{className:`p-2 border text-center ${N(s.productStatus||"PENDING")}`,children:s.productStatus||"PENDING"}),e.jsx("td",{className:"p-2 border",children:e.jsx("div",{className:"flex space-x-2",children:s.images?.map((P,v)=>e.jsx("img",{src:P,alt:s.name,className:"w-12 h-12 object-cover rounded"},v))})}),e.jsxs("td",{className:"p-2 border text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Generic:"})," ",s.manufacturingInfo?.genericName||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Origin:"})," ",s.manufacturingInfo?.countryOfOrigin||"-"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Manufacturer:"})," ",s.manufacturingInfo?.manufacturer?.name," (",s.manufacturingInfo?.manufacturer?.contact,")"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Importer:"})," ",s.manufacturingInfo?.importer?.name," (",s.manufacturingInfo?.importer?.contact,")"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Packer:"})," ",s.manufacturingInfo?.packer?.name," (",s.manufacturingInfo?.packer?.contact,")"]})]}),e.jsxs("td",{className:"p-2 border text-center flex justify-center gap-2",children:[a&&x&&!c&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"p-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",title:"Approve",disabled:o,onClick:()=>g(s._id,"APPROVED"),children:e.jsx(O,{size:18})}),e.jsx("button",{className:"p-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",title:"Reject",disabled:o,onClick:()=>g(s._id,"REJECTED"),children:e.jsx(f,{size:18})})]}),e.jsx(I,{to:`/products/variant/${s._id}`,className:"inline-flex items-center justify-center p-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition",children:e.jsx(R,{size:20})})]})]},s._id))}),e.jsx(F,{isOpen:u.isConfirm||!1,onClose:b,onConfirm:j,title:n?.productStatus==="APPROVED"?"Approve Product":"Reject Product",message:y(n?.productStatus),confirmText:n?.productStatus==="APPROVED"?"Approve":"Reject",confirmButtonClass:n?.productStatus==="APPROVED"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",isLoading:o})]})},K=({status:t})=>{const{startItem:r,handlePageChange:a,handlePageSizeChange:l,pageNumber:o,pageSizeValue:d}=A(),{data:c,isLoading:u}=U({pageSize:d,pageNumber:o,productStatus:t}),i=x=>x.charAt(0).toUpperCase()+x.slice(1).toLowerCase();if(u)return e.jsx(k,{});const m=t?`${i(t)} Products`:"Products",n=t?`Manage and view all ${i(t)} products here`:"Manage and view all products here";return e.jsxs("div",{className:"p-4",children:[e.jsx(z,{title:m,subtitle:n}),e.jsx("div",{className:"overflow-x-auto overflow-y-auto border rounded-lg shadow-sm bg-white",children:e.jsxs("table",{className:"min-w-full border border-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"S.No"}),e.jsx("th",{className:"p-2 border",children:"Name"}),e.jsx("th",{className:"p-2 border",children:"Category"}),e.jsx("th",{className:"p-2 border",children:"Brand"}),e.jsx("th",{className:"p-2 border",children:"Description"}),e.jsx("th",{className:"p-2 border",children:"Status"}),e.jsx("th",{className:"p-2 border",children:"Images"}),e.jsx("th",{className:"p-2 border",children:"Manufacturing Info"}),e.jsx("th",{className:"p-2 border",children:"Action"})]})}),e.jsx(T,{products:c?.results||[],startItem:r,isPending:t==="PENDING"})]})}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("span",{className:"text-gray-600 text-sm",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:c?.results?.length||0})," ","of"," ",e.jsx("span",{className:"font-medium",children:c?.pagination?.total||0})," ","products"]}),e.jsx(D,{currentPage:o,handlePageChange:a,pageSize:d,handlePageSizeChange:l,totalCount:c?.pagination?.total||0})]})]})};export{K as default};
