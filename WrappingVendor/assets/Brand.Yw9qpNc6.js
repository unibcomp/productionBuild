import{m as B,o as k,z as C,a as _,j as e,n as D,e as m,k as q,E as P}from"./index.B52VTIO0.js";import{u as L,P as z}from"./usePagination.D6RIs4L-.js";import{u as E,b as I}from"./useCreateProduct.BdWCbWfv.js";import{u as M}from"./useDomain.CBEBt1xR.js";import{X as T}from"./x._2yihMph.js";import{K as v}from"./transition.CGxVPF2G.js";import{h as S}from"./dialog.D_HBAyO3.js";const O=async a=>{const t=new FormData;return t.append("name",a.name),t.append("category",a.category),t.append("image",a.image),t.append("website_id",a.website_id),(await _.post("/create-brand",t,{headers:{"Content-Type":"multipart/form-data"}})).data},R=()=>B({mutationFn:O}),$=async({id:a,data:t})=>{const i=new FormData;return t.name&&i.append("name",t.name),t.category&&i.append("category",t.category),typeof t.isActive=="boolean"&&i.append("isActive",String(t.isActive)),t.image&&i.append("image",t.image),(await _.put(`/update-brand/${a}`,i,{headers:{"Content-Type":"multipart/form-data"}})).data},F=()=>{const a=k();return B({mutationFn:$,onSuccess:t=>{C.success(t?.message||"Brand updated successfully!"),a.invalidateQueries({queryKey:["get-brand"]})},onError:t=>{C.error(t?.message||"Failed to update brand")}})},K=({brands:a,startItem:t,refetch:i,onOpenModal:n})=>{const{mutate:l,isPending:d}=F(),g=(s,o)=>{l({id:s,data:{isActive:!o}},{onSuccess:()=>i()})};return a.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-4 text-gray-500",children:"No Brands Found"})})}):e.jsx("tbody",{children:a.map((s,o)=>e.jsxs("tr",{className:"border-t hover:bg-gray-50 text-center transition",children:[e.jsx("td",{className:"p-3 border text-sm font-medium",children:t+o}),e.jsx("td",{className:"p-3 border",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"h-10 w-20 object-contain mx-auto"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})}),e.jsx("td",{className:"p-3 border text-sm",children:s.name}),e.jsx("td",{className:"p-3 border text-sm",children:s.category.name}),e.jsx("td",{className:"p-3 border text-sm",children:s.description||"-"}),e.jsx("td",{className:"p-3 border text-sm",children:e.jsx("button",{type:"button",onClick:()=>g(s._id,s.isActive),disabled:d,className:`relative w-11 h-6 rounded-full transition-colors duration-300 ${s.isActive?"bg-green-500":"bg-gray-300"} ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-300 ${s.isActive?"translate-x-5":""}`})})}),e.jsx("td",{className:"p-3 border",children:e.jsx("button",{onClick:()=>n(s),className:"px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition",children:"Edit"})})]},s._id))})},U=({isOpen:a,onClose:t,onSubmit:i,viewBrand:n,isUpdate:l=!1})=>{const{register:d,handleSubmit:g,reset:s,watch:o,formState:{errors:c}}=D({defaultValues:{name:"",category:"",image:void 0,website_id:""}}),u=o("website_id"),{data:w,isLoading:h}=M(),{data:b}=E(u?{website_id:u}:{}),[x,p]=m.useState(null);m.useEffect(()=>{n&&l?(s({name:n.name,category:n.category._id,website_id:n.website_id}),n.image&&p(n.image)):a||(s(),p(null))},[n,l,a,s]);const f=r=>{if(r){const j=URL.createObjectURL(r);p(j)}},y=r=>{i({...r,image:r.image?.[0]})};return e.jsx(v,{appear:!0,show:a,as:m.Fragment,children:e.jsxs(S,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(v.Child,{as:m.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",children:e.jsx("div",{className:"fixed inset-0 bg-black/40"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(v.Child,{as:m.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",children:e.jsxs(S.Panel,{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(S.Title,{className:"text-lg font-semibold",children:l?"Update Brand":"Add New Brand"}),e.jsx("button",{onClick:t,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(T,{size:20})})]}),h?e.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"Loading domains..."}):e.jsxs("form",{onSubmit:g(y),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Domain"}),e.jsxs("select",{...d("website_id",{required:"Domain is required"}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select domain"}),w?.results?.map(r=>e.jsx("option",{value:r._id,children:r.domain},r._id))]}),c.website_id&&e.jsx("p",{className:"text-red-500 text-sm",children:c.website_id.message})]}),u&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsxs("select",{...d("category",{required:"Category is required"}),className:"w-full border rounded-lg px-3 py-2",disabled:!u,children:[e.jsx("option",{value:"",children:"Select category"}),b?.results?.map(r=>e.jsx("option",{value:r._id,children:r.name},r._id))]}),c.category&&e.jsx("p",{className:"text-red-500 text-sm",children:c.category.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Name"}),e.jsx("input",{...d("name",{required:"Brand name is required"}),type:"text",className:"w-full border rounded-lg px-3 py-2",placeholder:"Enter brand name"}),c.name&&e.jsx("p",{className:"text-red-500 text-sm",children:c.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Logo"}),x&&e.jsx("img",{src:x,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border mb-2"}),e.jsx("input",{type:"file",accept:"image/*",...d("image",{required:l?!1:"Image is required",onChange:r=>f(r.target.files?.[0])}),className:"w-full border rounded-lg px-3 py-2"}),c.image&&e.jsx("p",{className:"text-red-500 text-sm",children:String(c.image.message)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:l?"Update Brand":"Add Brand"})]})]})]})]})})})]})})},Y=()=>{const{startItem:a,handlePageChange:t,handlePageSizeChange:i,pageNumber:n,pageSizeValue:l}=L(),{data:d,isLoading:g,error:s,refetch:o}=I({pageNumber:n,pageSize:l}),{mutate:c}=R(),{mutate:u}=F(),[w,h]=m.useState(!1),[b,x]=m.useState(null),[p,f]=m.useState(!1);if(g)return e.jsx(q,{});if(s)return e.jsx(P,{message:"Failed to load brands",onRetry:o});const y=d?.results??[],r=d?.pagination?.total??y.length,j=()=>{h(!1),x(null)},A=N=>{p&&b?u({id:b._id,data:N},{onSuccess:()=>{o(),j()}}):c(N,{onSuccess:()=>{o(),j()}})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Brands"}),e.jsx("button",{onClick:()=>{x(null),f(!1),h(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition",children:"+ Add Brand"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-center font-semibold",children:"S.No"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Logo"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Brand"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Category"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Description"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Status"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Action"})]})}),e.jsx(K,{brands:y,startItem:a,refetch:o,onOpenModal:N=>{x(N),f(!0),h(!0)}})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(z,{currentPage:n,handlePageChange:t,pageSize:l,handlePageSizeChange:i,totalCount:r})}),e.jsx(U,{isOpen:w,onClose:j,onSubmit:A,viewBrand:b,isUpdate:p})]})};export{Y as default};
