import{m as _,o as D,z as B,a as F,j as e,n as P,e as c,x as q,k as I,E as L}from"./index.DlsZ5bxu.js";import{u as z,P as E}from"./usePagination.Ct4CxkUv.js";import{u as M,b as T}from"./useCreateProduct.Bh7u6Crb.js";import{u as O}from"./useDomain.CXOy1DVZ.js";import{X as R}from"./x.DtgYVvYY.js";import{K as S}from"./transition.Bad4aoF1.js";import{h as C}from"./dialog.VCeNJoc3.js";const $=async r=>{const t=new FormData;return t.append("name",r.name),t.append("category",r.category),t.append("image",r.image),t.append("website_id",r.website_id),(await F.post("/create-brand",t,{headers:{"Content-Type":"multipart/form-data"}})).data},K=()=>_({mutationFn:$}),U=async({id:r,data:t})=>{const o=new FormData;return t.name&&o.append("name",t.name),t.category&&o.append("category",t.category),typeof t.isActive=="boolean"&&o.append("isActive",String(t.isActive)),t.image&&o.append("image",t.image),(await F.put(`/update-brand/${r}`,o,{headers:{"Content-Type":"multipart/form-data"}})).data},A=()=>{const r=D();return _({mutationFn:U,onSuccess:t=>{B.success(t?.message||"Brand updated successfully!"),r.invalidateQueries({queryKey:["get-brand"]})},onError:t=>{B.error(t?.message||"Failed to update brand")}})},Q=({brands:r,startItem:t,refetch:o,onOpenModal:n})=>{const{mutate:l,isPending:d}=A(),x=(s,m)=>{l({id:s,data:{isActive:!m}},{onSuccess:()=>o()})};return r.length===0?e.jsx("tbody",{children:e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center p-4 text-gray-500",children:"No Brands Found"})})}):e.jsx("tbody",{children:r.map((s,m)=>e.jsxs("tr",{className:"border-t hover:bg-gray-50 text-center transition",children:[e.jsx("td",{className:"p-3 border text-sm font-medium",children:t+m}),e.jsx("td",{className:"p-3 border",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"h-10 w-20 object-contain mx-auto"}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No Image"})}),e.jsx("td",{className:"p-3 border text-sm",children:s.name}),e.jsx("td",{className:"p-3 border text-sm",children:s.category.name}),e.jsx("td",{className:"p-3 border text-sm",children:s.description||"-"}),e.jsx("td",{className:"p-3 border text-sm",children:e.jsx("button",{type:"button",onClick:()=>x(s._id,s.isActive),disabled:d,className:`relative w-11 h-6 rounded-full transition-colors duration-300 ${s.isActive?"bg-green-500":"bg-gray-300"} ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-300 ${s.isActive?"translate-x-5":""}`})})}),e.jsx("td",{className:"p-3 border",children:e.jsx("button",{onClick:()=>n(s),className:"px-3 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition",children:"Edit"})})]},s._id))})},V=({isOpen:r,onClose:t,onSubmit:o,viewBrand:n,isUpdate:l=!1})=>{const{register:d,handleSubmit:x,reset:s,watch:m,formState:{errors:i}}=P({defaultValues:{name:"",category:"",image:void 0,website_id:""}}),p=m("website_id"),{data:y,isLoading:N}=O(),{data:h}=M(p?{website_id:p}:{}),[g,u]=c.useState(null);c.useEffect(()=>{n&&l?(s({name:n.name,category:n.category._id,website_id:n.website_id}),n.image&&u(n.image)):r||(s(),u(null))},[n,l,r,s]);const b=a=>{if(a){const w=URL.createObjectURL(a);u(w)}},j=a=>{o({...a,image:a.image?.[0]})};return e.jsx(S,{appear:!0,show:r,as:c.Fragment,children:e.jsxs(C,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(S.Child,{as:c.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",children:e.jsx("div",{className:"fixed inset-0 bg-black/40"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(S.Child,{as:c.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",children:e.jsxs(C.Panel,{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(C.Title,{className:"text-lg font-semibold",children:l?"Update Brand":"Add New Brand"}),e.jsx("button",{onClick:t,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(R,{size:20})})]}),N?e.jsx("p",{className:"text-sm text-gray-500 text-center py-6",children:"Loading domains..."}):e.jsxs("form",{onSubmit:x(j),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Select Domain"}),e.jsxs("select",{...d("website_id",{required:"Domain is required"}),className:"w-full border rounded-lg px-3 py-2",children:[e.jsx("option",{value:"",children:"Select domain"}),y?.results?.map(a=>e.jsx("option",{value:a._id,children:a.domain},a._id))]}),i.website_id&&e.jsx("p",{className:"text-red-500 text-sm",children:i.website_id.message})]}),p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),e.jsxs("select",{...d("category",{required:"Category is required"}),className:"w-full border rounded-lg px-3 py-2",disabled:!p,children:[e.jsx("option",{value:"",children:"Select category"}),h?.results?.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]}),i.category&&e.jsx("p",{className:"text-red-500 text-sm",children:i.category.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Name"}),e.jsx("input",{...d("name",{required:"Brand name is required"}),type:"text",className:"w-full border rounded-lg px-3 py-2",placeholder:"Enter brand name"}),i.name&&e.jsx("p",{className:"text-red-500 text-sm",children:i.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Brand Logo"}),g&&e.jsx("img",{src:g,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border mb-2"}),e.jsx("input",{type:"file",accept:"image/*",...d("image",{required:l?!1:"Image is required",onChange:a=>b(a.target.files?.[0])}),className:"w-full border rounded-lg px-3 py-2"}),i.image&&e.jsx("p",{className:"text-red-500 text-sm",children:String(i.image.message)})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:l?"Update Brand":"Add Brand"})]})]})]})]})})})]})})},ee=()=>{const{startItem:r,handlePageChange:t,handlePageSizeChange:o,pageNumber:n,pageSizeValue:l}=z(),{categoryId:d}=q(),{data:x,isLoading:s,error:m,refetch:i}=T({pageNumber:n,pageSize:l,category:d||void 0}),{mutate:p}=K(),{mutate:y}=A(),[N,h]=c.useState(!1),[g,u]=c.useState(null),[b,j]=c.useState(!1);if(s)return e.jsx(I,{});if(m)return e.jsx(L,{message:"Failed to load brands",onRetry:i});const a=x?.results??[],w=x?.pagination?.total??a.length,v=()=>{h(!1),u(null)},k=f=>{b&&g?y({id:g._id,data:f},{onSuccess:()=>{i(),v()}}):p(f,{onSuccess:()=>{i(),v()}})};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b border-gray-200",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Brands"}),e.jsx("button",{onClick:()=>{u(null),j(!1),h(!0)},className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition",children:"+ Add Brand"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-center font-semibold",children:"S.No"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Logo"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Brand"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Category"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Description"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Status"}),e.jsx("th",{className:"p-3 text-center font-semibold",children:"Action"})]})}),e.jsx(Q,{brands:a,startItem:r,refetch:i,onOpenModal:f=>{u(f),j(!0),h(!0)}})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(E,{currentPage:n,handlePageChange:t,pageSize:l,handlePageSizeChange:o,totalCount:w})}),e.jsx(V,{isOpen:N,onClose:v,onSubmit:k,viewBrand:g,isUpdate:b})]})};export{ee as default};
