import{f as S,o as x,p as m,g as r,r as u,h as _,j as e,m as y,P as q,L as D,N as F,C as P,V as U}from"./index.ppR7c5Oy.js";const O=()=>S({queryKey:["externalTokens"],queryFn:async()=>{const{data:a}=await r.get("fetch-external-token/");return a==null?void 0:a.data}}),Q=()=>{const a=x();return m({mutationFn:async l=>{const{data:n}=await r.post("create-external-token/",l);return n},onSuccess:()=>{a.invalidateQueries({queryKey:["externalTokens"]})}})},K=()=>{const a=x();return m({mutationFn:async l=>{const{data:n}=await r.put("update-external-token/",l);return n},onSuccess:()=>{a.invalidateQueries({queryKey:["externalTokens"]})}})},Y=()=>{const a=x();return m({mutationFn:async l=>{const{data:n}=await r.delete("delete-external-token/",{data:l});return n},onSuccess:()=>{a.invalidateQueries({queryKey:["externalTokens"]})}})},L=({open:a,onClose:l,children:n})=>a?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 px-4",children:e.jsxs(y.div,{className:"bg-white rounded-xl p-6 w-full max-w-sm sm:max-w-md lg:max-w-lg shadow-xl",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},children:[n,e.jsx("button",{onClick:l,className:"mt-4 bg-gray-400 text-white px-4 py-2 rounded-lg hover:bg-gray-500 w-full sm:w-auto",children:"Close"})]})}):null,z=()=>{const{data:a,isLoading:l}=O(),n=Q(),h=K(),b=Y(),[f,i]=u.useState(!1),{openModal:c,isModalOpen:j,closeModal:p,data:k}=_(),[d,g]=u.useState("add"),[s,o]=u.useState({type:"PAYU",token:"",assign_mobile:"",otp:""}),w=()=>{g("add"),o({type:"PAYU",token:"",assign_mobile:"",otp:""}),i(!0)},N=(t,C,A,E,M)=>{g("edit"),o({id:t,type:C,token:A,assign_mobile:E,otp:M}),i(!0)},v=()=>{const t={type:s.type,...s.token?{token:s.token}:{},...s.assign_mobile?{assign_mobile:s.assign_mobile}:{},...s.otp?{otp:s.otp}:{}};d==="add"?n.mutate(t,{onSuccess:()=>i(!1)}):d==="edit"&&s.id&&h.mutate({id:s.id,...t},{onSuccess:()=>i(!1)})},T=t=>{c==null||c({confirm:!0},{id:t})};return e.jsxs(y.div,{className:"bg-white shadow-lg rounded-2xl min-h-screen p-4 sm:p-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx(q,{title:"External Settings"}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 w-full sm:w-auto",children:"+ Add Token"})}),e.jsx("div",{className:"mt-8",children:l?e.jsx(D,{}):a!=null&&a.length?e.jsx("ul",{className:"space-y-3",children:a.map(t=>e.jsxs("li",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between border p-3 rounded-lg shadow-sm gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-mono text-sm break-all",children:["Token: ",t==null?void 0:t.token]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Type: ",t.type||"N/A"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["mobile: ",(t==null?void 0:t.assign_mobile)||"N/A"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["otp: ",(t==null?void 0:t.otp)||"N/A"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Updated At : ",t.updatedAt.split("T")[0]," ",t.updatedAt.split("T")[1].split(".")[0]]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>N(t.id,t.type,t.token,t.assign_mobile,t.otp),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 w-full sm:w-auto",children:"Edit"}),e.jsx("button",{onClick:()=>T(t.id),className:"bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 w-full sm:w-auto",children:"Delete"})]})]},t.id))}):e.jsx(F,{})}),e.jsxs(L,{open:f,onClose:()=>i(!1),children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:d==="add"?"Add Token":"Edit Token"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsx("select",{value:s.type,onChange:t=>o({...s,type:t.target.value}),className:"border rounded-lg px-3 py-2 w-full",children:e.jsx("option",{value:"PAYU",children:"PAYU"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Token"}),e.jsx("input",{type:"text",value:s.token,onChange:t=>o({...s,token:t.target.value}),placeholder:"Enter token",className:"border rounded-lg px-3 py-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mobile No(Alert Transafer)"}),e.jsx("input",{type:"text",value:s.assign_mobile,onChange:t=>o({...s,assign_mobile:t.target.value}),placeholder:"Enter Mobile No",className:"border rounded-lg px-3 py-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"otp"}),e.jsx("input",{type:"text",value:s.otp,onChange:t=>o({...s,otp:t.target.value}),placeholder:"Enter Otp",className:"border rounded-lg px-3 py-2 w-full"})]}),e.jsx("button",{onClick:v,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 w-full",children:d==="add"?"Add":"Update"})]})]}),e.jsx(P,{isOpen:j.confirm||!1,onClose:()=>p({confirm:!1}),onConfirm:()=>{b.mutate({id:k.id},{onSuccess:()=>{p({confirm:!1}),U.success("Token deleted successfully")}})},title:"Delete",description:"Are you sure you want to delete this External Setting?"})]})};export{z as default};
