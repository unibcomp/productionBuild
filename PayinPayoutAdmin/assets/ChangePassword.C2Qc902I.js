import{g as T,r as y,x as C,l as F,j as e,L as E,m,P as q,V as l}from"./index.Ct2vEYE0.js";import{u as $,a as k,b as V,F as _}from"./useForgetPassword.DvyxiV33.js";import{m as A}from"./maskContact.DrZG2-eQ.js";const x=["Send OTP","Verify OTP","Change Password"],H=()=>{const w=T(),[s,u]=y.useState(0),[a,b]=y.useState("mobile"),{data:d,isLoading:f,isError:j}=C(),t=d==null?void 0:d.data,{register:h,handleSubmit:v,formState:{errors:n,isSubmitting:g}}=F(),{mutateAsync:P}=$(),{mutateAsync:N}=k(),{mutateAsync:O}=V(),o=a==="email"?t==null?void 0:t.email:t==null?void 0:t.mobile;if(f)return e.jsx(E,{});if(j||!(t!=null&&t.user_id)||!o)return e.jsx("div",{className:"text-red-500 text-center mt-10",children:"Failed to load user details."});const S=async r=>{var i,p;try{s===0?(await P({[a]:o}),l.success(`OTP sent to your ${a}`),u(1)):s===1?(await N({user_id:t.user_id,[`${a}Otp`]:r.otp}),u(2),l.success("OTP verified")):s===2&&(await O({user_id:t.user_id,newPassword:r.newPassword}),l.success("Password changed successfully"),w("/"))}catch(c){l.error(((p=(i=c==null?void 0:c.response)==null?void 0:i.data)==null?void 0:p.message)||"Something went wrong")}};return e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},className:"min-h-screen flex items-center justify-center bg-gradient-to-r from-[#101F33] to-[#0D2B2F] px-4",children:e.jsxs(m.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:"w-full max-w-md bg-[#1a2c33] text-white border border-[#2a3e4c] shadow-2xl rounded-xl overflow-hidden",children:[e.jsx(q,{title:"Change Password",searchComponent:e.jsx(e.Fragment,{})}),e.jsxs("div",{className:"p-6 md:p-8 space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-[10%] right-[10%] h-1 bg-gray-600 z-0 rounded-full",children:e.jsx("div",{className:"h-1 bg-green-500 rounded-full transition-all duration-500",style:{width:`${s/(x.length-1)*100}%`}})}),e.jsx("div",{className:"flex justify-between relative z-10",children:x.map((r,i)=>e.jsxs("div",{className:"flex flex-col items-center",style:{width:`${80/x.length}%`},children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full text-sm font-bold ${i===s?"bg-cyan-500":i<s?"bg-green-500":"bg-gray-600 text-gray-300"} text-white`,children:i+1}),e.jsx("p",{className:`text-xs mt-1 ${i===s?"text-cyan-300":"text-gray-400"}`,children:r})]},r))})]}),e.jsxs("form",{onSubmit:v(S),className:"space-y-6 mt-4",children:[s===0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200",children:"Choose Method"}),e.jsxs("select",{onChange:r=>b(r.target.value),value:a,className:"w-full py-3 px-4 rounded-md bg-white text-gray-900",children:[e.jsx("option",{value:"mobile",children:"Mobile"}),e.jsx("option",{value:"email",children:"Email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 capitalize",children:a}),e.jsx("input",{type:"text",readOnly:!0,value:A(a,o),className:"w-full py-3 px-4 rounded-md bg-gray-100 text-gray-900"})]})]}),s===1&&e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200",children:"Enter OTP"}),e.jsx("input",{type:"text",placeholder:"Enter OTP",...h("otp",{required:"OTP is required"}),className:"w-full py-3 px-4 rounded-md bg-white text-gray-900 border border-gray-300"}),n.otp&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:n.otp.message})]}),s===2&&e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200",children:"New Password"}),e.jsx("input",{type:"password",placeholder:"Enter new password",...h("newPassword",{required:"Password is required"}),className:"w-full py-3 px-4 rounded-md bg-white text-gray-900 border border-gray-300"}),n.newPassword&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:n.newPassword.message})]}),e.jsx(m.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:g,className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition",children:g?"Processing...":s===0?"Send OTP":s===1?"Verify OTP":"Change Password"})]})]}),e.jsx(_,{})]})})};export{H as default};
