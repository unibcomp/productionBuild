import{k as p,u as P,a as m,l as I,r as x,j as t,z as w,n as g,O as M,V as G}from"./index.BqcJufwq.js";import{B as R}from"./ActionButton.DSYbtvIQ.js";const S=s=>m.get("/gateways",{params:s}).then(a=>a.data),$=({pageNumber:s=1,pageSize:a=10,searchQuery:e="",gateway:o="",user_id:n})=>{const i={...o&&{gateway:o},...e&&{searchQuery:e},...s&&{pageNumber:s},...a&&{pageSize:a},user_id:n};return P({queryKey:["payment-gateways",i],queryFn:()=>S(i),staleTime:1e3*60*2})},C=s=>m.post("/gateway",s).then(a=>a.data),q=({id:s,data:a})=>m.put(`/gateway/${s}`,a).then(e=>e.data),B=()=>{const s=p({mutationFn:C}),a=p({mutationFn:q});return{createGateway:s,updateGateway:a}},D=({gatewayId:s,...a})=>m.get(`/gateway/${s}/methods`,{params:a}).then(e=>e.data),K=({pageNumber:s=1,pageSize:a=10,searchQuery:e="",gateway:o="",gatewayId:n="",user_id:i})=>{const u={...o&&{gateway:o},...e&&{searchQuery:e},...s&&{pageNumber:s},...a&&{pageSize:a},...n&&{gatewayId:n},user_id:i};return P({queryKey:["payment-gateways-method",u],queryFn:()=>D(u),staleTime:1e3*60*2})},O={UPI:"UPI",BANKTRANSFER:"BANKTRANSFER",IMPS:"IMPS",NEFT:"NEFT",RTGS:"RTGS",PAYTM:"PAYTM",AMAZONPAY:"AMAZONPAY",CARD:"CARD",MANUAL:"MANUAL",VISA:"visa",AMEX:"amex",DINERCLUB:"dinerclub",EMI:"emi",MASTER:"master",DEBITCARD:"debitCard",WALLET:"wallet",NETBANKING:"netBanking",UPI_LOWER:"upi"},U=({gatewayId:s,...a})=>m.post(`/gateway/${s}/method`,a).then(e=>e.data),Y=({id:s,data:a})=>m.put(`/gateway/${s}/update`,a).then(e=>e.data),k=()=>{const s=p({mutationFn:U}),a=p({mutationFn:Y});return{createGatewayMethod:s,updateGatewayMethod:a}},L=["CASHFREE","PHONEPAY","PAYU","UNIVERSALPAY","RAZORPAY","STRIPE"],H=({isOpen:s,onClose:a,data:e,refetch:o,isMethod:n})=>{var b,v;const{register:i,handleSubmit:u,reset:A,control:T,formState:{errors:d}}=I({defaultValues:n?{displayName:void 0,gatewayId:(e==null?void 0:e.gatewayId)||"",isActive:!0,min:0,max:0}:{user_id:e==null?void 0:e.user_id,name:void 0,isActive:!0}}),{createGateway:h}=B(),{createGatewayMethod:E}=k();x.useEffect(()=>{A(n?{displayName:void 0,gatewayId:(e==null?void 0:e.gatewayId)||"",isActive:!0,min:0,max:0}:{user_id:e==null?void 0:e.user_id,name:void 0,isActive:!0})},[e,A,n]);const F=r=>{const y={onSuccess:c=>{o(),a(),G.success(c.message||"Gateway created successfully")},onError:c=>{var N,f;G.error(((f=(N=c==null?void 0:c.response)==null?void 0:N.data)==null?void 0:f.message)||"Something went wrong while creating gateway")}},j={...r,...e};n?E.mutate(j,y):h.mutate(j,y)},l=d;return t.jsx(w,{appear:!0,show:s,as:x.Fragment,children:t.jsxs(g,{as:"div",className:"relative z-50",onClose:a,children:[t.jsx(w.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center px-4 py-6 text-center",children:t.jsx(w.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(g.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-xl bg-[#1a2c33] border border-[#2a3e4c] p-6 text-white align-middle shadow-xl transition-all",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(g.Title,{as:"h3",className:"text-lg font-semibold",children:n?"Add Gateway Method":"Create Payment Gateway"}),t.jsx(R,{buttons:[{label:"Close",onClick:a,variant:"danger"}]})]}),t.jsxs("form",{onSubmit:u(F),className:"mt-4 space-y-4",children:[t.jsx("div",{children:t.jsx("input",{type:"text",placeholder:n?"Gateway ID":"User ID",disabled:!0,value:n?e==null?void 0:e.gatewayId:e==null?void 0:e.user_id,className:"w-full py-2 px-3 rounded-md bg-gray-100 text-gray-700 border border-gray-300"})}),t.jsxs("div",{children:[t.jsxs("select",{...i(n?"displayName":"name",{required:"Gateway name is required"}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300",children:[t.jsx("option",{value:"",children:"Select Gateway"}),n?Object.entries(O).map(([r,y])=>t.jsx("option",{value:y,children:r},r)):L.map(r=>t.jsx("option",{value:r,children:r},r))]}),t.jsx("p",{className:"text-red-400 text-sm mt-1",children:(n?(b=l==null?void 0:l.displayName)==null?void 0:b.message:(v=d==null?void 0:d.name)==null?void 0:v.message)??""})]}),n&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("input",{type:"number",step:"0.01",placeholder:"Minimum Amount",...i("min",{required:"Minimum amount is required",min:{value:0,message:"Min must be >= 0"}}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300"}),l.min&&t.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.min.message})]}),t.jsxs("div",{children:[t.jsx("input",{type:"number",step:"0.01",placeholder:"Maximum Amount",...i("max",{required:"Maximum amount is required",min:{value:0,message:"Max must be >= 0"}}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300"}),l.max&&t.jsx("p",{className:"text-red-400 text-sm mt-1",children:l.max.message})]})]}),t.jsx("div",{children:t.jsx(M,{name:"isActive",control:T,defaultValue:!0,render:({field:r})=>t.jsx("button",{type:"button",role:"switch","aria-checked":r.value,onClick:()=>r.onChange(!r.value),className:`w-12 h-6 flex items-center rounded-full transition duration-300 focus:outline-none ${r.value?"bg-green-500":"bg-gray-300"}`,children:t.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${r.value?"translate-x-6":"translate-x-1"}`})})})}),t.jsx("div",{className:"mt-6",children:t.jsx("button",{type:"submit",disabled:h.isPending,className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition cursor-pointer",children:h.isPending?"Creating...":"Submit"})})]})]})})})})]})})};export{H as P,$ as a,k as b,K as c,B as u};
