import{g as $,i as q,k as F,n as I,o as Y,r as h,W as A,V as E,j as e,z as M,p as S,B as L,m as T,X as B,P as H,L as V,Y as k}from"./index.DG_WvTOT.js";import{u as G}from"./useSetting.BK2xFIAa.js";const z=d=>F.get("/reseller-list",{params:d}).then(o=>o.data),ee=({kycStatus:d="",searchQuery:o="",endDate:u="",startDate:l="",role:f,pageNumber:x=1,pageSize:n=10})=>{const _={...d&&{kycStatus:d},...f&&{role:f},...o&&{searchQuery:o},...l&&{startDate:l},...u&&{endDate:u},...x&&{pageNumber:x},...n&&{pageSize:n}},{isLoading:C,isError:p,data:c,refetch:t}=$({queryKey:["all reseller",_],queryFn:()=>z(_),staleTime:3e3,refetchOnWindowFocus:!1});return console.log("reseller",c),{isLoading:C,isError:p,data:c,refetch:t}},W=d=>F.post("/register/",d).then(o=>o.data),K=({user_id:d,data:o})=>F.put(`/admin-setting/update/${d}`,o).then(u=>u.data),D=()=>{const d=q({mutationFn:W});return{createOrUpdate:q({mutationFn:K}),registerUserMutation:d}},ae=({isOpen:d,closeModal:o,refetch:u,isSeller:l,isOperational:f})=>{const{user:x}=I(),{register:n,handleSubmit:_,reset:C,setValue:p,watch:c,formState:{errors:t}}=Y({defaultValues:{fullName:"",email:"",mobile:"",password:"",otp:"",otpMode:"",reseller_name:"",reseller_url:""}}),g=c("otpMode"),[a,w]=h.useState(!1),[O,P]=h.useState(!1),{registerUserMutation:b}=D(),y=s=>{b.mutate(s)},v=c("reseller_name"),r=c("reseller_url"),i=()=>{const s=c("fullName").trim();if(!s){E.error("Full name is required before generating.");return}const m=`5${Math.floor(Math.random()*1e9).toString().padStart(9,"0")}`,j=s.toLowerCase().replace(/\s+/g,""),N=B(r),U=`${j}${Math.floor(1e3+Math.random()*9e3)}${N}`,R=Math.floor(1e5+Math.random()*9e5).toString();p("mobile",m),p("email",U),p("otp",R),P(!0)};return h.useEffect(()=>{v&&v&&A[v]&&p("reseller_url",A[v])},[v,p]),h.useEffect(()=>{var m;const s=(m=Object.entries(A).find(([,j])=>j===r))==null?void 0:m[0];r&&s&&p("reseller_name",s)},[r,p]),h.useEffect(()=>{var s,m,j,N;if(b.isSuccess)C(),u==null||u(),o(),E.success("Successfully Created"),P(!1);else if(b.isError){const U=b.error,R=((m=(s=U.response)==null?void 0:s.data)==null?void 0:m.message)||((N=(j=U.response)==null?void 0:j.data)==null?void 0:N.error)||"Something went wrong";E.error(R)}},[b.isSuccess,b.isError]),e.jsx(M,{appear:!0,show:d,as:h.Fragment,children:e.jsxs(S,{as:"div",className:"relative z-[1000]",onClose:o,children:[e.jsx(M.Child,{as:h.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(S.Panel,{className:"w-full max-w-3xl rounded bg-white p-6 shadow-xl transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(S.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Account"}),e.jsx(L,{buttons:[{label:"Close",onClick:()=>o(),variant:"danger"}]})]}),e.jsxs("form",{onSubmit:_(y),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(x==null?void 0:x.role)==="SUPERADMIN"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsxs("select",{...n("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select reseller"}),Object.entries(A).map(([s])=>e.jsx("option",{value:s,children:s},s))]}),t.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsxs("select",{...n("reseller_url",{required:"Reseller URL is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select URL"}),Object.entries(A).map(([,s])=>e.jsx("option",{value:s,children:s},s))]}),t.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.reseller_url.message})]})]}),!l&&e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"OTP Mode"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{...n("otpMode",{required:"OTP Mode is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",children:[e.jsx("option",{value:"",children:"Select mode"}),e.jsx("option",{value:"STATIC",children:"STATIC"}),e.jsx("option",{value:"DYNAMIC",children:"DYNAMIC"})]}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),t.otpMode&&e.jsx("p",{className:"text-red-400 text-sm",children:t.otpMode.message})]}),(l||g)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",...n("fullName",{required:"Full Name is required"}),placeholder:"Enter full name",disabled:O,className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.fullName&&e.jsx("p",{className:"text-red-400 text-sm",children:t.fullName.message})]}),!l&&g==="STATIC"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col justify-end",children:O?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Your OTP"}),e.jsx("input",{type:"text",...n("otp",{required:"OTP is required"}),value:c("otp"),readOnly:g==="STATIC",disabled:g==="STATIC",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.otp&&e.jsx("p",{className:"text-red-400 text-sm",children:t.otp.message})]}):e.jsx(T.button,{type:"button",onClick:i,whileHover:{scale:1.03},whileTap:{scale:.97},className:"w-full py-2 px-4 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg",children:"Generate"})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",disabled:!l&&g!="DYNAMIC",...n("email",{required:"Email is required"}),placeholder:"Enter email",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.email&&e.jsx("p",{className:"text-red-400 text-sm",children:t.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Mobile"}),e.jsx("input",{type:"text",disabled:!l&&g!="DYNAMIC",maxLength:10,inputMode:"numeric",...n("mobile",{required:"Mobile number is required",pattern:{value:/^[5-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),placeholder:"Enter mobile number",...n("mobile",{required:"Mobile is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.mobile&&e.jsx("p",{className:"text-red-400 text-sm",children:t.mobile.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:a?"text":"password",...n("password",{required:"Password is required"}),placeholder:"Create a password",className:"w-full py-3 px-4 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),e.jsx("span",{onClick:()=>w(!a),className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer",children:a?"visibility_off":"visibility"})]}),t.password&&e.jsx("p",{className:"text-red-400 text-sm",children:t.password.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{...n("role",{required:"Role is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",disabled:l,children:l?e.jsx("option",{value:"ADMIN",selected:!0,children:"Admin"}):f?e.jsx("option",{value:"OPERATIONAL",selected:!0,children:"OPERATIONAL"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"API_USER",children:"API User"}),e.jsx("option",{value:"APP_USER",children:"App User"}),e.jsx("option",{value:"PAYOUT_APP_USER",children:"PAYOUT APP USER"}),e.jsx("option",{value:"PAYOUT_API_USER",children:"PAYOUT API USER"})]})}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),t.role&&e.jsx("p",{className:"text-red-400 text-sm",children:t.role.message})]})]})]}),e.jsx(T.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:b.isPending,className:"w-full py-3 bg-[#185e91] hover:bg-[#1b6ca8] text-white font-semibold rounded-lg",children:b.isPending?"Processing...":"Create Account"})]})]})})})]})})},X=(d,o,u,l)=>f=>{if(l){const x=Number(u[d]??0);return f>=x?!0:`${o} must be greater than or equal to ${x}`}return!0},J=[{value:"PHONEPAY",label:"PHONEPAY"},{value:"PAYU",label:"PAYU"},{value:"GATEPAY",label:"GATEPAY"}],se=({user_id:d,isOpen:o,closeModal:u,isUser:l,role:f,reseller_name:x,reseller_url:n})=>{const{data:_,isLoading:C,refetch:p}=G({user_id:d}),{createOrUpdate:c}=D(),{user:t}=I(),g=(t==null?void 0:t.Setting)||{},a=_||g,{register:w,handleSubmit:O,control:P,reset:b,formState:{errors:y}}=Y({defaultValues:{reseller_name:(a==null?void 0:a.reseller_name)||x,reseller_url:(a==null?void 0:a.reseller_url)||n,paymentMode:(a==null?void 0:a.paymentMode)||"PAYU",payoutMode:(a==null?void 0:a.payoutMode)||"UPI",dispute_days:(a==null?void 0:a.dispute_days)||7,breach_penalty_perce:(a==null?void 0:a.breach_penalty_perce)||0,breach_penalty_refund:(a==null?void 0:a.breach_penalty_refund)||0,breach_penalty_payout:(a==null?void 0:a.breach_penalty_payout)||0,transaction_payment_fees:(a==null?void 0:a.transaction_payment_fees)||0,transaction_vendor_payout_fee:(a==null?void 0:a.transaction_vendor_payout_fee)||0,transaction_refund_fees:(a==null?void 0:a.transaction_refund_fees)||0,transaction_at_onetime:(a==null?void 0:a.transaction_at_onetime)||0,transaction_montly_fees:(a==null?void 0:a.transaction_montly_fees)||0,user_id:a==null?void 0:a.user_id,upi:(a==null?void 0:a.upi)||.35,wallet:(a==null?void 0:a.wallet)||3.1,netBanking:(a==null?void 0:a.netBanking)||3,visaCard:(a==null?void 0:a.visaCard)||3,amexCard:(a==null?void 0:a.amexCard)||0,dinerclubCard:(a==null?void 0:a.dinerclubCard)||4.1,emiCard:(a==null?void 0:a.emiCard)||3.3,masterCard:(a==null?void 0:a.masterCard)||3,debitCardUpto2000:(a==null?void 0:a.debitCardAbove2000)||1.45,debitCardAbove2000:(a==null?void 0:a.debitCardAbove2000)||1.95,status:(a==null?void 0:a.status)??!1,minPayOut:(a==null?void 0:a.minPayOut)||10,maxPayOut:(a==null?void 0:a.maxPayOut)||.3,settlment_hold_percentage:a.settlment_hold_percentage||0}});h.useEffect(()=>{(a||x||n)&&b({reseller_name:a.reseller_name||x,reseller_url:a.reseller_url||n,paymentMode:a.paymentMode||"CASHFREE",payoutMode:a.payoutMode||"UPI",dispute_days:a.dispute_days||7,breach_penalty_perce:a.breach_penalty_perce||0,breach_penalty_refund:a.breach_penalty_refund||0,breach_penalty_payout:a.breach_penalty_payout||0,transaction_payment_fees:a.transaction_payment_fees||0,transaction_vendor_payout_fee:a.transaction_vendor_payout_fee||0,transaction_refund_fees:a.transaction_refund_fees||0,transaction_at_onetime:a.transaction_at_onetime||0,transaction_montly_fees:a.transaction_montly_fees||0,user_id:a.user_id,upi:a.upi||.35,wallet:a.wallet||3.1,netBanking:a.netBanking||3,visaCard:a.visaCard||3,amexCard:a.amexCard||0,dinerclubCard:a.dinerclubCard||4.1,emiCard:a.emiCard||3.3,masterCard:a.masterCard||3,debitCardUpto2000:a.debitCardUpto2000||1.45,debitCardAbove2000:a.debitCardAbove2000||1.95,status:a.status??!1,minPayOut:a.minPayOut||10,maxPayOut:a.maxPayOut||.3,settlment_hold_percentage:a.settlment_hold_percentage||0})},[_,b,p,g,x,n]);const v=i=>{c.mutate({user_id:d,data:i})};h.useEffect(()=>{var i;if(c.isSuccess)E.success("Updated successfully"),u(),p();else if(c.isError){const m=(i=c.error.response)==null?void 0:i.data;E.error((m==null?void 0:m.error)||(m==null?void 0:m.message))}},[c.isError,c.isSuccess]);const r=(i,s,m,j="0.01")=>{var N;return e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:i}),e.jsx("input",{type:"number",step:j,placeholder:m,...w(s,{required:`${i} is required`,valueAsNumber:!0,validate:X(s,i,g,l)}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),y[s]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:((N=y[s])==null?void 0:N.message)??""})]})};return e.jsx(M,{show:o,as:h.Fragment,children:e.jsxs(S,{as:"div",className:"relative z-50",onClose:u,children:[e.jsx(M.Child,{as:h.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 ",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(M.Child,{as:h.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-90",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-90",children:e.jsxs(S.Panel,{className:"custom-scroll h-[90vh] relative w-full max-w-5xl transform overflow-hidden rounded-lg bg-white p-0 text-left align-middle shadow-xl transition-all z-100",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white border-b px-4 py-3 flex items-center justify-between shadow-sm ",children:e.jsx(H,{title:`${l?"User":"Admin"} Setting`,searchComponent:e.jsx(L,{buttons:[{label:"Close",onClick:()=>u(),variant:"danger"}]})})}),e.jsx("div",{className:"p-4",children:C?e.jsx(V,{}):l&&(t==null?void 0:t.role)==="ADMIN"&&g&&Object.keys(g).length<1?e.jsx("div",{children:"Failed To Load"}):e.jsxs("form",{onSubmit:O(v),className:"space-y-4",children:[!l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsx("input",{type:"text",disabled:!0,placeholder:"Enter reseller name",...w("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),y.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsx("input",{type:"url",disabled:!0,placeholder:"https://example.com",...w("reseller_url",{required:"Reseller URL is required",pattern:{value:/^(https?:\/\/)?([\w\-])+\.\w{2,}(\S*)?$/i,message:"Enter a valid URL"}}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),y.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.reseller_url.message})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Payment Mode"}),e.jsx(k,{name:"paymentMode",control:P,rules:{required:"Payment mode is required"},render:({field:i})=>e.jsxs("select",{...i,className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select payment mode"}),J.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})}),y.paymentMode&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.paymentMode.message})]})}),r("Dispute Days","dispute_days","Enter dispute days","1"),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Breach Penalty %","breach_penalty_perce","Percentage"),r("Breach Penalty Refund","breach_penalty_refund","Refund amount"),r("Breach Penalty Payout","breach_penalty_payout","Payout amount")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Payment Fees","transaction_payment_fees","Payment fees"),r("Vendor Payout Fees","transaction_vendor_payout_fee","Vendor payout fees"),r("Refund Fees","transaction_refund_fees","Refund fees")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("One‑time Fees","transaction_at_onetime","One‑time fees"),r("Monthly Fees","transaction_montly_fees","Monthly fees")]}),!["PAYOUT_APP_USER"].includes(f??"")&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayIn Charge Configuration"}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("UPI  (%)","upi","Ex: 0.95"),r("Wallet  (%)","wallet","Ex: 1.2"),r("Net Banking  (%)","netBanking","Ex: 1.5")]}),e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Card Wise (%)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Visa Card","visaCard","Ex: 1.2"),r("MasterCard","masterCard","Ex: 1.25"),r("Amex Card","amexCard","Ex: 1.3"),r("Diner Club","dinerclubCard","Ex: 1.4"),r("EMI Card","emiCard","Ex: 2.0")]}),e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Debit Card Slabs (%)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("Upto INR 2000","debitCardUpto2000","Ex: 1.45"),r("Above INR 2000","debitCardAbove2000","Ex: 1.95"),r("Settlment Hold (%)","settlment_hold_percentage","Ex: 1")]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayOut Charge  Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Min(Flat)","minPayOut","Ex: 0.95"),r("max(%) ","maxPayOut","Ex: 1.2")]})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Status"}),e.jsx(k,{name:"status",control:P,render:({field:i})=>e.jsx("button",{type:"button",role:"switch","aria-checked":i.value,onClick:()=>i.onChange(!i.value),className:`w-12 h-6 flex items-center rounded-full transition duration-300 focus:outline-none ${i.value?"bg-green-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${i.value?"translate-x-6":"translate-x-1"}`})})})]}),e.jsx(T.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:c.isPending,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-md transition",children:c.isPending?"Saving...":"Save"})]})})]})})})})]})})};export{se as A,ae as C,ee as u};
