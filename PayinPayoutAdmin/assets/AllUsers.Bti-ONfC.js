import{k as I,l as C,o as R,i as T,r as y,j as e,z as D,p as v,V as b,Q as P,u as U,b as w,q as V,n as k,a as F,x as O,m as S,c as L,P as B,S as W,B as M,L as _,N as z,d as K,C as G}from"./index.CV2AEKHB.js";import{u as J}from"./useDeleteAndSuspendUser.DSHf1Ato.js";import{K as H,V as $}from"./ViewUserDetailsModal.Bdn_guOl.js";import{C as Q}from"./RegisterUserModal.hcOGW6rn.js";import{D as Z}from"./DepWithModal.BFgeAGLV.js";import{A as q}from"./AdminSetting.C-qfuMAn.js";import"./useManualPayin.DutEC8Fg.js";import"./useTransaction.DotMZo_4.js";import"./useSetting.PCF_KvtO.js";const Y=o=>C.put("/user/update/",o).then(r=>r.data),X=()=>I({mutationFn:Y,mutationKey:["update-kyc"]});function ee({isOpen:o,data:r,isUser:u,closeModal:m}){const{register:l,handleSubmit:g,reset:x,formState:{errors:s}}=R({defaultValues:r}),j=T(),{mutate:p}=X();y.useEffect(()=>{r&&x(r)},[r,x]);const h=a=>{u&&p(a,{onSuccess:n=>{const t=(n==null?void 0:n.message)||"KYC updated successfully!";m(),b.success(t),j.invalidateQueries({queryKey:["Allusers"]})},onError:n=>{var c,i,E,N;const t=((i=(c=n==null?void 0:n.response)==null?void 0:c.data)==null?void 0:i.error)||((N=(E=n==null?void 0:n.response)==null?void 0:E.data)==null?void 0:N.message)||"Something went wrong";b.error(t)}})};return e.jsx(D,{appear:!0,show:o,as:y.Fragment,children:e.jsxs(v,{as:"div",className:"relative z-1000",onClose:m,children:[e.jsx(D.Child,{as:y.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm","aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(v.Panel,{className:"w-full max-w-3xl transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsx(v.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Edit User Account"}),e.jsxs("form",{onSubmit:g(h),className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name (Kyc)"}),e.jsx("input",{...l("firstName",{valueAsNumber:!1}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name (Kyc)"}),e.jsx("input",{...l("lastName",{valueAsNumber:!1}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{...l("full_name",{valueAsNumber:!1}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"mobile"}),e.jsx("input",{...l("mobile",{valueAsNumber:!1}),type:"number",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"email"}),e.jsx("input",{...l("email",{valueAsNumber:!1}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{...l("address",{valueAsNumber:!1}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PersonalInformation Status"}),e.jsxs("select",{...l("personalInformationStatus"),className:"input",defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status (Optional)"}),e.jsx("option",{value:"PENDING",children:"PENDING"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"UNDER_REVIEW",children:"UNDER REVIEW"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"NEEDS_CLARIFICATION",children:"NEEDS CLARIFICATION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aadhar Number"}),e.jsx("input",{...l("aadharNumber",{validate:a=>a?/^\d{12}$/.test(a)||"Aadhar Number must be exactly 12 digits":!0}),type:"text",maxLength:12,inputMode:"numeric",className:"input",placeholder:"Enter 12-digit Aadhar Number"}),(s==null?void 0:s.aadharNumber)&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.aadharNumber.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Aadhaar Status"}),e.jsxs("select",{...l("aadharStatus"),className:"input",defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status (Optional)"}),e.jsx("option",{value:"PENDING",children:"PENDING"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"UNDER_REVIEW",children:"UNDER REVIEW"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"NEEDS_CLARIFICATION",children:"NEEDS CLARIFICATION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN Number"}),e.jsx("input",{...l("panNumber",{setValueAs:a=>a==null?void 0:a.toUpperCase(),validate:a=>a?/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(a)||"Invalid PAN format":!0}),type:"text",maxLength:10,className:"input",onInput:a=>{a.currentTarget.value=a.currentTarget.value.toUpperCase()},placeholder:"ABCDE1234F"}),(s==null?void 0:s.panNumber)&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.panNumber.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pan Status"}),e.jsxs("select",{...l("panStatus"),className:"input",defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status (Optional)"}),e.jsx("option",{value:"PENDING",children:"PENDING"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"UNDER_REVIEW",children:"UNDER REVIEW"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"NEEDS_CLARIFICATION",children:"NEEDS CLARIFICATION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{...l("accountNumber",{pattern:{value:/^\d+$/,message:"Account Number must contain digits only"},minLength:{value:9,message:"Account Number must be at least 9 digits"},maxLength:{value:18,message:"Account Number must be at most 18 digits"}}),type:"text",inputMode:"numeric",className:"input",placeholder:"Enter Account Number"}),(s==null?void 0:s.accountNumber)&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.accountNumber.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IFSC Code"}),e.jsx("input",{...l("ifscCode",{setValueAs:a=>a==null?void 0:a.toUpperCase(),validate:a=>a?/^[A-Z]{4}0[A-Z0-9]{6}$/.test(a)||"Invalid IFSC code":!0}),type:"text",maxLength:11,className:"input",onInput:a=>{a.currentTarget.value=a.currentTarget.value.toUpperCase()},placeholder:"e.g. SBIN0001234"}),(s==null?void 0:s.ifscCode)&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.ifscCode.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{...l("bankName",{valueAsNumber:!1}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Status"}),e.jsxs("select",{...l("bankStatus"),className:"input",defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status (Optional)"}),e.jsx("option",{value:"PENDING",children:"PENDING"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"UNDER_REVIEW",children:"UNDER REVIEW"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"NEEDS_CLARIFICATION",children:"NEEDS CLARIFICATION"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remark"}),e.jsx("input",{...l("remark",{valueAsNumber:!0}),type:"text",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Status"}),e.jsxs("select",{...l("businessStatus"),className:"input",defaultValue:"",children:[e.jsx("option",{value:"",children:"Select Status (Optional)"}),e.jsx("option",{value:"PENDING",children:"PENDING"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"}),e.jsx("option",{value:"UNDER_REVIEW",children:"UNDER REVIEW"}),e.jsx("option",{value:"APPROVED",children:"APPROVED"}),e.jsx("option",{value:"REJECTED",children:"REJECTED"}),e.jsx("option",{value:"NEEDS_CLARIFICATION",children:"NEEDS CLARIFICATION"})]})]})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"rounded border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700",children:"Save"})]})]})]})})})]})})}const se=o=>{const r=P();return new URLSearchParams(r.search).get(o)},me=()=>{var N,A;const{handlePageChange:o,handlePageSizeChange:r,pageNumber:u,pageSizeValue:m}=U(),{setSearchQuery:l,searchQuery:g}=w(),x=se("userAction"),{data:s,isError:j,isLoading:p,refetch:h}=V({pageNumber:u,pageSize:m,searchQuery:g,...x&&{userAction:x}}),{mutate:a}=J(),{user:d}=k(),{openModal:n,isModalOpen:t,closeModal:c,data:i}=F(),{allUsers:E}=O();return e.jsxs(S.div,{className:"bg-white shadow-lg rounded-2xl",variants:L,initial:"hidden",animate:"visible",children:[e.jsx(B,{title:"All Users",searchComponent:e.jsxs(e.Fragment,{children:[e.jsx(W,{handlePageSizeChange:r,pageSizeOptions:[10,20,30],pageSize:m,setSearchQuery:l}),E.write&&e.jsx(M,{buttons:[{label:" Create User",onClick:()=>n({isRegister:!0},i),variant:"primary"}]})]})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Full Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),(d==null?void 0:d.role)==="SUPERADMIN"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"reseller Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"A/C No"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Aadhar No"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Pan No"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Kyc Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"User Type"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"UnSettled"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Hold"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Wallet Frozen"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap min-w-[160px]",children:"Actions"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"View"})]})}),!j&&(s==null?void 0:s.data.length)!=0&&!p&&e.jsx(H,{data:(s==null?void 0:s.data)||[],isAll:!0,openModal:n,role:d==null?void 0:d.role},`All_${u}-${(N=s==null?void 0:s.data)==null?void 0:N.length}_${p}`)]}),p?e.jsx(_,{}):(j||((A=s==null?void 0:s.data)==null?void 0:A.length)===0)&&e.jsx(z,{})]}),e.jsxs(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:[e.jsx(K,{currentPage:u,handlePageChange:o,pageSize:m,handlePageSizeChange:r,totalCount:(s==null?void 0:s.pagination.total)||1}),e.jsx(ee,{isOpen:t.editUser||!1,closeModal:()=>c({editUser:!1}),data:i,isUser:!0}),e.jsx(G,{isOpen:t.confirm||!1,onClose:()=>c({confirm:!1}),onConfirm:()=>{i!=null&&i.user_id&&a({user_id:i.user_id,isDeleted:!0},{onSuccess:f=>{c({confirm:!1}),b.success(f.message||"User deleted successfully")},onError:f=>{b.error(f.message)}})},title:"Delete User",description:"Are you sure you want to delete this user ?"}),e.jsx($,{isOpen:t.view||!1,onClose:()=>c({view:!1}),data:i}),e.jsx(Q,{isOpen:(t==null?void 0:t.isRegister)||!1,closeModal:()=>c({isRegister:!1}),refetch:h}),e.jsx(Z,{isOpen:t.isWithdraw||t.isDeposit||t.isHold||!1,onClose:()=>c({...t!=null&&t.isWithdraw?{isWithdraw:!1}:{},...t!=null&&t.isDeposit?{isDeposit:!1}:{},...t!=null&&t.isHold?{isHold:!1}:{}}),isHold:t.isHold||!1,refetch:h,user_id:i==null?void 0:i.user_id,isWithdraw:t.isWithdraw||!1,isRealesed:t.isRealesed||!1}),e.jsx(q,{isOpen:(t==null?void 0:t.isAdminSetting)||!1,user_id:(i==null?void 0:i.user_id)||null,closeModal:()=>c({isAdminSetting:!1}),isUser:!0,refetch:h,role:i==null?void 0:i.role})]})]})};export{me as default};
