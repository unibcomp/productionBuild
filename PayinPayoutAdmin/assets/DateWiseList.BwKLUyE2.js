import{j as e,z as P,r as v,l as f,t as M,b as I,h as E,n as L,e as O,c as k,m as U,f as R,P as q,S as B,L as Q,N as W,g as _,C as $,V as C}from"./index.BWf0QJJx.js";import{a as H,u as G}from"./useDeposit.BxO8PP_R.js";import{D as J}from"./DateWiseTableBody.9fOn03ff.js";import{a as K,M as X}from"./MpinVerifyModal.CXO4-L-3.js";import{u as Y}from"./index.esm.D2YuALNd.js";import{u as Z}from"./useManualPayin.BKBbpwZr.js";import"./useMpin.B0p290Dl.js";const ee=({transaction_id:m,closeModal:p,isOpen:d})=>{const{register:i,handleSubmit:h,formState:{errors:x}}=Y(),{createUpdateUtrMutation:o}=Z(),r=n=>{o.mutate({transaction_id:m,data:n},{onError:l=>{var a;const s=(a=l.response)==null?void 0:a.data;M.error((s==null?void 0:s.message)||(s==null?void 0:s.error)),p()},onSuccess:l=>{M.success(l.message||"SuccesFully Updated")}})};return e.jsx(P,{appear:!0,show:d,as:v.Fragment,children:e.jsxs(f,{as:"div",className:"relative z-50",onClose:p,children:[e.jsx(P.Child,{as:v.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(f.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsx(f.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Update Utr"}),e.jsxs("form",{onSubmit:h(r),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",...i("utr",{required:"Utr is required"}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none",placeholder:"Enter Utr Number"}),x.utr&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:x.utr.message})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition cursor-pointer",children:o.isPending?"Processing...":"Submit"})]})]})})})]})})},le=()=>{var w,b;const{handlePageChange:m,handlePageSizeChange:p,pageNumber:d,pageSizeValue:i,startItem:h}=I(),{openModal:x,isModalOpen:o,closeModal:r,data:n}=E(),{date:l,status:s,type:a}=L(),{user:u}=O(),D=a==="Pay-In",{setSearchQuery:V,searchQuery:j}=k(),{updateDepositMutation:y}=H(),{data:t,isError:N,isLoading:g,refetch:z}=a==="Pay-In"?G({searchQuery:j,pageNumber:d,pageSize:i,date:l,status:s==null?void 0:s.toUpperCase()},D):K({searchQuery:j,pageNumber:d,pageSize:i,date:l,status:s==null?void 0:s.toUpperCase()}),F=T=>{y.mutate(T,{onSuccess:()=>{z(),C.success("Action  Completed SuccessFully"),r({isVerifyMpin:!1})},onError:A=>{var S;const c=(S=A.response)==null?void 0:S.data;C.error((c==null?void 0:c.message)||(c==null?void 0:c.error)),r({isVerifyMpin:!1})}})};return e.jsxs(U.div,{className:"bg-white shadow-lg rounded-2xl",variants:R,initial:"hidden",animate:"visible",children:[e.jsx(q,{title:`${a} ${s} List`,searchComponent:e.jsx(B,{handlePageSizeChange:p,pageSizeOptions:[10,20,30],pageSize:i,setSearchQuery:V})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),((w=u==null?void 0:u.role)==null?void 0:w.toUpperCase())==="SUPERADMIN"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Reseller Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Mode"}),a==="Pay-In"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Type"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Utr"}),a==="Pay-In"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Ref"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"file"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Date"})]}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Transaction Id"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Initiated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Completed At"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap",children:"Actions"})]})}),!N&&((b=t==null?void 0:t.results)==null?void 0:b.length)!=0&&!g&&e.jsx(J,{data:(t==null?void 0:t.results)||[],openModal:x,isPending:g,type:a,start_number:h})]}),g?e.jsx(Q,{}):(N||(t==null?void 0:t.results.length)===0)&&e.jsx(W,{})]}),e.jsxs(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:[e.jsx(_,{currentPage:d,handlePageChange:m,pageSize:i,handlePageSizeChange:p,totalCount:(t==null?void 0:t.pagination.total)||1}),e.jsx($,{isOpen:o.confirm||!1,onClose:()=>r({confirm:!1}),onConfirm:()=>x({isVerifyMpin:!0},n),disabled:y.isPending,title:"Transaction",description:"Are you sure you want to Change this Transaction ?"}),e.jsx(X,{isOpen:o.isVerifyMpin||!1,closeModal:()=>r({isVerifyMpin:!1}),onVerify:()=>F(n),isNextTaskPending:y.isPending}),e.jsx(ee,{transaction_id:n==null?void 0:n.transaction_id,isOpen:o.isUtr||!1,closeModal:()=>r({isUtr:!1})})]})]})};export{le as default};
