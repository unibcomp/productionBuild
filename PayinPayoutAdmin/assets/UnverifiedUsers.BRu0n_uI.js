import{i as V,k as z,V as b,a as M,j as e,z as N,r as v,l as u,b as P,c as F,h as A,m as w,f as _,P as O,S as U,L as T,N as B,g as E,C as I}from"./index.BWf0QJJx.js";import{u as L}from"./useUsers.DfV3s5nP.js";import{K as Q,V as Y}from"./ViewUserDetailsModal.D9R0Bwrr.js";import{I as $}from"./ImageModal.D_mVUR-T.js";import{u as q}from"./index.esm.D2YuALNd.js";import{B as R}from"./ActionButton.7lH3Pgvl.js";import"./useDeleteAndSuspendUser.BikqfEde.js";const S=()=>{const c=V();return z({mutationFn:async s=>(await M.put("/user/kyc-reject-accept/",s)).data,onSuccess:s=>{b.success((s==null?void 0:s.message)||"KYC status updated successfully"),c.invalidateQueries({queryKey:["Allusers"]})},onError:s=>{var n,i,l,d;const r=((i=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:i.error)||((d=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:d.message)||"Failed to update KYC status";b.error(r)}})},H=["personalInformationStatus","aadharStatus","panStatus","businessStatus","bankStatus","photoStatus","videoStatus"];function D({isOpen:c,onClose:s,data:r}){const{handleSubmit:n,reset:i,watch:l,getValues:d,setValue:m}=q(),{mutate:x}=S(),o=a=>{x({user_id:r.user_id,...a},{onSuccess:()=>{s(),i()}})};return e.jsx(N,{appear:!0,show:c,as:v.Fragment,children:e.jsxs(u,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(N.Child,{as:v.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm","aria-hidden":"true"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(u.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Decline / Approve KYC Fields"}),e.jsx(R,{buttons:[{label:"Close",onClick:()=>s(),variant:"danger"}]})]}),e.jsxs("form",{onSubmit:n(o),className:"grid grid-cols-1 gap-4",children:[H.map(a=>e.jsxs("div",{className:"flex items-center justify-between border p-3 rounded-md bg-gray-50",children:[e.jsx("label",{className:"text-sm font-semibold capitalize text-gray-800",children:a.replace(/_/g," ")}),e.jsxs("button",{type:"button",onClick:()=>m(a,!d(a)),className:`flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium transition
                        ${l(a)?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}
                      `,children:[e.jsx("span",{className:"material-symbols-outlined text-lg leading-none",children:l(a)?"toggle_off":"toggle_on"}),l(a)?"Rejected":"Approved"]})]},a)),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"rounded border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",className:"rounded bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700",children:"Save"})]})]})]})})})]})})}const ae=({type:c})=>{var g,y,f;const{handlePageChange:s,handlePageSizeChange:r,pageNumber:n,pageSizeValue:i}=P(),{setSearchQuery:l,searchQuery:d}=F(),{isModalOpen:m,openModal:x,closeModal:o,data:a,isImageModelOpen:C}=A();console.log(C);const{data:t,isError:h,isLoading:p}=L({pageNumber:n,pageSize:i,searchQuery:d,kycStatus:c}),{mutate:k}=S(),K=j=>{k({user_id:j.user_id,kycStatus:j.status},{onSuccess:()=>{o({confirm:!1})}})};return e.jsxs(w.div,{className:"bg-white shadow-lg rounded-2xl",variants:_,initial:"hidden",animate:"visible",children:[e.jsx(O,{title:"KYC Verifications",searchComponent:e.jsx(U,{handlePageSizeChange:r,pageSizeOptions:[10,20,30],pageSize:i,setSearchQuery:l})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Full Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"A/C No"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Aadhar No"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Pan No"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap",children:"Current Status"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap min-w-[160px]",children:"Actions"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"View"})]})}),!h&&((g=t==null?void 0:t.data)==null?void 0:g.length)!=0&&!p&&e.jsx(Q,{data:(t==null?void 0:t.data)||[],unVerified:!0,unVerifiedTye:c,openModal:x},`unverify_${n}-${(y=a==null?void 0:a.data)==null?void 0:y.length}_${p}`)]}),p?e.jsx(T,{}):(h||(t==null?void 0:t.data.length)===0)&&e.jsx(B,{})]}),e.jsx(w.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:e.jsx(E,{currentPage:n,handlePageChange:s,pageSize:i,handlePageSizeChange:r,totalCount:((f=t==null?void 0:t.pagination)==null?void 0:f.total)||1})}),e.jsx(I,{isOpen:m.confirm||!1,onClose:()=>o({confirm:!1}),onConfirm:()=>K(a)}),e.jsx(D,{isOpen:m.decline||!1,onClose:()=>o({decline:!1}),data:a}),e.jsx($,{imageUrl:a==null?void 0:a.imageUrl,isOpen:m.image||!1,onClose:()=>o({image:!1})}),e.jsx(Y,{isOpen:m.view||!1,onClose:()=>o({view:!1}),data:a})]})};export{ae as default};
