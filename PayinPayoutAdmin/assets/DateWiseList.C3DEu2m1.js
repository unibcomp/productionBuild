import{l as G,j as e,z as b,r as N,n as j,v as F,u as O,c as q,P as z,L as I,e as B,d as D,o as Q,h as W,f as $,m as V,i as H,S as K,N as J,k as X,C as Y,V as g}from"./index.lh4JBQzm.js";import{a as Z,d as _,u as ee}from"./useDeposit.CzT0RboD.js";import{D as se}from"./DateWiseTableBody.DjjAwD1b.js";import{a as te,M as ae}from"./MpinVerifyModal.D-PgxRFu.js";import{u as ne}from"./useManualPayin.B7Lamn0z.js";import"./useMpin.UjavSp9j.js";const re=({transaction_id:o,closeModal:t,isOpen:d})=>{const{register:n,handleSubmit:h,formState:{errors:x}}=G(),{createUpdateUtrMutation:s}=ne(),l=r=>{s.mutate({transaction_id:o,data:r},{onError:u=>{var p;const a=(p=u.response)==null?void 0:p.data;F.error((a==null?void 0:a.message)||(a==null?void 0:a.error)),t()},onSuccess:u=>{F.success(u.message||"SuccesFully Updated")}})};return e.jsx(b,{appear:!0,show:d,as:N.Fragment,children:e.jsxs(j,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(b.Child,{as:N.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(j.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsx(j.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Update Utr"}),e.jsxs("form",{onSubmit:h(l),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",...n("utr",{required:"Utr is required"}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none",placeholder:"Enter Utr Number"}),x.utr&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:x.utr.message})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition cursor-pointer",children:s.isPending?"Processing...":"Submit"})]})]})})})]})})},ie=(o,t,d=!0)=>O({queryKey:["taxReportByTransaction",o,t],enabled:d&&!!o&&!!t,queryFn:async()=>{const n=await q.get("/tax-report-specific-transaction",{params:{transaction_id:o,type:t}});if(!n.data.success||!n.data.data)throw new Error("No tax data found");return n.data.data}});function oe({isOpen:o,onClose:t,type:d,transaction_id:n}){const{data:h,isLoading:x}=ie(n,d,o),s=h,l=((s==null?void 0:s.companyTaxAmount)??0)+((s==null?void 0:s.gstApplyAmount)??0)+((s==null?void 0:s.resellerTaxAmount)??0)+((s==null?void 0:s.resellerGstAmount)??0);return e.jsx(b,{appear:!0,show:o,as:N.Fragment,children:e.jsxs(j,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(b.Child,{as:N.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6",children:e.jsx(j.Panel,{className:"w-full max-w-xl transform overflow-hidden rounded-2xl bg-white shadow-2xl transition-all border border-blue-100",children:e.jsxs("div",{className:"p-6 sm:p-8",children:[e.jsx(z,{title:"ðŸ§¾ Tax Transaction Details"}),e.jsxs("div",{className:"my-6 text-center",children:[e.jsxs("div",{className:"text-sm text-gray-600 font-semibold mb-1",children:["Type: ",e.jsx("span",{className:"text-gray-800",children:d})]}),e.jsxs("div",{className:"text-sm text-gray-600 font-semibold",children:["Transaction ID:"," ",e.jsx("span",{className:"text-gray-800",children:n})]})]}),x?e.jsx(I,{}):e.jsxs("div",{className:"grid grid-cols-1 gap-2 max-h-[58vh] overflow-y-auto",children:[e.jsx(f,{label:"Total Amount",value:l||0}),e.jsx(f,{label:"Gateway Charges",value:(s==null?void 0:s.companyTaxAmount)||0}),e.jsx(f,{label:"Gateway GST",value:(s==null?void 0:s.gstApplyAmount)||0}),e.jsx(f,{label:"Company Charges",value:(s==null?void 0:s.resellerTaxAmount)||0}),e.jsx(f,{label:"Company GST",value:(s==null?void 0:s.resellerGstAmount)||0})]}),e.jsx("div",{className:"flex justify-end pt-10",children:e.jsx("button",{onClick:t,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md shadow-sm text-sm font-medium transition",children:"Close"})})]})})})})]})})}function f({label:o,value:t}){return e.jsxs("div",{className:"bg-white border border-gray-200 p-3 rounded-xl shadow-sm",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:o}),e.jsxs("p",{className:"text-base text-gray-800 font-medium",children:["â‚¹ ",(t==null?void 0:t.toFixed(2))??"â€”"]})]})}const ue=()=>{var A,U;const{handlePageChange:o,handlePageSizeChange:t,pageNumber:d,pageSizeValue:n,startItem:h}=B(),{openModal:x,isModalOpen:s,closeModal:l,data:r}=D(),{date:u,status:a,type:p}=Q(),{user:w}=W(),k=p==="Pay-In",{setSearchQuery:E,searchQuery:P}=$(),{updateDepositMutation:v}=Z(),{updateReverseMutation:R}=_(),{data:c,isError:C,isLoading:S,refetch:M}=p==="Pay-In"?ee({searchQuery:P,pageNumber:d,pageSize:n,date:u,status:a==null?void 0:a.toUpperCase()},k):te({searchQuery:P,pageNumber:d,pageSize:n,date:u,status:a==null?void 0:a.toUpperCase()}),L=m=>{m!=null&&m.transaction_id&&(m!=null&&m.isReverse)?R.mutate(m.transaction_id,{onSuccess:()=>{M(),g.success("Action  Completed SuccessFully"),l({isVerifyMpin:!1})},onError:T=>{var y;const i=(y=T.response)==null?void 0:y.data;g.error((i==null?void 0:i.message)||(i==null?void 0:i.error)),l({isVerifyMpin:!1})}}):v.mutate(m,{onSuccess:()=>{M(),g.success("Action  Completed SuccessFully"),l({isVerifyMpin:!1})},onError:T=>{var y;const i=(y=T.response)==null?void 0:y.data;g.error((i==null?void 0:i.message)||(i==null?void 0:i.error)),l({isVerifyMpin:!1})}})};return e.jsxs(V.div,{className:"bg-white shadow-lg rounded-2xl",variants:H,initial:"hidden",animate:"visible",children:[e.jsx(z,{title:`${p} ${a} List`,searchComponent:e.jsx(K,{handlePageSizeChange:t,pageSizeOptions:[10,20,30],pageSize:n,setSearchQuery:E})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),((A=w==null?void 0:w.role)==null?void 0:A.toUpperCase())==="SUPERADMIN"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Reseller Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Mode"}),p==="Pay-In"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Type"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Utr"}),p==="Pay-In"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Ref"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"file"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Date"})]}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Transaction Id"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Initiated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Completed At"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap",children:"Actions"})]})}),!C&&((U=c==null?void 0:c.results)==null?void 0:U.length)!=0&&!S&&e.jsx(se,{data:(c==null?void 0:c.results)||[],openModal:x,isPending:S,type:p,status:a,start_number:h})]}),S?e.jsx(I,{}):(C||(c==null?void 0:c.results.length)===0)&&e.jsx(J,{})]}),e.jsxs(V.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:[e.jsx(X,{currentPage:d,handlePageChange:o,pageSize:n,handlePageSizeChange:t,totalCount:(c==null?void 0:c.pagination.total)||1}),e.jsx(Y,{isOpen:s.confirm||!1,onClose:()=>l({confirm:!1}),onConfirm:()=>x({isVerifyMpin:!0},r),disabled:v.isPending,title:"Transaction",description:"Are you sure you want to Change this Transaction ?"}),e.jsx(ae,{isOpen:s.isVerifyMpin||!1,closeModal:()=>l({isVerifyMpin:!1}),onVerify:()=>L(r),isNextTaskPending:v.isPending}),e.jsx(re,{transaction_id:r==null?void 0:r.transaction_id,isOpen:s.isUtr||!1,closeModal:()=>l({isUtr:!1})}),e.jsx(oe,{isOpen:s.isTaxDetails||!1,onClose:()=>l({isTaxDetails:!1}),type:r==null?void 0:r.type,transaction_id:r==null?void 0:r.transaction_id})]})]})};export{ue as default};
