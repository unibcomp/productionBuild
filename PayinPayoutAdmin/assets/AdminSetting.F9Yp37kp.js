import{u as D,k as F,a as T,e as k,l as I,r as p,K as P,V as A,j as e,z as E,n as M,m as R,M as $,P as B,L as H,O as q}from"./index._G24rw49.js";import{B as Y}from"./ActionButton.CUgbnb89.js";import{u as V}from"./useSetting.CFWOi0Zi.js";const G=i=>T.get("/reseller-list",{params:i}).then(d=>d.data),ee=({kycStatus:i="",searchQuery:d="",endDate:m="",startDate:l="",pageNumber:y=1,pageSize:n=10})=>{const j={...i&&{kycStatus:i},...d&&{searchQuery:d},...l&&{startDate:l},...m&&{endDate:m},...y&&{pageNumber:y},...n&&{pageSize:n}},{isLoading:_,isError:g,data:h,refetch:t}=D({queryKey:["all reseller",j],queryFn:()=>G(j),staleTime:3e3,refetchOnWindowFocus:!1});return console.log("reseller",h),{isLoading:_,isError:g,data:h,refetch:t}},z=i=>T.post("/register/",i).then(d=>d.data),W=({user_id:i,data:d})=>T.put(`/admin-setting/update/${i}`,d).then(m=>m.data),L=()=>{const i=F({mutationFn:z});return{createOrUpdate:F({mutationFn:W}),registerUserMutation:i}},ae=({isOpen:i,closeModal:d,refetch:m,isSeller:l})=>{const{user:y}=k(),{register:n,handleSubmit:j,reset:_,setValue:g,watch:h,formState:{errors:t}}=I({defaultValues:{fullName:"",email:"",mobile:"",password:"",otp:"",otpMode:"",reseller_name:"",reseller_url:""}}),x=h("otpMode"),[f,a]=p.useState(!1),[N,S]=p.useState(!1),{registerUserMutation:b}=L(),U=s=>{b.mutate(s)},u=h("reseller_name"),C=h("reseller_url"),r=()=>{const s=h("fullName").trim();if(!s){A.error("Full name is required before generating.");return}const o=`5${Math.floor(Math.random()*1e9).toString().padStart(9,"0")}`,c=s.toLowerCase().replace(/\s+/g,""),w=$(C),v=`${c}${Math.floor(1e3+Math.random()*9e3)}${w}`,O=Math.floor(1e5+Math.random()*9e5).toString();g("mobile",o),g("email",v),g("otp",O),S(!0)};return p.useEffect(()=>{u&&u&&P[u]&&g("reseller_url",P[u])},[u,g]),p.useEffect(()=>{var o;const s=(o=Object.entries(P).find(([,c])=>c===C))==null?void 0:o[0];C&&s&&g("reseller_name",s)},[C,g]),p.useEffect(()=>{var s,o,c,w;if(b.isSuccess)_(),m==null||m(),d(),A.success("Successfully Created"),S(!1);else if(b.isError){const v=b.error,O=((o=(s=v.response)==null?void 0:s.data)==null?void 0:o.message)||((w=(c=v.response)==null?void 0:c.data)==null?void 0:w.error)||"Something went wrong";A.error(O)}},[b.isSuccess,b.isError]),e.jsx(E,{appear:!0,show:i,as:p.Fragment,children:e.jsxs(M,{as:"div",className:"relative z-[1000]",onClose:d,children:[e.jsx(E.Child,{as:p.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(M.Panel,{className:"w-full max-w-3xl rounded bg-white p-6 shadow-xl transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(M.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Account"}),e.jsx(Y,{buttons:[{label:"Close",onClick:()=>d(),variant:"danger"}]})]}),e.jsxs("form",{onSubmit:j(U),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(y==null?void 0:y.role)==="SUPERADMIN"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsxs("select",{...n("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select reseller"}),Object.entries(P).map(([s])=>e.jsx("option",{value:s,children:s},s))]}),t.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsxs("select",{...n("reseller_url",{required:"Reseller URL is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select URL"}),Object.entries(P).map(([,s])=>e.jsx("option",{value:s,children:s},s))]}),t.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.reseller_url.message})]})]}),!l&&e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"OTP Mode"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{...n("otpMode",{required:"OTP Mode is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",children:[e.jsx("option",{value:"",children:"Select mode"}),e.jsx("option",{value:"STATIC",children:"STATIC"}),e.jsx("option",{value:"DYNAMIC",children:"DYNAMIC"})]}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),t.otpMode&&e.jsx("p",{className:"text-red-400 text-sm",children:t.otpMode.message})]}),(l||x)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",...n("fullName",{required:"Full Name is required"}),placeholder:"Enter full name",disabled:N,className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.fullName&&e.jsx("p",{className:"text-red-400 text-sm",children:t.fullName.message})]}),!l&&x==="STATIC"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col justify-end",children:N?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Your OTP"}),e.jsx("input",{type:"text",...n("otp",{required:"OTP is required"}),value:h("otp"),readOnly:x==="STATIC",disabled:x==="STATIC",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.otp&&e.jsx("p",{className:"text-red-400 text-sm",children:t.otp.message})]}):e.jsx(R.button,{type:"button",onClick:r,whileHover:{scale:1.03},whileTap:{scale:.97},className:"w-full py-2 px-4 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg",children:"Generate"})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",disabled:!l&&x!="DYNAMIC",...n("email",{required:"Email is required"}),placeholder:"Enter email",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.email&&e.jsx("p",{className:"text-red-400 text-sm",children:t.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Mobile"}),e.jsx("input",{type:"text",disabled:!l&&x!="DYNAMIC",maxLength:10,inputMode:"numeric",...n("mobile",{required:"Mobile number is required",pattern:{value:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),placeholder:"Enter mobile number",...n("mobile",{required:"Mobile is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),t.mobile&&e.jsx("p",{className:"text-red-400 text-sm",children:t.mobile.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:f?"text":"password",...n("password",{required:"Password is required"}),placeholder:"Create a password",className:"w-full py-3 px-4 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),e.jsx("span",{onClick:()=>a(!f),className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer",children:f?"visibility_off":"visibility"})]}),t.password&&e.jsx("p",{className:"text-red-400 text-sm",children:t.password.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{...n("role",{required:"Role is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",disabled:l,children:l?e.jsx("option",{value:"ADMIN",selected:!0,children:"Admin"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"API_USER",children:"API User"}),e.jsx("option",{value:"APP_USER",children:"App User"}),e.jsx("option",{value:"PAYOUT_APP_USER",children:"PAYOUT APP USER"}),e.jsx("option",{value:"PAYOUT_API_USER",children:"PAYOUT API USER"})]})}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),t.role&&e.jsx("p",{className:"text-red-400 text-sm",children:t.role.message})]})]})]}),e.jsx(R.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:b.isPending,className:"w-full py-3 bg-[#185e91] hover:bg-[#1b6ca8] text-white font-semibold rounded-lg",children:b.isPending?"Processing...":"Create Account"})]})]})})})]})})},K=(i,d,m,l)=>y=>{if(l){const n=Number(m[i]??0);return y>=n?!0:`${d} must be greater than or equal to ${n}`}return!0},J=[{value:"PHONEPAY",label:"PHONEPAY"},{value:"PAYU",label:"PAYU"},{value:"GATEPAY",label:"GATEPAY"}],se=({user_id:i,isOpen:d,closeModal:m,isUser:l,role:y,reseller_name:n,reseller_url:j})=>{const{data:_,isLoading:g,refetch:h}=V({user_id:i}),{createOrUpdate:t}=L(),{user:x}=k(),f=(x==null?void 0:x.Setting)||{},a=_||f,{register:N,handleSubmit:S,control:b,reset:U,formState:{errors:u}}=I({defaultValues:{reseller_name:(a==null?void 0:a.reseller_name)||n,reseller_url:(a==null?void 0:a.reseller_url)||j,paymentMode:(a==null?void 0:a.paymentMode)||"CASHFREE",payoutMode:(a==null?void 0:a.payoutMode)||"UPI",dispute_days:(a==null?void 0:a.dispute_days)||7,breach_penalty_perce:(a==null?void 0:a.breach_penalty_perce)||0,breach_penalty_refund:(a==null?void 0:a.breach_penalty_refund)||0,breach_penalty_payout:(a==null?void 0:a.breach_penalty_payout)||0,transaction_payment_fees:(a==null?void 0:a.transaction_payment_fees)||0,transaction_vendor_payout_fee:(a==null?void 0:a.transaction_vendor_payout_fee)||0,transaction_refund_fees:(a==null?void 0:a.transaction_refund_fees)||0,transaction_at_onetime:(a==null?void 0:a.transaction_at_onetime)||0,transaction_montly_fees:(a==null?void 0:a.transaction_montly_fees)||0,user_id:a==null?void 0:a.user_id,upi:(a==null?void 0:a.upi)||.35,wallet:(a==null?void 0:a.wallet)||3.1,netBanking:(a==null?void 0:a.netBanking)||3,visaCard:(a==null?void 0:a.visaCard)||3,amexCard:(a==null?void 0:a.amexCard)||0,dinerclubCard:(a==null?void 0:a.dinerclubCard)||4.1,emiCard:(a==null?void 0:a.emiCard)||3.3,masterCard:(a==null?void 0:a.masterCard)||3,debitCardUpto2000:(a==null?void 0:a.debitCardAbove2000)||1.45,debitCardAbove2000:(a==null?void 0:a.debitCardAbove2000)||1.95,status:(a==null?void 0:a.status)??!1,minPayOut:(a==null?void 0:a.minPayOut)||10,maxPayOut:(a==null?void 0:a.maxPayOut)||.3}});p.useEffect(()=>{_&&U({reseller_name:a.reseller_name||n,reseller_url:a.reseller_url||j,paymentMode:a.paymentMode||"CASHFREE",payoutMode:a.payoutMode||"UPI",dispute_days:a.dispute_days||7,breach_penalty_perce:a.breach_penalty_perce||0,breach_penalty_refund:a.breach_penalty_refund||0,breach_penalty_payout:a.breach_penalty_payout||0,transaction_payment_fees:a.transaction_payment_fees||0,transaction_vendor_payout_fee:a.transaction_vendor_payout_fee||0,transaction_refund_fees:a.transaction_refund_fees||0,transaction_at_onetime:a.transaction_at_onetime||0,transaction_montly_fees:a.transaction_montly_fees||0,user_id:a.user_id,upi:a.upi||.35,wallet:a.wallet||3.1,netBanking:a.netBanking||3,visaCard:a.visaCard||3,amexCard:a.amexCard||0,dinerclubCard:a.dinerclubCard||4.1,emiCard:a.emiCard||3.3,masterCard:a.masterCard||3,debitCardUpto2000:a.debitCardUpto2000||1.45,debitCardAbove2000:a.debitCardAbove2000||1.95,status:a.status??!1,minPayOut:a.minPayOut||10,maxPayOut:a.maxPayOut||.3})},[_,U,h,f]);const C=s=>{t.mutate({user_id:i,data:s})};p.useEffect(()=>{var s;if(t.isSuccess)A.success("Updated successfully"),m(),h();else if(t.isError){const c=(s=t.error.response)==null?void 0:s.data;A.error((c==null?void 0:c.error)||(c==null?void 0:c.message))}},[t.isError,t.isSuccess]);const r=(s,o,c,w="0.01")=>{var v;return e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:s}),e.jsx("input",{type:"number",step:w,placeholder:c,...N(o,{required:`${s} is required`,valueAsNumber:!0,validate:K(o,s,f,l)}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u[o]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:((v=u[o])==null?void 0:v.message)??""})]})};return e.jsx(E,{show:d,as:p.Fragment,children:e.jsxs(M,{as:"div",className:"relative z-50",onClose:m,children:[e.jsx(E.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 ",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(E.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-90",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-90",children:e.jsxs(M.Panel,{className:"custom-scroll h-[90vh] relative w-full max-w-5xl transform overflow-hidden rounded-lg bg-white p-0 text-left align-middle shadow-xl transition-all z-100",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white border-b px-4 py-3 flex items-center justify-between shadow-sm ",children:e.jsx(B,{title:`${l?"User":"Admin"} Setting`,searchComponent:e.jsx(Y,{buttons:[{label:"Close",onClick:()=>m(),variant:"danger"}]})})}),e.jsx("div",{className:"p-4",children:g?e.jsx(H,{}):l&&(x==null?void 0:x.role)==="ADMIN"&&f&&Object.keys(f).length<1?e.jsx("div",{children:"Failed To Load"}):e.jsxs("form",{onSubmit:S(C),className:"space-y-4",children:[!l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsx("input",{type:"text",disabled:!0,placeholder:"Enter reseller name",...N("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsx("input",{type:"url",disabled:!0,placeholder:"https://example.com",...N("reseller_url",{required:"Reseller URL is required",pattern:{value:/^(https?:\/\/)?([\w\-])+\.\w{2,}(\S*)?$/i,message:"Enter a valid URL"}}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.reseller_url.message})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Payment Mode"}),e.jsx(q,{name:"paymentMode",control:b,rules:{required:"Payment mode is required"},render:({field:s})=>e.jsxs("select",{...s,className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select payment mode"}),J.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]})}),u.paymentMode&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.paymentMode.message})]})}),r("Dispute Days","dispute_days","Enter dispute days","1"),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Breach Penalty %","breach_penalty_perce","Percentage"),r("Breach Penalty Refund","breach_penalty_refund","Refund amount"),r("Breach Penalty Payout","breach_penalty_payout","Payout amount")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Payment Fees","transaction_payment_fees","Payment fees"),r("Vendor Payout Fees","transaction_vendor_payout_fee","Vendor payout fees"),r("Refund Fees","transaction_refund_fees","Refund fees")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("One‑time Fees","transaction_at_onetime","One‑time fees"),r("Monthly Fees","transaction_montly_fees","Monthly fees")]}),!["PAYOUT_APP_USER"].includes(y??"")&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayIn Charge Configuration"}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("UPI  (%)","upi","Ex: 0.95"),r("Wallet  (%)","wallet","Ex: 1.2"),r("Net Banking  (%)","netBanking","Ex: 1.5")]}),e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Card Wise (%)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Visa Card","visaCard","Ex: 1.2"),r("MasterCard","masterCard","Ex: 1.25"),r("Amex Card","amexCard","Ex: 1.3"),r("Diner Club","dinerclubCard","Ex: 1.4"),r("EMI Card","emiCard","Ex: 2.0")]}),e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Debit Card Slabs (%)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r("Upto INR 2000","debitCardUpto2000","Ex: 1.45"),r("Above INR 2000","debitCardAbove2000","Ex: 1.95")]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayOut Charge  Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r("Min(Flat)","minPayOut","Ex: 0.95"),r("max(%) ","maxPayOut","Ex: 1.2")]})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Status"}),e.jsx(q,{name:"status",control:b,render:({field:s})=>e.jsx("button",{type:"button",role:"switch","aria-checked":s.value,onClick:()=>s.onChange(!s.value),className:`w-12 h-6 flex items-center rounded-full transition duration-300 focus:outline-none ${s.value?"bg-green-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${s.value?"translate-x-6":"translate-x-1"}`})})})]}),e.jsx(R.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:t.isPending,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-md transition",children:t.isPending?"Saving...":"Save"})]})})]})})})})]})})};export{se as A,ae as C,ee as u};
