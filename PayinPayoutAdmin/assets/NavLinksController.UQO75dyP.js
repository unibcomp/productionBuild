import{r as x,U as E,j as t,P as M}from"./index.B1_F_wbX.js";const y=()=>{const m=x.useMemo(()=>E,[]),h=[],f=p=>{console.log("Changes to apply:",p)};return t.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:[t.jsx("div",{className:"sticky top-0",children:t.jsx(M,{title:"Permissions Control",showBackButton:!1})}),t.jsx(S,{navLinks:m,userLinks:h,onSave:f})]})},S=({navLinks:m,userLinks:h,onSave:f})=>{const[p,u]=x.useState({}),[g,j]=x.useState({}),[N,v]=x.useState({});x.useEffect(()=>{const s={},e={},l={},r=(n,a)=>{const o=`${a||n.name}|${n.path}`,c=h.find(i=>i.path===n.path);s[o]=!!c,e[o]={read:(c==null?void 0:c.read)||!1,write:(c==null?void 0:c.write)||!1},l[o]=n.path};m.forEach(n=>{var a;r(n),(a=n.children)==null||a.forEach(o=>r(o,n.name))}),u(s),j(e),v(l)},[m,h]);const b=(s,e,l)=>{j(r=>({...r,[s]:{read:e,write:l}}))},C=(s,e,l=[])=>{u(r=>{const n={...r,[s]:e};return l.forEach(a=>{n[a]=e}),n}),b(s,e,e),l.forEach(r=>b(r,e,e))},$=(s,e)=>{u(l=>({...l,[s]:e})),b(s,e,e)},w=(s,e,l)=>{j(r=>({...r,[s]:{...r[s],[e]:l}}))},P=()=>{const s=[],e=[],l=[],r=new Map(h.map(n=>[n.path,n]));Object.entries(p).forEach(([n,a])=>{const o=N[n],[c]=n.split("|"),i=g[n],d=r.get(o);a?d?(i.read!==d.read||i.write!==d.write)&&e.push({id:d.id,name:c,path:o,read:i.read,write:i.write}):s.push({name:c,path:o,read:i.read,write:i.write}):d&&l.push({id:d.id})}),f({create:s,update:e,delete:l})};return t.jsxs("div",{className:"p-4 max-w-5xl mx-auto text-sm",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Permissions Management"}),t.jsx("div",{className:"space-y-3",children:m.map(s=>{var r,n;const e=`${s.name}|${s.path}`,l=((r=s.children)==null?void 0:r.map(a=>`${s.name}-${a.name}|${a.path}`))||[];return t.jsxs("div",{className:"border rounded p-3 bg-white shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("label",{className:"flex items-center gap-2 font-medium",children:[t.jsx("input",{type:"checkbox",checked:p[e]||!1,onChange:a=>C(e,a.target.checked,l)}),s.name]}),t.jsx("div",{className:"flex gap-4",children:["read","write"].map(a=>{var o;return t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:((o=g[e])==null?void 0:o[a])||!1,onChange:c=>w(e,a,c.target.checked)}),a.charAt(0).toUpperCase()+a.slice(1)]},a)})})]}),((n=s.children)==null?void 0:n.length)&&t.jsx("div",{className:"ml-6 mt-3 space-y-2",children:s.children.map(a=>{const o=`${s.name}-${a.name}|${a.path}`;return t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:p[o]||!1,onChange:c=>$(o,c.target.checked)}),a.name]}),t.jsx("div",{className:"flex gap-4",children:["read","write"].map(c=>{var i;return t.jsxs("label",{className:"flex items-center gap-1",children:[t.jsx("input",{type:"checkbox",checked:((i=g[o])==null?void 0:i[c])||!1,onChange:d=>w(o,c,d.target.checked)}),c.charAt(0).toUpperCase()+c.slice(1)]},c)})})]},o)})})]},e)})}),t.jsx("button",{onClick:P,className:"mt-6 px-5 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Changes"})]})};export{y as default};
