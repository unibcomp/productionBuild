import{k as v,o as N,r as p,j as t,z as j,q as w,V as b}from"./index.D2TMnlCu.js";import{u as F}from"./useMpin.GRi93l2L.js";const M=async a=>(await N.get("/withdraw-count",{params:a})).data,P=(a={},n=!0)=>{const{isLoading:o,isError:c,data:l,refetch:i}=v({queryKey:["withdraw-count",a],queryFn:()=>M(a),staleTime:3e3,refetchOnWindowFocus:!1,enabled:!!n});return{isLoading:o,isError:c,data:l,refetch:i}},k=a=>N.get("/withdraw-list/",{params:a}).then(n=>n.data),W=({status:a="",searchQuery:n="",endDate:o="",startDate:c="",date:l="",pageNumber:i=1,pageSize:u=10},d=!0)=>{const h={...a&&{status:a},...n&&{searchQuery:n},...c&&{startDate:c},...l&&{date:l},...o&&{endDate:o},...i&&{pageNumber:i},...u&&{pageSize:u}},{isLoading:m,isError:y,data:x,refetch:g}=v({queryKey:["AllWithdraws",h],queryFn:()=>k(h),staleTime:3e3,refetchOnWindowFocus:!1,enabled:!!d});return{isLoading:m,isError:y,data:x,refetch:g}};function q({isOpen:a,closeModal:n,onVerify:o,nextModalOpen:c,isNextTaskPending:l}){const[i,u]=p.useState(Array(6).fill("")),d=p.useRef([]),{mutate:h,isPending:m}=F(),y=(s,e)=>{var f;if(!/^\d?$/.test(s))return;const r=[...i];r[e]=s,u(r),s&&e<5&&((f=d.current[e+1])==null||f.focus())},x=(s,e)=>{var r;s.key==="Backspace"&&!i[e]&&e>0&&((r=d.current[e-1])==null||r.focus())},g=()=>{var s;u(Array(6).fill("")),(s=d.current[0])==null||s.focus()},C=()=>{const s=i.join("");if(s.length!==6){b.error("MPIN must be exactly 6 digits");return}h({mpin:s},{onSuccess:e=>{e.success===!0?(g(),c&&n(),o==null||o(!0),c&&setTimeout(()=>c(),200)):b.error(e.error||"MPIN verification failed")},onError:e=>{var r,f;b.error(((f=(r=e==null?void 0:e.response)==null?void 0:r.data)==null?void 0:f.error)||"Something went wrong")}})};return t.jsx(j,{appear:!0,show:a,as:p.Fragment,children:t.jsxs(w,{as:"div",className:"relative z-50",onClose:n,children:[t.jsx(j.Child,{as:p.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:t.jsxs(w.Panel,{className:"w-full max-w-md transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[t.jsx(w.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Please Enter 6 Digit MPIN"}),t.jsxs("form",{onSubmit:s=>{s.preventDefault(),C()},className:"grid gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"MPIN"}),t.jsx("div",{className:"flex justify-between gap-2",children:i.map((s,e)=>t.jsx("input",{type:"password",maxLength:1,value:s,ref:r=>{d.current[e]=r},onChange:r=>y(r.target.value,e),onKeyDown:r=>x(r,e),className:"w-12 h-12 text-center border border-gray-300 rounded text-lg font-semibold focus:outline-indigo-500",inputMode:"numeric"},e))})]}),t.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>{g(),n()},className:"rounded border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:m||l,className:`rounded px-4 py-2 text-sm text-white ${m?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"} transition`,children:m||l?"Verifying...":"Verify"})]})]})]})})})]})})}export{q as M,W as a,P as u};
