import{u as w,a as b,b as S,j as e,m as j,c as A,P as C,S as _,B as v,L as D,N as P,C as E,V as x,d as z,r as U,e as F,f as R}from"./index.DG_WvTOT.js";import{u as H,C as V,A as W}from"./AdminSetting.CDCpsfZu.js";import{D as k}from"./DepWithModal.DnqYaRox.js";import{u as N}from"./useDeleteAndSuspendUser.DlzyFGOz.js";import"./useSetting.BK2xFIAa.js";import"./useManualPayin.-AMfWXRS.js";import"./useTransaction.BoRUOUqX.js";const q=()=>{var y;const{handlePageChange:p,handlePageSizeChange:i,pageNumber:u,pageSizeValue:o}=w(),{isModalOpen:t,openModal:c,closeModal:r,data:s}=b(),{setSearchQuery:l,searchQuery:h}=S(),{mutate:n}=N(),{data:a,isError:d,isLoading:f,refetch:m}=H({pageNumber:u,pageSize:o,searchQuery:h,role:"OPERATIONAL"});return e.jsxs(j.div,{className:"bg-white shadow-lg rounded-2xl",variants:A,initial:"hidden",animate:"visible",children:[e.jsx(C,{title:"All Operational Users",searchComponent:e.jsxs(e.Fragment,{children:[e.jsx(_,{handlePageSizeChange:i,pageSizeOptions:[10,20,30],pageSize:o,setSearchQuery:l}),e.jsx(v,{buttons:[{label:"Create",onClick:()=>c({isRegister:!0},{isRegister:!0}),variant:"primary"}]})]})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Full Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Account status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Hold"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"UnSettled"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Wallet Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Created At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Updated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Actions"})]})}),!d&&(a==null?void 0:a.data.length)!=0&&!f&&e.jsx($,{data:(a==null?void 0:a.data)||[],openModal:c,refetch:m})]}),f?e.jsx(D,{}):(d||((y=a==null?void 0:a.data)==null?void 0:y.length)===0)&&e.jsx(P,{})]}),e.jsx(V,{isOpen:t.isRegister||!1,isOperational:!0,closeModal:()=>r({isRegister:!1}),refetch:m}),e.jsx(W,{isOpen:(t==null?void 0:t.isAdminSetting)||!1,user_id:(s==null?void 0:s.user_id)||null,reseller_name:(s==null?void 0:s.reseller_name)||null,reseller_url:(s==null?void 0:s.reseller_url)||null,closeModal:()=>r({isAdminSetting:!1})}),e.jsx(k,{isOpen:t.isWithdraw||t.isDeposit||t.isHold||!1,onClose:()=>r({...t!=null&&t.isWithdraw?{isWithdraw:!1}:{},...t!=null&&t.isDeposit?{isDeposit:!1}:{},...t!=null&&t.isHold?{isHold:!1}:{}}),isHold:t.isHold||!1,refetch:m,user_id:s==null?void 0:s.user_id,isWithdraw:t.isWithdraw||!1,isRealesed:t.isRealesed||!1}),e.jsx(E,{isOpen:t.confirm||!1,onClose:()=>r({confirm:!1}),onConfirm:()=>{s!=null&&s.user_id&&n({user_id:s.user_id,isDeleted:!0},{onSuccess:g=>{r({confirm:!1}),x.success(g.message||"deleted successfully")},onError:g=>{x.error(g.message)}})},title:"Delete User",description:"Are you sure you want to delete this item ?"}),e.jsx(j.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:e.jsx(z,{currentPage:u,handlePageChange:p,pageSize:o,handlePageSizeChange:i,totalCount:(a==null?void 0:a.pagination.total)||1})})]})},$=({data:p,openModal:i,refetch:u})=>{const{mutate:o}=N(),[t,c]=U.useState(null),r=({item:s,account_status:l,isFrozen:h})=>{c(s.user_id),console.log(l),o({user_id:s.user_id,...l&&{accountStatus:s.accountStatus==="SUSPENDED"?"ACTIVE":"SUSPENDED"},...h&&{isFrozen:!s.isFrozen}},{onSuccess:n=>{u(),x.success(n.message||"Account status updated successfully")},onError:n=>{var a,d;x.error(((d=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:d.message)||"Something went wrong while updating status")},onSettled:()=>{c(null)}})};return e.jsx("tbody",{className:"custom-scroll",children:p.map((s,l)=>e.jsxs(j.tr,{className:"hover:bg-gray-50 transition-all duration-150",variants:F,initial:"hidden",animate:"visible",custom:l,children:[e.jsx("td",{className:"px-4 py-3 font-bold",children:l+1}),e.jsx("td",{className:"px-4 py-3 font-bold",children:s.full_name}),e.jsx("td",{className:"px-4 py-3",children:s.mobile}),e.jsx("td",{className:"px-4 py-3",children:s.email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>r({item:s,account_status:!0}),disabled:t===s.user_id,className:`w-10 h-5 cursor-pointer flex items-center rounded-full p-1 transition-colors duration-300
        ${s.accountStatus==="ACTIVE"?"bg-blue-600":"bg-gray-300"}
        ${t===s.user_id?"opacity-50 cursor-not-allowed":""}
    `,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition-transform ${s.accountStatus==="ACTIVE"?"translate-x-5":"translate-x-0"}`})})}),e.jsx("td",{className:"px-4 py-3",children:s.holdAmount}),e.jsx("td",{className:"px-4 py-3",children:s.settled_amount.toFixed(2)}),e.jsx("td",{className:"px-4 py-3",children:s.un_settled_amount.toFixed(2)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>r({item:s,isFrozen:!0}),disabled:t===s.user_id,className:`w-10 h-5 cursor-pointer flex items-center rounded-full p-1 transition-colors duration-300
        ${s.isFrozen?"bg-gray-300":"bg-blue-600"}
        ${t===s.user_id?"opacity-50 cursor-not-allowed":""}
    `,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition-transform ${s.isFrozen?"translate-x-0":"translate-x-5"}`})})}),e.jsx("td",{className:"px-4 py-3",children:s.createdAt}),e.jsx("td",{className:"px-4 py-3",children:s.updatedAt}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-3 flex-wrap w-[300px]",children:[e.jsxs(R,{to:`/permission/${s==null?void 0:s.user_id}`,className:"cursor-pointer flex items-center gap-1 text-green-600 hover:text-green-700 transition-colors font-medium","aria-label":"Grant Permission",children:[e.jsx("span",{className:"material-symbols-outlined text-base",children:"check_circle"}),e.jsx("span",{className:"text-sm",children:"Permission"})]}),e.jsxs("button",{onClick:()=>i==null?void 0:i({confirm:!0},{user_id:s.user_id}),className:"flex items-center gap-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition whitespace-nowrap cursor-pointer",children:[e.jsx("span",{className:"material-symbols-outlined text-[12px] leading-none",children:"delete"}),"Delete"]})]})})]},l))})};export{q as default};
