import{f as I,p as C,g as A,l as Y,q as $,r as m,Z as f,V as S,j as e,z as R,s as T,B as G,m as F,_ as V}from"./index.DsbNlJU-.js";const B=a=>A.get("/reseller-list",{params:a}).then(l=>l.data),Q=({kycStatus:a="",searchQuery:l="",endDate:o="",startDate:n="",role:p,pageNumber:g=1,pageSize:t=10,reseller_name:j=""})=>{const y={...j&&{reseller_name:j},...a&&{kycStatus:a},...p&&{role:p},...l&&{searchQuery:l},...n&&{startDate:n},...o&&{endDate:o},...g&&{pageNumber:g},...t&&{pageSize:t}},{isLoading:i,isError:u,data:r,refetch:d}=I({queryKey:["all reseller",y],queryFn:()=>B(y),staleTime:3e3,refetchOnWindowFocus:!1});return console.log("reseller",r),{isLoading:i,isError:u,data:r,refetch:d}},H=a=>A.post("/register/",a).then(l=>l.data),z=({user_id:a,data:l})=>A.put(`/admin-setting/update/${a}`,l).then(o=>o.data),K=()=>{const a=C({mutationFn:H});return{createOrUpdate:C({mutationFn:z}),registerUserMutation:a}},W=async()=>(await A.get("/departments")).data.data,Z=()=>I({queryKey:["departments"],queryFn:W,retry:1}),X=({isOpen:a,closeModal:l,refetch:o,isSeller:n,isOperational:p})=>{const{user:g}=Y(),{register:t,handleSubmit:j,reset:y,setValue:i,watch:u,formState:{errors:r}}=$({defaultValues:{fullName:"",email:"",mobile:"",password:"",otp:"",otpMode:"",reseller_name:"",reseller_url:"",department:""}}),d=u("otpMode"),[q,k]=m.useState(!1),[_,U]=m.useState(!1),[P,O]=m.useState(!1),{registerUserMutation:c}=K(),{data:M}=Z(),D=s=>{p||delete s.department,c.mutate(s)},b=u("reseller_name"),N=u("reseller_url"),L=()=>{const s=u("fullName").trim();if(!s){S.error("Full name is required before generating.");return}const x=`5${Math.floor(Math.random()*1e9).toString().padStart(9,"0")}`,h=s.toLowerCase().replace(/\s+/g,""),v=V(N),w=`${h}${Math.floor(1e3+Math.random()*9e3)}${v}`,E=Math.floor(1e5+Math.random()*9e5).toString();i("mobile",x),i("email",w),i("otp",E),U(!0)};return m.useEffect(()=>{b&&b&&f[b]&&i("reseller_url",f[b])},[b,i]),m.useEffect(()=>{var x;const s=(x=Object.entries(f).find(([,h])=>h===N))==null?void 0:x[0];N&&s&&i("reseller_name",s)},[N,i]),m.useEffect(()=>{var s,x,h,v;if(c.isSuccess)y(),o==null||o(),l(),S.success("Successfully Created"),U(!1);else if(c.isError){const w=c.error,E=((x=(s=w.response)==null?void 0:s.data)==null?void 0:x.message)||((v=(h=w.response)==null?void 0:h.data)==null?void 0:v.error)||"Something went wrong";S.error(E)}},[c.isSuccess,c.isError]),e.jsx(R,{appear:!0,show:a,as:m.Fragment,children:e.jsxs(T,{as:"div",className:"relative z-[1000]",onClose:l,children:[e.jsx(R.Child,{as:m.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(T.Panel,{className:"w-full max-w-3xl rounded bg-white p-6 shadow-xl transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(T.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Account"}),e.jsx(G,{buttons:[{label:"Close",onClick:()=>l(),variant:"danger"}]})]}),e.jsxs("form",{onSubmit:j(D),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(g==null?void 0:g.role)==="SUPERADMIN"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsxs("select",{...t("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select reseller"}),Object.entries(f).map(([s])=>e.jsx("option",{value:s,children:s},s))]}),r.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsxs("select",{...t("reseller_url",{required:"Reseller URL is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select URL"}),Object.entries(f).map(([,s])=>e.jsx("option",{value:s,children:s},s))]}),r.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.reseller_url.message})]})]}),!n&&e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"OTP Mode"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{...t("otpMode",{required:"OTP Mode is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",children:[e.jsx("option",{value:"",children:"Select mode"}),e.jsx("option",{value:"STATIC",children:"STATIC"}),e.jsx("option",{value:"DYNAMIC",children:"DYNAMIC"})]}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),r.otpMode&&e.jsx("p",{className:"text-red-400 text-sm",children:r.otpMode.message})]}),(n||d)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",...t("fullName",{required:"Full Name is required"}),placeholder:"Enter full name",disabled:_,className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.fullName&&e.jsx("p",{className:"text-red-400 text-sm",children:r.fullName.message})]}),!n&&d==="STATIC"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col justify-end",children:_?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Your OTP"}),e.jsx("input",{type:"text",...t("otp",{required:"OTP is required"}),value:u("otp"),readOnly:d==="STATIC",disabled:d==="STATIC",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.otp&&e.jsx("p",{className:"text-red-400 text-sm",children:r.otp.message})]}):e.jsx(F.button,{type:"button",onClick:L,whileHover:{scale:1.03},whileTap:{scale:.97},className:"w-full py-2 px-4 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg",children:"Generate"})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",disabled:!n&&d!="DYNAMIC",...t("email",{required:"Email is required"}),placeholder:"Enter email",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.email&&e.jsx("p",{className:"text-red-400 text-sm",children:r.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Mobile"}),e.jsx("input",{type:"text",disabled:!n&&d!="DYNAMIC",maxLength:10,inputMode:"numeric",...t("mobile",{required:"Mobile number is required",pattern:{value:/^[5-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),placeholder:"Enter mobile number",...t("mobile",{required:"Mobile is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.mobile&&e.jsx("p",{className:"text-red-400 text-sm",children:r.mobile.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:q?"text":"password",...t("password",{required:"Password is required"}),placeholder:"Create a password",className:"w-full py-3 px-4 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),e.jsx("span",{onClick:()=>k(!q),className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer",children:q?"visibility_off":"visibility"})]}),r.password&&e.jsx("p",{className:"text-red-400 text-sm",children:r.password.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{...t("role",{required:"Role is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",disabled:n,children:n?e.jsx("option",{value:"ADMIN",selected:!0,children:"Admin"}):p?e.jsx("option",{value:"OPERATIONAL",selected:!0,children:"OPERATIONAL"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"API_USER",children:"API User"}),e.jsx("option",{value:"APP_USER",children:"App User"}),e.jsx("option",{value:"PAYOUT_APP_USER",children:"PAYOUT APP USER"}),e.jsx("option",{value:"PAYOUT_API_USER",children:"PAYOUT API USER"})]})}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),r.role&&e.jsx("p",{className:"text-red-400 text-sm",children:r.role.message})]}),p&&e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Department"}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-sm mr-2",children:"Select Department"}),e.jsx("button",{type:"button",onClick:()=>O(s=>!s),className:`relative inline-flex h-6 w-11 items-center rounded-full transition ${P?"bg-cyan-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${P?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"text-sm ml-2",children:"Input Department"})]}),e.jsx("div",{className:"relative",children:P?e.jsx("input",{...t("department",{required:"Department is required"}),placeholder:"Enter department",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{...t("department",{required:"Department is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",children:[e.jsx("option",{value:"",children:"Select Department"}),M==null?void 0:M.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]})}),r.department&&e.jsx("p",{className:"text-red-400 text-sm",children:r.department.message})]})]})]}),e.jsx(F.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:c.isPending,className:"w-full py-3 bg-[#185e91] hover:bg-[#1b6ca8] text-white font-semibold rounded-lg",children:c.isPending?"Processing...":"Create Account"})]})]})})})]})})};export{X as C,K as a,Q as u};
