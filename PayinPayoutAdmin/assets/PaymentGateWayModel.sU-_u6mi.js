import{k as x,u as G,a as l,r as y,j as t,z as h,l as w,V as f}from"./index.BWf0QJJx.js";import{u as I,C as M}from"./index.esm.D2YuALNd.js";import{B as R}from"./ActionButton.7lH3Pgvl.js";const S=s=>l.get("/gateways",{params:s}).then(a=>a.data),K=({pageNumber:s=1,pageSize:a=10,searchQuery:e="",gateway:i=""})=>{const n={...i&&{gateway:i},...e&&{searchQuery:e},...s&&{pageNumber:s},...a&&{pageSize:a}};return G({queryKey:["payment-gateways",s,a,e],queryFn:()=>S(n),staleTime:1e3*60*2})},C=s=>l.post("/gateway",s).then(a=>a.data),q=({id:s,data:a})=>l.put(`/gateway/${s}`,a).then(e=>e.data),B=()=>{const s=x({mutationFn:C}),a=x({mutationFn:q});return{createGateway:s,updateGateway:a}},D=({gatewayId:s,...a})=>l.get(`/gateway/${s}/methods`,{params:a}).then(e=>e.data),H=({pageNumber:s=1,pageSize:a=10,searchQuery:e="",gateway:i="",gatewayId:n=""})=>{const m={...i&&{gateway:i},...e&&{searchQuery:e},...s&&{pageNumber:s},...a&&{pageSize:a},...n&&{gatewayId:n}};return G({queryKey:["payment-gateways-method",s,a,e],queryFn:()=>D(m),staleTime:1e3*60*2})},U={UPI:"UPI",BANKTRANSFER:"BANKTRANSFER",IMPS:"IMPS",NEFT:"NEFT",RTGS:"RTGS",PAYTM:"PAYTM",AMAZONPAY:"AMAZONPAY",CARD:"CARD",MANUAL:"MANUAL",VISA:"visa",AMEX:"amex",DINERCLUB:"dinerclub",EMI:"emi",MASTER:"master",DEBITCARD:"debitCard",WALLET:"wallet",NETBANKING:"netBanking",UPI_LOWER:"upi"},Y=({gatewayId:s,...a})=>l.post(`/gateway/${s}/method`,a).then(e=>e.data),k=({id:s,data:a})=>l.put(`/gateway/${s}/update`,a).then(e=>e.data),L=()=>{const s=x({mutationFn:Y}),a=x({mutationFn:k});return{createGatewayMethod:s,updateGatewayMethod:a}},O=["CASHFREE","PHONEPAY","PAYU","UNIVERSALPAY","RAZORPAY","STRIPE"],W=({isOpen:s,onClose:a,data:e,refetch:i,isMethod:n})=>{var A,b;const{register:m,handleSubmit:P,reset:g,control:T,formState:{errors:u}}=I({defaultValues:n?{displayName:void 0,gatewayId:(e==null?void 0:e.gatewayId)||"",isActive:!0,min:0,max:0}:{user_id:e==null?void 0:e.user_id,name:void 0,isActive:!0}}),{createGateway:p}=B(),{createGatewayMethod:E}=L();y.useEffect(()=>{g(n?{displayName:void 0,gatewayId:(e==null?void 0:e.gatewayId)||"",isActive:!0,min:0,max:0}:{user_id:e==null?void 0:e.user_id,name:void 0,isActive:!0})},[e,g,n]);const F=r=>{const d={onSuccess:c=>{i(),a(),f.success(c.message||"Gateway created successfully")},onError:c=>{var j,N;f.error(((N=(j=c==null?void 0:c.response)==null?void 0:j.data)==null?void 0:N.message)||"Something went wrong while creating gateway")}},v={...r,...e};n?E.mutate(v,d):p.mutate(v,d)},o=u;return t.jsx(h,{appear:!0,show:s,as:y.Fragment,children:t.jsxs(w,{as:"div",className:"relative z-50",onClose:a,children:[t.jsx(h.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm"})}),t.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:t.jsx("div",{className:"flex min-h-full items-center justify-center px-4 py-6 text-center",children:t.jsx(h.Child,{as:y.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t.jsxs(w.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-xl bg-[#1a2c33] border border-[#2a3e4c] p-6 text-white align-middle shadow-xl transition-all",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(w.Title,{as:"h3",className:"text-lg font-semibold",children:n?"Add Gateway Method":"Create Payment Gateway"}),t.jsx(R,{buttons:[{label:"Close",onClick:a,variant:"danger"}]})]}),t.jsxs("form",{onSubmit:P(F),className:"mt-4 space-y-4",children:[t.jsx("div",{children:t.jsx("input",{type:"text",placeholder:n?"Gateway ID":"User ID",disabled:!0,value:n?e==null?void 0:e.gatewayId:e==null?void 0:e.user_id,className:"w-full py-2 px-3 rounded-md bg-gray-100 text-gray-700 border border-gray-300"})}),t.jsxs("div",{children:[t.jsxs("select",{...m(n?"displayName":"name",{required:"Gateway name is required"}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300",children:[t.jsx("option",{value:"",children:"Select Gateway"}),n?Object.entries(U).map(([r,d])=>t.jsx("option",{value:d,children:r},r)):O.map(r=>t.jsx("option",{value:r,children:r},r))]}),t.jsx("p",{className:"text-red-400 text-sm mt-1",children:(n?(A=o==null?void 0:o.displayName)==null?void 0:A.message:(b=u==null?void 0:u.name)==null?void 0:b.message)??""})]}),n&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{children:[t.jsx("input",{type:"number",step:"0.01",placeholder:"Minimum Amount",...m("min",{required:"Minimum amount is required",min:{value:0,message:"Min must be >= 0"}}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300"}),o.min&&t.jsx("p",{className:"text-red-400 text-sm mt-1",children:o.min.message})]}),t.jsxs("div",{children:[t.jsx("input",{type:"number",step:"0.01",placeholder:"Maximum Amount",...m("max",{required:"Maximum amount is required",min:{value:0,message:"Max must be >= 0"}}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300"}),o.max&&t.jsx("p",{className:"text-red-400 text-sm mt-1",children:o.max.message})]})]}),t.jsx("div",{children:t.jsx(M,{name:"isActive",control:T,defaultValue:!0,render:({field:r})=>t.jsx("button",{type:"button",role:"switch","aria-checked":r.value,onClick:()=>r.onChange(!r.value),className:`w-12 h-6 flex items-center rounded-full transition duration-300 focus:outline-none ${r.value?"bg-green-500":"bg-gray-300"}`,children:t.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${r.value?"translate-x-6":"translate-x-1"}`})})})}),t.jsx("div",{className:"mt-6",children:t.jsx("button",{type:"submit",disabled:p.isPending,className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition cursor-pointer",children:p.isPending?"Creating...":"Submit"})})]})]})})})})]})})};export{W as P,K as a,L as b,H as c,B as u};
