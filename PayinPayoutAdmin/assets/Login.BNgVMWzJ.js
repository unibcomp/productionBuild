import{k as N,D as v,G as L,d as P,r as d,l as k,e as S,H as E,j as e,m,P as F,V as u,I as C}from"./index.CMxc4iXF.js";import{F as A}from"./Footer.DDeM8iYa.js";const I=t=>v.post("/login",t).then(s=>s.data),H=()=>N({mutationFn:I,mutationKey:["login"]}),q=()=>{let t=localStorage.getItem("device_id");return t||(t=crypto.randomUUID(),localStorage.setItem("device_id",t)),t},_=()=>new Promise(t=>{if(!navigator.geolocation)return t(null);navigator.geolocation.getCurrentPosition(s=>t(s.coords.latitude),s=>{console.warn("Failed to get latitude:",s.message),t(null)},{enableHighAccuracy:!0,timeout:1e4})}),T=()=>new Promise(t=>{if(!navigator.geolocation)return t(null);navigator.geolocation.getCurrentPosition(s=>t(s.coords.longitude),s=>{console.warn("Failed to get longitude:",s.message),t(null)},{enableHighAccuracy:!0,timeout:1e4})}),D=()=>{const t=L(),s=P(),[c,y]=d.useState(!1),[g,r]=d.useState(!1),{register:p,handleSubmit:b,formState:{errors:n}}=k(),{login:f}=S(),{mutateAsync:w,isPending:x}=H(),j=async a=>{var h;try{r(!0);const[l,i]=await Promise.all([_(),T()]);if(!l||!i)return r(!1),u.error("Failed to get location.");r(!1);const o=await w({...a,device_id:q(),latitude:l,longitude:i});return f(o),C(o.token),u.success(o.message),s("/")}catch(l){r(!1);const i=l,o=(h=i.response)==null?void 0:h.data;u.error((o==null?void 0:o.message)||i.message||"Login failed.")}};return d.useEffect(()=>{const a=E();s(a?"/":"/login")},[t.pathname]),e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 to-white px-4",children:e.jsxs(m.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:"w-full max-w-md bg-white/90 backdrop-blur-sm border border-gray-200 shadow-xl rounded-2xl p-8",children:[e.jsx(F,{title:"Login to Your Account",searchComponent:e.jsx(e.Fragment,{})}),e.jsx("div",{className:"p-8 space-y-5",children:e.jsxs("form",{onSubmit:b(j),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-3 text-gray-500 text-lg",children:"mail"}),e.jsx("input",{type:"email",placeholder:"Enter your Email",...p("email",{required:"Email is required",setValueAs:a=>a==null?void 0:a.toLowerCase()}),className:"pl-10 pr-4 py-3 w-full rounded-md bg-white text-gray-900 placeholder-gray-400 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none transition"})]}),n.email&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:n.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-3 text-gray-500 text-lg",children:"lock"}),e.jsx("input",{type:c?"text":"password",placeholder:"Enter your password",...p("password",{required:"Password is required"}),className:"pl-10 pr-12 py-3 w-full rounded-md bg-white text-gray-900 placeholder-gray-400 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none transition"}),e.jsx("span",{onClick:()=>y(!c),className:"material-symbols-outlined absolute right-3 top-3 text-gray-500 text-lg cursor-pointer",children:c?"visibility_off":"visibility"})]}),n.password&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:n.password.message})]}),e.jsx("div",{className:"text-left text-sm",children:e.jsx("button",{onClick:()=>s("/forgot-password"),type:"button",className:"text-cyan-400 hover:underline transition",children:"Forgot Password?"})}),e.jsx(m.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:g||x,className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition",children:g?"Getting Your Location":x?"Logging in...":"Login"})]})}),e.jsx(A,{})]})})};export{D as default};
