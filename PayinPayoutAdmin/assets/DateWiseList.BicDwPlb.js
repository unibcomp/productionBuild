import{l as G,j as e,z as g,r as j,n as y,v as C,u as R,a as O,P as U,L as F,b as q,h as B,o as Q,e as D,c as W,m as A,f as $,S as H,N as K,g as J,C as X,V as M}from"./index.D-LTTqEi.js";import{a as Y,u as Z}from"./useDeposit.BFtJjWGo.js";import{D as _}from"./DateWiseTableBody.Dh3Ssnh6.js";import{a as ee,M as se}from"./MpinVerifyModal.Cb-Napld.js";import{u as ae}from"./useManualPayin.C8m8FaMs.js";import"./useMpin.CDjWOCQq.js";const te=({transaction_id:i,closeModal:a,isOpen:l})=>{const{register:r,handleSubmit:u,formState:{errors:p}}=G(),{createUpdateUtrMutation:s}=ae(),c=n=>{s.mutate({transaction_id:i,data:n},{onError:m=>{var d;const t=(d=m.response)==null?void 0:d.data;C.error((t==null?void 0:t.message)||(t==null?void 0:t.error)),a()},onSuccess:m=>{C.success(m.message||"SuccesFully Updated")}})};return e.jsx(g,{appear:!0,show:l,as:j.Fragment,children:e.jsxs(y,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(g.Child,{as:j.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(y.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsx(y.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Update Utr"}),e.jsxs("form",{onSubmit:u(c),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",...r("utr",{required:"Utr is required"}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none",placeholder:"Enter Utr Number"}),p.utr&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:p.utr.message})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition cursor-pointer",children:s.isPending?"Processing...":"Submit"})]})]})})})]})})},re=(i,a,l=!0)=>R({queryKey:["taxReportByTransaction",i,a],enabled:l&&!!i&&!!a,queryFn:async()=>{const r=await O.get("/tax-report-specific-transaction",{params:{transaction_id:i,type:a}});if(!r.data.success||!r.data.data)throw new Error("No tax data found");return r.data.data}});function ne({isOpen:i,onClose:a,type:l,transaction_id:r}){const{data:u,isLoading:p}=re(r,l,i),s=u,c=((s==null?void 0:s.companyTaxAmount)??0)+((s==null?void 0:s.gstApplyAmount)??0)+((s==null?void 0:s.resellerTaxAmount)??0)+((s==null?void 0:s.resellerGstAmount)??0);return e.jsx(g,{appear:!0,show:i,as:j.Fragment,children:e.jsxs(y,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(g.Child,{as:j.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-6",children:e.jsx(y.Panel,{className:"w-full max-w-xl transform overflow-hidden rounded-2xl bg-white shadow-2xl transition-all border border-blue-100",children:e.jsxs("div",{className:"p-6 sm:p-8",children:[e.jsx(U,{title:"ðŸ§¾ Tax Transaction Details"}),e.jsxs("div",{className:"my-6 text-center",children:[e.jsxs("div",{className:"text-sm text-gray-600 font-semibold mb-1",children:["Type: ",e.jsx("span",{className:"text-gray-800",children:l})]}),e.jsxs("div",{className:"text-sm text-gray-600 font-semibold",children:["Transaction ID:"," ",e.jsx("span",{className:"text-gray-800",children:r})]})]}),p?e.jsx(F,{}):e.jsxs("div",{className:"grid grid-cols-1 gap-2 max-h-[58vh] overflow-y-auto",children:[e.jsx(h,{label:"Total Amount",value:c||0}),e.jsx(h,{label:"Gateway Charges",value:(s==null?void 0:s.companyTaxAmount)||0}),e.jsx(h,{label:"Gateway GST",value:(s==null?void 0:s.gstApplyAmount)||0}),e.jsx(h,{label:"Company Charges",value:(s==null?void 0:s.resellerTaxAmount)||0}),e.jsx(h,{label:"Company GST",value:(s==null?void 0:s.resellerGstAmount)||0})]}),e.jsx("div",{className:"flex justify-end pt-10",children:e.jsx("button",{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-md shadow-sm text-sm font-medium transition",children:"Close"})})]})})})})]})})}function h({label:i,value:a}){return e.jsxs("div",{className:"bg-white border border-gray-200 p-3 rounded-xl shadow-sm",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1",children:i}),e.jsxs("p",{className:"text-base text-gray-800 font-medium",children:["â‚¹ ",(a==null?void 0:a.toFixed(2))??"â€”"]})]})}const me=()=>{var S,T;const{handlePageChange:i,handlePageSizeChange:a,pageNumber:l,pageSizeValue:r,startItem:u}=q(),{openModal:p,isModalOpen:s,closeModal:c,data:n}=B(),{date:m,status:t,type:d}=Q(),{user:f}=D(),V=d==="Pay-In",{setSearchQuery:z,searchQuery:w}=W(),{updateDepositMutation:b}=Y(),{data:o,isError:v,isLoading:N,refetch:I}=d==="Pay-In"?Z({searchQuery:w,pageNumber:l,pageSize:r,date:m,status:t==null?void 0:t.toUpperCase()},V):ee({searchQuery:w,pageNumber:l,pageSize:r,date:m,status:t==null?void 0:t.toUpperCase()}),k=E=>{b.mutate(E,{onSuccess:()=>{I(),M.success("Action  Completed SuccessFully"),c({isVerifyMpin:!1})},onError:L=>{var P;const x=(P=L.response)==null?void 0:P.data;M.error((x==null?void 0:x.message)||(x==null?void 0:x.error)),c({isVerifyMpin:!1})}})};return e.jsxs(A.div,{className:"bg-white shadow-lg rounded-2xl",variants:$,initial:"hidden",animate:"visible",children:[e.jsx(U,{title:`${d} ${t} List`,searchComponent:e.jsx(H,{handlePageSizeChange:a,pageSizeOptions:[10,20,30],pageSize:r,setSearchQuery:z})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),((S=f==null?void 0:f.role)==null?void 0:S.toUpperCase())==="SUPERADMIN"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Reseller Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Mode"}),d==="Pay-In"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Type"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Utr"}),d==="Pay-In"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Ref"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"file"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Date"})]}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Transaction Id"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Initiated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Completed At"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap",children:"Actions"})]})}),!v&&((T=o==null?void 0:o.results)==null?void 0:T.length)!=0&&!N&&e.jsx(_,{data:(o==null?void 0:o.results)||[],openModal:p,isPending:N,type:d,status:t,start_number:u})]}),N?e.jsx(F,{}):(v||(o==null?void 0:o.results.length)===0)&&e.jsx(K,{})]}),e.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:[e.jsx(J,{currentPage:l,handlePageChange:i,pageSize:r,handlePageSizeChange:a,totalCount:(o==null?void 0:o.pagination.total)||1}),e.jsx(X,{isOpen:s.confirm||!1,onClose:()=>c({confirm:!1}),onConfirm:()=>p({isVerifyMpin:!0},n),disabled:b.isPending,title:"Transaction",description:"Are you sure you want to Change this Transaction ?"}),e.jsx(se,{isOpen:s.isVerifyMpin||!1,closeModal:()=>c({isVerifyMpin:!1}),onVerify:()=>k(n),isNextTaskPending:b.isPending}),e.jsx(te,{transaction_id:n==null?void 0:n.transaction_id,isOpen:s.isUtr||!1,closeModal:()=>c({isUtr:!1})}),e.jsx(ne,{isOpen:s.isTaxDetails||!1,onClose:()=>c({isTaxDetails:!1}),type:n==null?void 0:n.type,transaction_id:n==null?void 0:n.transaction_id})]})]})};export{me as default};
