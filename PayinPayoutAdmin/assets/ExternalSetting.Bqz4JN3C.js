import{u as M,a as x,b as m,c as r,r as u,d as S,j as e,m as h,P as A,L as q,N as D,C as F,V as P}from"./index.BVLUjDox.js";const U=()=>M({queryKey:["externalTokens"],queryFn:async()=>{const{data:t}=await r.get("fetch-external-token/");return t==null?void 0:t.data}}),O=()=>{const t=x();return m({mutationFn:async a=>{const{data:l}=await r.post("create-external-token/",a);return l},onSuccess:()=>{t.invalidateQueries({queryKey:["externalTokens"]})}})},Q=()=>{const t=x();return m({mutationFn:async a=>{const{data:l}=await r.put("update-external-token/",a);return l},onSuccess:()=>{t.invalidateQueries({queryKey:["externalTokens"]})}})},K=()=>{const t=x();return m({mutationFn:async a=>{const{data:l}=await r.delete("delete-external-token/",{data:a});return l},onSuccess:()=>{t.invalidateQueries({queryKey:["externalTokens"]})}})},Y=({open:t,onClose:a,children:l})=>t?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50 px-4",children:e.jsxs(h.div,{className:"bg-white rounded-xl p-6 w-full max-w-sm sm:max-w-md lg:max-w-lg shadow-xl",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},children:[l,e.jsx("button",{onClick:a,className:"mt-4 bg-gray-400 text-white px-4 py-2 rounded-lg hover:bg-gray-500 w-full sm:w-auto",children:"Close"})]})}):null,V=()=>{const{data:t,isLoading:a}=U(),l=O(),f=Q(),g=K(),[k,o]=u.useState(!1),{openModal:c,isModalOpen:b,closeModal:p,data:w}=S(),[d,y]=u.useState("add"),[n,i]=u.useState({type:"PAYU",token:""}),j=()=>{y("add"),i({type:"PAYU",token:""}),o(!0)},N=(s,T,E)=>{y("edit"),i({id:s,type:T,token:E}),o(!0)},v=()=>{!n.token.trim()||!n.type.trim()||(d==="add"?l.mutate({token:n.token,type:n.type},{onSuccess:()=>o(!1)}):d==="edit"&&n.id&&f.mutate({id:n.id,token:n.token,type:n.type},{onSuccess:()=>o(!1)}))},C=s=>{c==null||c({confirm:!0},{id:s})};return e.jsxs(h.div,{className:"bg-white shadow-lg rounded-2xl min-h-screen p-4 sm:p-6",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx(A,{title:"External Settings"}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{onClick:j,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 w-full sm:w-auto",children:"+ Add Token"})}),e.jsx("div",{className:"mt-8",children:a?e.jsx(q,{}):t!=null&&t.length?e.jsx("ul",{className:"space-y-3",children:t.map(s=>e.jsxs("li",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between border p-3 rounded-lg shadow-sm gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-mono text-sm break-all",children:["Token: ",s.token]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Type: ",s.type]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>N(s.id,s.type,s.token),className:"bg-yellow-500 text-white px-3 py-2 rounded-lg hover:bg-yellow-600 w-full sm:w-auto",children:"Edit"}),e.jsx("button",{onClick:()=>C(s.id),className:"bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 w-full sm:w-auto",children:"Delete"})]})]},s.id))}):e.jsx(D,{})}),e.jsxs(Y,{open:k,onClose:()=>o(!1),children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:d==="add"?"Add Token":"Edit Token"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsx("select",{value:n.type,onChange:s=>i({...n,type:s.target.value}),className:"border rounded-lg px-3 py-2 w-full",children:e.jsx("option",{value:"PAYU",children:"PAYU"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Token"}),e.jsx("input",{type:"text",value:n.token,onChange:s=>i({...n,token:s.target.value}),placeholder:"Enter token",className:"border rounded-lg px-3 py-2 w-full"})]}),e.jsx("button",{onClick:v,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 w-full",children:d==="add"?"Add":"Update"})]})]}),e.jsx(F,{isOpen:b.confirm||!1,onClose:()=>p({confirm:!1}),onConfirm:()=>{g.mutate({id:w.id},{onSuccess:()=>{p({confirm:!1}),P.success("Token deleted successfully")}})},title:"Delete",description:"Are you sure you want to delete this External Setting?"})]})};export{V as default};
