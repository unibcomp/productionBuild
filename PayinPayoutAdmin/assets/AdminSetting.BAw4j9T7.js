import{l as M,q as R,r as x,V as w,j as a,z as v,s as E,P as F,B as U,L as B,Y as y,m as I}from"./index.DsbNlJU-.js";import{a as T}from"./RegisterUserModal.Dpid2wVE.js";import{u as $}from"./useSetting.iDkGrbKf.js";const q=(p,b,c,i)=>_=>{if(i){const m=Number(c[p]??0);return _>=m?!0:`${b} must be greater than or equal to ${m}`}return!0},Y=[{value:"PHONEPAY",label:"PHONEPAY"},{value:"PAYU",label:"PAYU"},{value:"GATEPAY",label:"GATEPAY"}],V=({user_id:p,isOpen:b,closeModal:c,isUser:i,role:_,reseller_name:m,reseller_url:h})=>{const{data:j,isLoading:A,refetch:C}=$({user_id:p}),{createOrUpdate:l}=T(),{user:s}=M(),u=(s==null?void 0:s.Setting)||{},e=j||u,{register:f,handleSubmit:S,control:g,reset:P,formState:{errors:d}}=R({defaultValues:{reseller_name:(e==null?void 0:e.reseller_name)||m,reseller_url:(e==null?void 0:e.reseller_url)||h,paymentMode:(e==null?void 0:e.paymentMode)||"PAYU",payoutMode:(e==null?void 0:e.payoutMode)||"UPI",dispute_days:(e==null?void 0:e.dispute_days)||7,breach_penalty_perce:(e==null?void 0:e.breach_penalty_perce)||0,breach_penalty_refund:(e==null?void 0:e.breach_penalty_refund)||0,breach_penalty_payout:(e==null?void 0:e.breach_penalty_payout)||0,transaction_payment_fees:(e==null?void 0:e.transaction_payment_fees)||0,transaction_vendor_payout_fee:(e==null?void 0:e.transaction_vendor_payout_fee)||0,transaction_refund_fees:(e==null?void 0:e.transaction_refund_fees)||0,transaction_at_onetime:(e==null?void 0:e.transaction_at_onetime)||0,transaction_montly_fees:(e==null?void 0:e.transaction_montly_fees)||0,user_id:e==null?void 0:e.user_id,upi:(e==null?void 0:e.upi)||.35,wallet:(e==null?void 0:e.wallet)||3.1,netBanking:(e==null?void 0:e.netBanking)||3,visaCard:(e==null?void 0:e.visaCard)||3,amexCard:(e==null?void 0:e.amexCard)||0,dinerclubCard:(e==null?void 0:e.dinerclubCard)||4.1,emiCard:(e==null?void 0:e.emiCard)||3.3,masterCard:(e==null?void 0:e.masterCard)||3,debitCardUpto2000:(e==null?void 0:e.debitCardAbove2000)||1.45,debitCardAbove2000:(e==null?void 0:e.debitCardAbove2000)||1.95,status:(e==null?void 0:e.status)??!1,minPayOut:(e==null?void 0:e.minPayOut)||10,maxPayOut:(e==null?void 0:e.maxPayOut)||.3,settlment_hold_percentage:e.settlment_hold_percentage||0,isPayout:!0,isPayin:!0}});x.useEffect(()=>{(e||m||h)&&P({reseller_name:e.reseller_name||m,reseller_url:e.reseller_url||h,paymentMode:e.paymentMode||"CASHFREE",payoutMode:e.payoutMode||"UPI",dispute_days:e.dispute_days||7,breach_penalty_perce:e.breach_penalty_perce||0,breach_penalty_refund:e.breach_penalty_refund||0,breach_penalty_payout:e.breach_penalty_payout||0,transaction_payment_fees:e.transaction_payment_fees||0,transaction_vendor_payout_fee:e.transaction_vendor_payout_fee||0,transaction_refund_fees:e.transaction_refund_fees||0,transaction_at_onetime:e.transaction_at_onetime||0,transaction_montly_fees:e.transaction_montly_fees||0,user_id:e.user_id,upi:e.upi||.35,wallet:e.wallet||3.1,netBanking:e.netBanking||3,visaCard:e.visaCard||3,amexCard:e.amexCard||0,dinerclubCard:e.dinerclubCard||4.1,emiCard:e.emiCard||3.3,masterCard:e.masterCard||3,debitCardUpto2000:e.debitCardUpto2000||1.45,debitCardAbove2000:e.debitCardAbove2000||1.95,status:e.status??!1,minPayOut:e.minPayOut||10,maxPayOut:e.maxPayOut||.3,settlment_hold_percentage:e.settlment_hold_percentage||0,isPayin:e.isPayin??!0,isPayout:e.isPayout??!0})},[j,P,C,u,m,h]);const O=t=>{l.mutate({user_id:p,data:t})};x.useEffect(()=>{var t;if(l.isSuccess)w.success("Updated successfully"),c(),C();else if(l.isError){const o=(t=l.error.response)==null?void 0:t.data;w.error((o==null?void 0:o.error)||(o==null?void 0:o.message))}},[l.isError,l.isSuccess]);const n=(t,r,o,k="0.01")=>{var N;return a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:t}),a.jsx("input",{type:"number",step:k,placeholder:o,...f(r,{required:`${t} is required`,valueAsNumber:!0,validate:q(r,t,u,i)}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),d[r]&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:((N=d[r])==null?void 0:N.message)??""})]})};return a.jsx(v,{show:b,as:x.Fragment,children:a.jsxs(E,{as:"div",className:"relative z-50",onClose:c,children:[a.jsx(v.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:a.jsx("div",{className:"fixed inset-0 bg-black/60"})}),a.jsx("div",{className:"fixed inset-0 ",children:a.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:a.jsx(v.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-90",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-90",children:a.jsxs(E.Panel,{className:"custom-scroll h-[90vh] relative w-full max-w-5xl transform overflow-hidden rounded-lg bg-white p-0 text-left align-middle shadow-xl transition-all z-100",children:[a.jsx("div",{className:"sticky top-0 z-50 bg-white border-b px-4 py-3 flex items-center justify-between shadow-sm ",children:a.jsx(F,{title:`${i?"User":"Admin"} Setting`,searchComponent:a.jsx(U,{buttons:[{label:"Close",onClick:()=>c(),variant:"danger"}]})})}),a.jsx("div",{className:"p-4",children:A?a.jsx(B,{}):i&&(s==null?void 0:s.role)==="ADMIN"&&u&&Object.keys(u).length<1?a.jsx("div",{children:"Failed To Load"}):a.jsxs("form",{onSubmit:S(O),className:"space-y-4",children:[!i&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),a.jsx("input",{type:"text",disabled:!0,placeholder:"Enter reseller name",...f("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),d.reseller_name&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.reseller_name.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),a.jsx("input",{type:"url",disabled:!0,placeholder:"https://example.com",...f("reseller_url",{required:"Reseller URL is required",pattern:{value:/^(https?:\/\/)?([\w\-])+\.\w{2,}(\S*)?$/i,message:"Enter a valid URL"}}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),d.reseller_url&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.reseller_url.message})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Payment Mode"}),a.jsx(y,{name:"paymentMode",control:g,rules:{required:"Payment mode is required"},render:({field:t})=>a.jsxs("select",{...t,className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[a.jsx("option",{value:"",children:"Select payment mode"}),Y.map(r=>a.jsx("option",{value:r.value,children:r.label},r.value))]})}),d.paymentMode&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.paymentMode.message})]})}),n("Dispute Days","dispute_days","Enter dispute days","1"),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n("Breach Penalty %","breach_penalty_perce","Percentage"),n("Breach Penalty Refund","breach_penalty_refund","Refund amount"),n("Breach Penalty Payout","breach_penalty_payout","Payout amount")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n("Payment Fees","transaction_payment_fees","Payment fees"),n("Vendor Payout Fees","transaction_vendor_payout_fee","Vendor payout fees"),n("Refund Fees","transaction_refund_fees","Refund fees")]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n("One‑time Fees","transaction_at_onetime","One‑time fees"),n("Monthly Fees","transaction_montly_fees","Monthly fees")]}),!["PAYOUT_APP_USER"].includes(_??"")&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayIn Charge Configuration"}),a.jsxs("div",{children:[(s==null?void 0:s.role)==="SUPERADMIN"&&a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Payin Status"}),a.jsx(y,{name:"isPayin",control:g,render:({field:t})=>a.jsx("button",{type:"button",role:"switch","aria-checked":t.value,onClick:()=>t.onChange(!t.value),className:`w-12 h-6 flex items-center rounded-full transition-colors duration-300 focus:outline-none ${t.value?"bg-green-500":"bg-gray-300"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${t.value?"translate-x-6":"translate-x-1"}`})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 ",children:[n("UPI  (%)","upi","Ex: 0.95"),n("Wallet  (%)","wallet","Ex: 1.2"),n("Net Banking  (%)","netBanking","Ex: 1.5")]}),a.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Card Wise (%)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n("Visa Card","visaCard","Ex: 1.2"),n("MasterCard","masterCard","Ex: 1.25"),n("Amex Card","amexCard","Ex: 1.3"),n("Diner Club","dinerclubCard","Ex: 1.4"),n("EMI Card","emiCard","Ex: 2.0")]}),a.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Debit Card Slabs (%)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n("Upto INR 2000","debitCardUpto2000","Ex: 1.45"),n("Above INR 2000","debitCardAbove2000","Ex: 1.95"),n("Settlment Hold (%)","settlment_hold_percentage","Ex: 1")]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayOut Charge  Configuration"}),(s==null?void 0:s.role)==="SUPERADMIN"&&a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"PayOut Status"}),a.jsx(y,{name:"isPayout",control:g,render:({field:t})=>a.jsx("button",{type:"button",role:"switch","aria-checked":t.value,onClick:()=>t.onChange(!t.value),className:`w-12 h-6 flex items-center rounded-full transition-colors duration-300 focus:outline-none ${t.value?"bg-green-500":"bg-gray-300"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${t.value?"translate-x-6":"translate-x-1"}`})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n("Min(Flat)","minPayOut","Ex: 0.95"),n("max(%) ","maxPayOut","Ex: 1.2")]})]}),i&&a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Status"}),a.jsx(y,{name:"status",control:g,render:({field:t})=>a.jsx("button",{type:"button",role:"switch","aria-checked":t.value,onClick:()=>t.onChange(!t.value),className:`w-12 h-6 flex items-center rounded-full transition duration-300 focus:outline-none ${t.value?"bg-green-500":"bg-gray-300"}`,children:a.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${t.value?"translate-x-6":"translate-x-1"}`})})})]}),a.jsx(I.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:l.isPending,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-md transition",children:l.isPending?"Saving...":"Save"})]})})]})})})})]})})};export{V as A};
