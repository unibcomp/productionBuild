import{u as b,a as S,b as w,j as e,m as g,c as A,P as C,S as v,B as P,L as E,N as _,C as D,V as p,d as O,r as U,e as z,f as R}from"./index.BvmzF7-c.js";import{u as V,C as k}from"./RegisterUserModal.BtVcZ5K6.js";import{u as f}from"./useDeleteAndSuspendUser.BQ9L6Q_e.js";const M=()=>{var N;const{handlePageChange:x,handlePageSizeChange:n,pageNumber:u,pageSizeValue:l}=b(),{isModalOpen:i,openModal:o,closeModal:c,data:s}=S(),{setSearchQuery:t,searchQuery:h}=w(),{mutate:r}=f(),{data:a,isError:d,isLoading:j,refetch:y}=V({pageNumber:u,pageSize:l,searchQuery:h,role:"OPERATIONAL"});return e.jsxs(g.div,{className:"bg-white shadow-lg rounded-2xl",variants:A,initial:"hidden",animate:"visible",children:[e.jsx(C,{title:"All Operational Users",searchComponent:e.jsxs(e.Fragment,{children:[e.jsx(v,{handlePageSizeChange:n,pageSizeOptions:[10,20,30],pageSize:l,setSearchQuery:t}),e.jsx(P,{buttons:[{label:"Create",onClick:()=>o({isRegister:!0},{isRegister:!0}),variant:"primary"}]})]})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Full Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Account status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Created At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Updated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Actions"})]})}),!d&&(a==null?void 0:a.data.length)!=0&&!j&&e.jsx(I,{data:(a==null?void 0:a.data)||[],openModal:o,refetch:y})]}),j?e.jsx(E,{}):(d||((N=a==null?void 0:a.data)==null?void 0:N.length)===0)&&e.jsx(_,{})]}),e.jsx(k,{isOpen:i.isRegister||!1,isOperational:!0,closeModal:()=>c({isRegister:!1}),refetch:y}),e.jsx(D,{isOpen:i.confirm||!1,onClose:()=>c({confirm:!1}),onConfirm:()=>{s!=null&&s.user_id&&r({user_id:s.user_id,isDeleted:!0},{onSuccess:m=>{c({confirm:!1}),p.success(m.message||"deleted successfully")},onError:m=>{p.error(m.message)}})},title:"Delete User",description:"Are you sure you want to delete this item ?"}),e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:e.jsx(O,{currentPage:u,handlePageChange:x,pageSize:l,handlePageSizeChange:n,totalCount:(a==null?void 0:a.pagination.total)||1})})]})},I=({data:x,openModal:n,refetch:u})=>{const{mutate:l}=f(),[i,o]=U.useState(null),c=({item:s,account_status:t,isFrozen:h})=>{o(s.user_id),console.log(t),l({user_id:s.user_id,accountStatus:s.accountStatus==="SUSPENDED"?"ACTIVE":"SUSPENDED",...h&&{isFrozen:!s.isFrozen}},{onSuccess:r=>{u(),p.success(r.message||"Account status updated successfully")},onError:r=>{var a,d;p.error(((d=(a=r==null?void 0:r.response)==null?void 0:a.data)==null?void 0:d.message)||"Something went wrong while updating status")},onSettled:()=>{o(null)}})};return e.jsx("tbody",{className:"custom-scroll",children:x.map((s,t)=>e.jsxs(g.tr,{className:"hover:bg-gray-50 transition-all duration-150",variants:z,initial:"hidden",animate:"visible",custom:t,children:[e.jsx("td",{className:"px-4 py-3 font-bold",children:t+1}),e.jsx("td",{className:"px-4 py-3 font-bold",children:s.full_name}),e.jsx("td",{className:"px-4 py-3",children:s.mobile}),e.jsx("td",{className:"px-4 py-3",children:s.email}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>c({item:s,account_status:!0}),disabled:i===s.user_id,className:`w-10 h-5 cursor-pointer flex items-center rounded-full p-1 transition-colors duration-300
        ${s.accountStatus==="ACTIVE"?"bg-blue-600":"bg-gray-300"}
        ${i===s.user_id?"opacity-50 cursor-not-allowed":""}
    `,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition-transform ${s.accountStatus==="ACTIVE"?"translate-x-5":"translate-x-0"}`})})}),e.jsx("td",{className:"px-4 py-3",children:s.createdAt}),e.jsx("td",{className:"px-4 py-3",children:s.updatedAt}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-3 flex-wrap w-[300px]",children:[e.jsxs(R,{to:`/permission/${s==null?void 0:s.user_id}`,className:"cursor-pointer flex items-center gap-1 text-green-600 hover:text-green-700 transition-colors font-medium","aria-label":"Grant Permission",children:[e.jsx("span",{className:"material-symbols-outlined text-base",children:"check_circle"}),e.jsx("span",{className:"text-sm",children:"Permission"})]}),e.jsxs("button",{onClick:()=>n==null?void 0:n({confirm:!0},{user_id:s.user_id}),className:"flex items-center gap-1 px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 transition whitespace-nowrap cursor-pointer",children:[e.jsx("span",{className:"material-symbols-outlined text-[12px] leading-none",children:"delete"}),"Delete"]})]})})]},t))})};export{M as default};
