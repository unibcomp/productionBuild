import{u as $,k as O,a as T,e as k,l as q,r as p,F as N,V as C,j as e,z as w,n as P,m as F,G as B,P as D,L as Y,H as V}from"./index.0M3KEVIp.js";import{B as I}from"./ActionButton.C0uFmUwA.js";import{u as H}from"./useSetting.hDSnslSJ.js";const G=o=>T.get("/reseller-list",{params:o}).then(c=>c.data),Z=({kycStatus:o="",searchQuery:c="",endDate:x="",startDate:i="",pageNumber:g=1,pageSize:l=10})=>{const _={...o&&{kycStatus:o},...c&&{searchQuery:c},...i&&{startDate:i},...x&&{endDate:x},...g&&{pageNumber:g},...l&&{pageSize:l}},{isLoading:j,isError:d,data:m,refetch:r}=$({queryKey:["all reseller",_],queryFn:()=>G(_),staleTime:3e3,refetchOnWindowFocus:!1});return console.log("reseller",m),{isLoading:j,isError:d,data:m,refetch:r}},z=o=>T.post("/register/",o).then(c=>c.data),W=({user_id:o,data:c})=>T.put(`/admin-setting/update/${o}`,c).then(x=>x.data),L=()=>{const o=O({mutationFn:z});return{createOrUpdate:O({mutationFn:W}),registerUserMutation:o}},ee=({isOpen:o,closeModal:c,refetch:x,isSeller:i})=>{const{user:g}=k(),{register:l,handleSubmit:_,reset:j,setValue:d,watch:m,formState:{errors:r}}=q({defaultValues:{fullName:"",email:"",mobile:"",password:"",otp:"",otpMode:"",reseller_name:"",reseller_url:""}}),a=m("otpMode"),[f,M]=p.useState(!1),[A,v]=p.useState(!1),{registerUserMutation:u}=L(),R=t=>{u.mutate(t)},s=m("reseller_name"),n=m("reseller_url"),y=()=>{const t=m("fullName").trim();if(!t){C.error("Full name is required before generating.");return}const h=`5${Math.floor(Math.random()*1e9).toString().padStart(9,"0")}`,b=t.toLowerCase().replace(/\s+/g,""),E=B(n),S=`${b}${Math.floor(1e3+Math.random()*9e3)}${E}`,U=Math.floor(1e5+Math.random()*9e5).toString();d("mobile",h),d("email",S),d("otp",U),v(!0)};return p.useEffect(()=>{s&&s&&N[s]&&d("reseller_url",N[s])},[s,d]),p.useEffect(()=>{var h;const t=(h=Object.entries(N).find(([,b])=>b===n))==null?void 0:h[0];n&&t&&d("reseller_name",t)},[n,d]),p.useEffect(()=>{var t,h,b,E;if(u.isSuccess)j(),x==null||x(),c(),C.success("Successfully Created"),v(!1);else if(u.isError){const S=u.error,U=((h=(t=S.response)==null?void 0:t.data)==null?void 0:h.message)||((E=(b=S.response)==null?void 0:b.data)==null?void 0:E.error)||"Something went wrong";C.error(U)}},[u.isSuccess,u.isError]),e.jsx(w,{appear:!0,show:o,as:p.Fragment,children:e.jsxs(P,{as:"div",className:"relative z-[1000]",onClose:c,children:[e.jsx(w.Child,{as:p.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(P.Panel,{className:"w-full max-w-3xl rounded bg-white p-6 shadow-xl transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(P.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Account"}),e.jsx(I,{buttons:[{label:"Close",onClick:()=>c(),variant:"danger"}]})]}),e.jsxs("form",{onSubmit:_(R),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(g==null?void 0:g.role)==="SUPERADMIN"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsxs("select",{...l("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select reseller"}),Object.entries(N).map(([t])=>e.jsx("option",{value:t,children:t},t))]}),r.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsxs("select",{...l("reseller_url",{required:"Reseller URL is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Select URL"}),Object.entries(N).map(([,t])=>e.jsx("option",{value:t,children:t},t))]}),r.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.reseller_url.message})]})]}),!i&&e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"OTP Mode"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{...l("otpMode",{required:"OTP Mode is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",children:[e.jsx("option",{value:"",children:"Select mode"}),e.jsx("option",{value:"STATIC",children:"STATIC"}),e.jsx("option",{value:"DYNAMIC",children:"DYNAMIC"})]}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),r.otpMode&&e.jsx("p",{className:"text-red-400 text-sm",children:r.otpMode.message})]}),(i||a)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("input",{type:"text",...l("fullName",{required:"Full Name is required"}),placeholder:"Enter full name",disabled:A,className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.fullName&&e.jsx("p",{className:"text-red-400 text-sm",children:r.fullName.message})]}),!i&&a==="STATIC"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex flex-col justify-end",children:A?e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Your OTP"}),e.jsx("input",{type:"text",...l("otp",{required:"OTP is required"}),value:m("otp"),readOnly:a==="STATIC",disabled:a==="STATIC",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.otp&&e.jsx("p",{className:"text-red-400 text-sm",children:r.otp.message})]}):e.jsx(F.button,{type:"button",onClick:y,whileHover:{scale:1.03},whileTap:{scale:.97},className:"w-full py-2 px-4 bg-cyan-600 hover:bg-cyan-700 text-white font-medium rounded-lg",children:"Generate"})})}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",disabled:!i&&a!="DYNAMIC",...l("email",{required:"Email is required"}),placeholder:"Enter email",className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.email&&e.jsx("p",{className:"text-red-400 text-sm",children:r.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Mobile"}),e.jsx("input",{type:"text",disabled:!i&&a!="DYNAMIC",maxLength:10,inputMode:"numeric",...l("mobile",{required:"Mobile number is required",pattern:{value:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),placeholder:"Enter mobile number",...l("mobile",{required:"Mobile is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),r.mobile&&e.jsx("p",{className:"text-red-400 text-sm",children:r.mobile.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:f?"text":"password",...l("password",{required:"Password is required"}),placeholder:"Create a password",className:"w-full py-3 px-4 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500"}),e.jsx("span",{onClick:()=>M(!f),className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer",children:f?"visibility_off":"visibility"})]}),r.password&&e.jsx("p",{className:"text-red-400 text-sm",children:r.password.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{...l("role",{required:"Role is required"}),className:"w-full py-3 px-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-cyan-500 appearance-none",disabled:i,children:i?e.jsx("option",{value:"ADMIN",selected:!0,children:"Admin"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"API_USER",children:"API User"}),e.jsx("option",{value:"APP_USER",children:"App User"}),e.jsx("option",{value:"PAYOUT_APP_USER",children:"PAYOUT APP USER"}),e.jsx("option",{value:"PAYOUT_API_USER",children:"PAYOUT API USER"})]})}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none",children:"expand_more"})]}),r.role&&e.jsx("p",{className:"text-red-400 text-sm",children:r.role.message})]})]})]}),e.jsx(F.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:u.isPending,className:"w-full py-3 bg-[#185e91] hover:bg-[#1b6ca8] text-white font-semibold rounded-lg",children:u.isPending?"Processing...":"Create Account"})]})]})})})]})})},K=(o,c,x,i)=>g=>{if(i){const l=Number(x[o]??0);return g>=l?!0:`${c} must be greater than or equal to ${l}`}return!0},ae=({user_id:o,isOpen:c,closeModal:x,isUser:i,role:g})=>{const{data:l,isLoading:_,refetch:j}=H({user_id:o}),{createOrUpdate:d}=L(),{user:m}=k(),r=(m==null?void 0:m.Setting)||{},a=l||r,{register:f,handleSubmit:M,control:A,reset:v,formState:{errors:u}}=q({defaultValues:{reseller_name:a==null?void 0:a.reseller_name,reseller_url:(a==null?void 0:a.reseller_url)||"",paymentMode:(a==null?void 0:a.paymentMode)||"CASHFREE",payoutMode:(a==null?void 0:a.payoutMode)||"UPI",dispute_days:(a==null?void 0:a.dispute_days)||7,breach_penalty_perce:(a==null?void 0:a.breach_penalty_perce)||0,breach_penalty_refund:(a==null?void 0:a.breach_penalty_refund)||0,breach_penalty_payout:(a==null?void 0:a.breach_penalty_payout)||0,transaction_payment_fees:(a==null?void 0:a.transaction_payment_fees)||0,transaction_vendor_payout_fee:(a==null?void 0:a.transaction_vendor_payout_fee)||0,transaction_refund_fees:(a==null?void 0:a.transaction_refund_fees)||0,transaction_at_onetime:(a==null?void 0:a.transaction_at_onetime)||0,transaction_montly_fees:(a==null?void 0:a.transaction_montly_fees)||0,user_id:a==null?void 0:a.user_id,upi:(a==null?void 0:a.upi)||.35,wallet:(a==null?void 0:a.wallet)||3.1,netBanking:(a==null?void 0:a.netBanking)||3,visaCard:(a==null?void 0:a.visaCard)||3,amexCard:(a==null?void 0:a.amexCard)||0,dinerclubCard:(a==null?void 0:a.dinerclubCard)||4.1,emiCard:(a==null?void 0:a.emiCard)||3.3,masterCard:(a==null?void 0:a.masterCard)||3,debitCardUpto2000:(a==null?void 0:a.debitCardAbove2000)||1.45,debitCardAbove2000:(a==null?void 0:a.debitCardAbove2000)||1.95,status:(a==null?void 0:a.status)??!1,minPayOut:(a==null?void 0:a.minPayOut)||10,maxPayOut:(a==null?void 0:a.maxPayOut)||.3}});p.useEffect(()=>{l&&v({reseller_name:a.reseller_name||"",reseller_url:a.reseller_url||"",paymentMode:a.paymentMode||"CASHFREE",payoutMode:a.payoutMode||"UPI",dispute_days:a.dispute_days||7,breach_penalty_perce:a.breach_penalty_perce||0,breach_penalty_refund:a.breach_penalty_refund||0,breach_penalty_payout:a.breach_penalty_payout||0,transaction_payment_fees:a.transaction_payment_fees||0,transaction_vendor_payout_fee:a.transaction_vendor_payout_fee||0,transaction_refund_fees:a.transaction_refund_fees||0,transaction_at_onetime:a.transaction_at_onetime||0,transaction_montly_fees:a.transaction_montly_fees||0,user_id:a.user_id,upi:a.upi||.35,wallet:a.wallet||3.1,netBanking:a.netBanking||3,visaCard:a.visaCard||3,amexCard:a.amexCard||0,dinerclubCard:a.dinerclubCard||4.1,emiCard:a.emiCard||3.3,masterCard:a.masterCard||3,debitCardUpto2000:a.debitCardUpto2000||1.45,debitCardAbove2000:a.debitCardAbove2000||1.95,status:a.status??!1,minPayOut:a.minPayOut||10,maxPayOut:a.maxPayOut||.3})},[l,v,j,r]);const R=n=>{d.mutate({user_id:o,data:n})};p.useEffect(()=>{var n;if(d.isSuccess)C.success("Updated successfully"),x(),j();else if(d.isError){const t=(n=d.error.response)==null?void 0:n.data;C.error((t==null?void 0:t.error)||(t==null?void 0:t.message))}},[d.isError,d.isSuccess]);const s=(n,y,t,h="0.01")=>{var b;return e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:n}),e.jsx("input",{type:"number",step:h,placeholder:t,...f(y,{required:`${n} is required`,valueAsNumber:!0,validate:K(y,n,r,i)}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u[y]&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:((b=u[y])==null?void 0:b.message)??""})]})};return e.jsx(w,{show:c,as:p.Fragment,children:e.jsxs(P,{as:"div",className:"relative z-50",onClose:x,children:[e.jsx(w.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/60"})}),e.jsx("div",{className:"fixed inset-0 ",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:e.jsx(w.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-90",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-90",children:e.jsxs(P.Panel,{className:"custom-scroll h-[90vh] relative w-full max-w-5xl transform overflow-hidden rounded-lg bg-white p-0 text-left align-middle shadow-xl transition-all z-100",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white border-b px-4 py-3 flex items-center justify-between shadow-sm ",children:e.jsx(D,{title:`${i?"User":"Admin"} Setting`,searchComponent:e.jsx(I,{buttons:[{label:"Close",onClick:()=>x(),variant:"danger"}]})})}),e.jsx("div",{className:"p-4",children:_?e.jsx(Y,{}):i&&(m==null?void 0:m.role)==="ADMIN"&&r&&Object.keys(r).length<1?e.jsx("div",{children:"Failed To Load"}):e.jsxs("form",{onSubmit:M(R),className:"space-y-4",children:[!i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller Name"}),e.jsx("input",{type:"text",disabled:!0,placeholder:"Enter reseller name",...f("reseller_name",{required:"Reseller name is required"}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u.reseller_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.reseller_name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-1",children:"Reseller URL"}),e.jsx("input",{type:"url",disabled:!0,placeholder:"https://example.com",...f("reseller_url",{required:"Reseller URL is required",pattern:{value:/^(https?:\/\/)?([\w\-])+\.\w{2,}(\S*)?$/i,message:"Enter a valid URL"}}),className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:outline-none"}),u.reseller_url&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.reseller_url.message})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"}),s("Dispute Days","dispute_days","Enter dispute days","1"),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s("Breach Penalty %","breach_penalty_perce","Percentage"),s("Breach Penalty Refund","breach_penalty_refund","Refund amount"),s("Breach Penalty Payout","breach_penalty_payout","Payout amount")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s("Payment Fees","transaction_payment_fees","Payment fees"),s("Vendor Payout Fees","transaction_vendor_payout_fee","Vendor payout fees"),s("Refund Fees","transaction_refund_fees","Refund fees")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s("One‑time Fees","transaction_at_onetime","One‑time fees"),s("Monthly Fees","transaction_montly_fees","Monthly fees")]}),!["PAYOUT_APP_USER"].includes(g??"")&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayIn Charge Configuration"}),e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s("UPI  (%)","upi","Ex: 0.95"),s("Wallet  (%)","wallet","Ex: 1.2"),s("Net Banking  (%)","netBanking","Ex: 1.5")]}),e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Card Wise (%)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s("Visa Card","visaCard","Ex: 1.2"),s("MasterCard","masterCard","Ex: 1.25"),s("Amex Card","amexCard","Ex: 1.3"),s("Diner Club","dinerclubCard","Ex: 1.4"),s("EMI Card","emiCard","Ex: 2.0")]}),e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Debit Card Slabs (%)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s("Upto INR 2000","debitCardUpto2000","Ex: 1.45"),s("Above INR 2000","debitCardAbove2000","Ex: 1.95")]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white bg-blue-600 px-4 py-2 rounded-md mt-6 mb-4 shadow-sm",children:"PayOut Charge  Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s("Min(Flat)","minPayOut","Ex: 0.95"),s("max(%) ","maxPayOut","Ex: 1.2")]})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-md font-semibold text-gray-700 mt-4",children:"Status"}),e.jsx(V,{name:"status",control:A,render:({field:n})=>e.jsx("button",{type:"button",role:"switch","aria-checked":n.value,onClick:()=>n.onChange(!n.value),className:`w-12 h-6 flex items-center rounded-full transition duration-300 focus:outline-none ${n.value?"bg-green-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 ${n.value?"translate-x-6":"translate-x-1"}`})})})]}),e.jsx(F.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:d.isPending,className:"w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-md transition",children:d.isPending?"Saving...":"Save"})]})})]})})})})]})})};export{ae as A,ee as C,Z as u};
