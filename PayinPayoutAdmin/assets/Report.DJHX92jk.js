import{o as C,r as b,q as L,A as P,j as e,m as T,P as I,V as p,D as O,E as _,F as q}from"./index.Bweg_k96.js";const U=["ALL","SUCCESS","PENDING","PROCESSING","REJECTED","REVERSE"],w=o=>{const r=new Date,l=r.toISOString().split("T")[0];let a;switch(o){case"today":a=l;break;case"7d":a=new Date(r.setDate(r.getDate()-7)).toISOString().split("T")[0];break;case"14d":a=new Date(r.setDate(r.getDate()-14)).toISOString().split("T")[0];break;case"1m":a=new Date(r.setMonth(r.getMonth()-1)).toISOString().split("T")[0];break;default:a=""}return{start:a,end:l}},V=()=>{const{register:o,handleSubmit:r,setValue:l,watch:a,formState:{errors:d}}=C({defaultValues:{dateRange:"",startDate:"",endDate:"",actions:[],format:"",type:""}}),[h,N]=b.useState(null),m=a("search"),{data:c}=L({pageNumber:1,pageSize:10,searchQuery:(m==null?void 0:m.trim())??""}),[y,D]=b.useState(!1),[f,j]=b.useState(!1),i=a("actions"),u=a("dateRange"),v=a("startDate"),S=a("endDate"),k=t=>{let s=[...i];t==="ALL"?s=["ALL"]:(s=s.filter(n=>n!=="ALL"),s.includes(t)?s=s.filter(n=>n!==t):s.push(t)),l("actions",s),j(!1)},g=async t=>{if(!x||x.length===0){p.error("No data available to export.");return}const s=`${u||"report"}_${Date.now()}`;switch(t){case"pdf":await q(x,s);break;case"excel":await _(x,s);break;case"csv":await O(x,s);break;default:p.error("Invalid format selected.");return}p.success("Report downloaded successfully.")},R=t=>{if(t.actions.length===0){p.error("Please select at least one action.");return}if(t.dateRange!=="custom"){const{start:s,end:n}=w(t.dateRange);t.startDate=s,t.endDate=n,l("startDate",s),l("endDate",n)}D(!0)},{data:x,isLoading:A}=P({startDate:v,endDate:S,actions:i,date:u,type:a("type"),...h&&{user_id:h},enabled:y});return e.jsxs(T.div,{className:"bg-white shadow-lg rounded-2xl min-h-screen",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsx(I,{title:"All Report"}),e.jsxs("form",{onSubmit:r(R),className:"p-6 space-y-8 text-gray-800 bg-white rounded-2xl shadow",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{...o("dateRange",{required:"Date range is required"}),onChange:t=>{const s=t.target.value;if(l("dateRange",s),s!=="custom"){const{start:n,end:E}=w(s);l("startDate",n),l("endDate",E)}else l("startDate",""),l("endDate","")},className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"7d",children:"Last 7 Days"}),e.jsx("option",{value:"14d",children:"Last 14 Days"}),e.jsx("option",{value:"1m",children:"Last 1 Month"}),e.jsx("option",{value:"custom",children:"Custom"})]}),d.dateRange&&e.jsx("p",{className:"text-sm text-red-600",children:d.dateRange.message})]}),u==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",...o("startDate",{required:"Start date is required"}),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500"}),d.startDate&&e.jsx("p",{className:"text-sm text-red-600",children:d.startDate.message})]}),u==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",...o("endDate",{required:"End date is required"}),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500"}),d.endDate&&e.jsx("p",{className:"text-sm text-red-600",children:d.endDate.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{...o("type",{required:!0}),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500",defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Please select type"}),e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"PAYIN",children:"Payin"}),e.jsx("option",{value:"PAYOUT",children:"Payout"}),e.jsx("option",{value:"SETTLED",children:"Settlement"})]}),d.type&&e.jsx("p",{className:"text-sm text-red-600",children:"Please select a type"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Actions"}),e.jsx("div",{className:"w-full border border-gray-300 rounded-lg px-4 py-2 cursor-pointer bg-white",onClick:()=>j(!f),children:i.length>0?i.join(", "):"Select actions"}),f&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border border-gray-300 rounded-lg shadow p-3",children:U.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("input",{type:"checkbox",checked:i.includes(t),onChange:()=>k(t),className:"accent-blue-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:t})]},t))}),i.length===0&&e.jsx("p",{className:"text-sm text-red-600",children:"Please select at least one action"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Search (Mobile or Name)"}),e.jsx("input",{type:"text",placeholder:"Enter mobile or name",...o("search"),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500"}),m&&Array.isArray(c==null?void 0:c.data)&&c.data.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:c.data.map(t=>e.jsxs("div",{className:"px-4 py-2 text-sm text-gray-800 hover:bg-blue-100 cursor-pointer",onClick:()=>{l("search",`${t.full_name} (${t.mobile})`),N(t.user_id)},children:[e.jsx("div",{className:"font-medium",children:t.full_name||"Unnamed User"}),e.jsx("div",{className:"text-xs text-gray-500",children:t.mobile})]},t.user_id))})]})]}),e.jsx("div",{className:"flex justify-end",children:y?A?e.jsxs("button",{type:"button",disabled:!0,className:"bg-gray-300 text-gray-700 font-semibold px-6 py-3 rounded-xl shadow flex items-center gap-2 cursor-not-allowed",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Loading..."]}):e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>g("pdf"),className:"bg-red-600 hover:bg-red-700 text-white font-semibold px-6 py-3 rounded-xl shadow transition-all flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:"picture_as_pdf"}),"PDF"]}),e.jsxs("button",{type:"button",onClick:()=>g("excel"),className:"bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded-xl shadow transition-all flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_on"}),"Excel"]}),e.jsxs("button",{type:"button",onClick:()=>g("csv"),className:"bg-yellow-500 hover:bg-yellow-600 text-white font-semibold px-6 py-3 rounded-xl shadow transition-all flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:"description"}),"CSV"]})]}):e.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-xl shadow transition-all flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"download"}),"Generate Report"]})})]})]})};export{V as default};
