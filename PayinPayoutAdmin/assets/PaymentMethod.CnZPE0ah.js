import{e as j,h as w,j as e,m as g,c as b,P as N,B as v,L as f,N as A,r as m,i as M,V as y}from"./index.Cyn6yeLb.js";import{b as P,c as C,P as S}from"./PaymentGateWayModel.WtgetJ3u.js";const V=()=>{var n,a;const{gatewayId:r}=j(),{openModal:h,closeModal:u,data:c,isModalOpen:x}=w(),{updateGatewayMethod:o}=P(),{data:l,isError:i,isLoading:p,refetch:s}=C({gatewayId:r});return e.jsxs(g.div,{className:"bg-white shadow-lg rounded-2xl",variants:b,initial:"hidden",animate:"visible",children:[e.jsx(N,{title:" Payment  Gateway Method List",searchComponent:e.jsx(e.Fragment,{children:e.jsx(v,{buttons:[{label:"Create",onClick:()=>h({isGateway:!0},{gatewayId:r}),variant:"primary"}]})})}),e.jsxs("div",{className:"custom-scroll h-[70vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Is Active"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Min"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Max"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Created At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Updated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Actions"})]})}),!i&&((n=l==null?void 0:l.results)==null?void 0:n.length)!=0&&!p&&e.jsx(G,{data:(l==null?void 0:l.results)||[],updateGatewayMethod:o,refetch:s})]}),p?e.jsx(f,{}):(i||((a=l==null?void 0:l.results)==null?void 0:a.length)===0)&&e.jsx(A,{})]}),e.jsx(S,{isOpen:x.isGateway||!1,data:c,onClose:()=>u({isGateway:!1}),isMethod:!0,refetch:s})]})},G=({data:r,updateGatewayMethod:h,refetch:u})=>{const[c,x]=m.useState({}),[o,l]=m.useState(null);m.useEffect(()=>{const s=r.reduce((n,a)=>(n[a.id]={min:a.min,max:a.max,isActive:a.isActive},n),{});x(s)},[r]);const i=(s,n,a)=>{x(t=>({...t,[s]:{...t[s],[n]:n==="isActive"?!!a:parseFloat(a)}}))},p=s=>{const n=c[s];n&&(l(s),h.mutate({id:s,data:{min:n.min,max:n.max,isActive:n.isActive}},{onSuccess:a=>{y.success(a.message||"Updated successfully"),u()},onError:a=>{var t,d;y.error(((d=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:d.message)||"Something went wrong while updating")},onSettled:()=>{l(null)}}))};return e.jsx("tbody",{className:"custom-scroll",children:r.map((s,n)=>{const a=o===s.id,t=c[s.id];return e.jsxs(g.tr,{className:"hover:bg-gray-50 transition-all duration-150",variants:M,initial:"hidden",animate:"visible",custom:n,children:[e.jsx("td",{className:"px-4 py-3 font-bold",children:n+1}),e.jsx("td",{className:"px-4 py-3",children:s.displayName}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>i(s.id,"isActive",!(t!=null&&t.isActive)),disabled:a&&o===s.id,className:`w-10 h-5 cursor-pointer flex items-center rounded-full p-1 transition-colors duration-300 ${t!=null&&t.isActive?"bg-blue-600":"bg-gray-300"} ${a?"opacity-50 cursor-not-allowed":""}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow transform transition-transform ${t!=null&&t.isActive?"translate-x-5":"translate-x-0"}`})})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",value:(t==null?void 0:t.min)??0,step:"0.01",onChange:d=>i(s.id,"min",d.target.value),disabled:a&&o===s.id,className:"w-full py-1 px-2 rounded border text-sm",placeholder:"Min"})}),e.jsx("td",{children:e.jsx("input",{type:"number",value:(t==null?void 0:t.max)??0,step:"0.01",onChange:d=>i(s.id,"max",d.target.value),disabled:a&&o===s.id,className:"w-full py-1 px-2 rounded border text-sm",placeholder:"Max"})}),e.jsx("td",{className:"px-4 py-3",children:new Date(s.createdAt).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:new Date(s.updatedAt).toLocaleString()}),e.jsx("td",{children:e.jsx("button",{onClick:()=>p(s.id),disabled:a&&o===s.id,className:"mt-1 px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 disabled:opacity-50",children:a?"Saving...":"Save"})})]},s.id)})})};export{V as default};
