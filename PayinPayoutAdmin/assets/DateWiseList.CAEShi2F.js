import{l as I,j as e,z as P,r as v,n as f,v as M,b as E,h as L,o as O,e as k,c as R,m as U,f as q,P as B,S as Q,L as W,N as _,g as $,C as H,V as C}from"./index.CVrkjPml.js";import{a as G,u as J}from"./useDeposit.DLhkGhWG.js";import{D as K}from"./DateWiseTableBody.B8NCUHgR.js";import{a as X,M as Y}from"./MpinVerifyModal.CyXBRQoQ.js";import{u as Z}from"./useManualPayin.UltvtJkL.js";import"./useMpin.C-q5pF1H.js";const ee=({transaction_id:m,closeModal:p,isOpen:d})=>{const{register:i,handleSubmit:h,formState:{errors:x}}=I(),{createUpdateUtrMutation:o}=Z(),n=r=>{o.mutate({transaction_id:m,data:r},{onError:l=>{var a;const s=(a=l.response)==null?void 0:a.data;M.error((s==null?void 0:s.message)||(s==null?void 0:s.error)),p()},onSuccess:l=>{M.success(l.message||"SuccesFully Updated")}})};return e.jsx(P,{appear:!0,show:d,as:v.Fragment,children:e.jsxs(f,{as:"div",className:"relative z-50",onClose:p,children:[e.jsx(P.Child,{as:v.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(f.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsx(f.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Update Utr"}),e.jsxs("form",{onSubmit:h(n),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("input",{type:"number",...i("utr",{required:"Utr is required"}),className:"w-full py-2 px-3 rounded-md bg-white text-gray-900 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none",placeholder:"Enter Utr Number"}),x.utr&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:x.utr.message})]}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition cursor-pointer",children:o.isPending?"Processing...":"Submit"})]})]})})})]})})},oe=()=>{var w,b;const{handlePageChange:m,handlePageSizeChange:p,pageNumber:d,pageSizeValue:i,startItem:h}=E(),{openModal:x,isModalOpen:o,closeModal:n,data:r}=L(),{date:l,status:s,type:a}=O(),{user:u}=k(),D=a==="Pay-In",{setSearchQuery:V,searchQuery:j}=R(),{updateDepositMutation:y}=G(),{data:t,isError:N,isLoading:g,refetch:z}=a==="Pay-In"?J({searchQuery:j,pageNumber:d,pageSize:i,date:l,status:s==null?void 0:s.toUpperCase()},D):X({searchQuery:j,pageNumber:d,pageSize:i,date:l,status:s==null?void 0:s.toUpperCase()}),F=T=>{y.mutate(T,{onSuccess:()=>{z(),C.success("Action  Completed SuccessFully"),n({isVerifyMpin:!1})},onError:A=>{var S;const c=(S=A.response)==null?void 0:S.data;C.error((c==null?void 0:c.message)||(c==null?void 0:c.error)),n({isVerifyMpin:!1})}})};return e.jsxs(U.div,{className:"bg-white shadow-lg rounded-2xl",variants:q,initial:"hidden",animate:"visible",children:[e.jsx(B,{title:`${a} ${s} List`,searchComponent:e.jsx(Q,{handlePageSizeChange:p,pageSizeOptions:[10,20,30],pageSize:i,setSearchQuery:V})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Mobile"}),((w=u==null?void 0:u.role)==null?void 0:w.toUpperCase())==="SUPERADMIN"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Reseller Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Mode"}),a==="Pay-In"&&e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Type"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Utr"}),a==="Pay-In"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Ref"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"file"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Settled Date"})]}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Transaction Id"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Initiated At"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Completed At"}),e.jsx("th",{className:"px-4 py-3 text-center text-nowrap",children:"Actions"})]})}),!N&&((b=t==null?void 0:t.results)==null?void 0:b.length)!=0&&!g&&e.jsx(K,{data:(t==null?void 0:t.results)||[],openModal:x,isPending:g,type:a,start_number:h})]}),g?e.jsx(W,{}):(N||(t==null?void 0:t.results.length)===0)&&e.jsx(_,{})]}),e.jsxs(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:[e.jsx($,{currentPage:d,handlePageChange:m,pageSize:i,handlePageSizeChange:p,totalCount:(t==null?void 0:t.pagination.total)||1}),e.jsx(H,{isOpen:o.confirm||!1,onClose:()=>n({confirm:!1}),onConfirm:()=>x({isVerifyMpin:!0},r),disabled:y.isPending,title:"Transaction",description:"Are you sure you want to Change this Transaction ?"}),e.jsx(Y,{isOpen:o.isVerifyMpin||!1,closeModal:()=>n({isVerifyMpin:!1}),onVerify:()=>F(r),isNextTaskPending:y.isPending}),e.jsx(ee,{transaction_id:r==null?void 0:r.transaction_id,isOpen:o.isUtr||!1,closeModal:()=>n({isUtr:!1})})]})]})};export{oe as default};
