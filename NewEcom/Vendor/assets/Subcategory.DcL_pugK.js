import{o as w,m as C,z as f,a as S,c as i,j as e,s as F}from"./index.BhJFhA9E.js";import{u as L,a as I}from"./useCreateProduct.D3kK7Vpi.js";import{u as P,P as T}from"./usePagination.zxBDzV6t.js";import{X as z}from"./x.kUAwNJ9f.js";import{K as b}from"./transition.BmUUtwzS.js";import{h as v}from"./dialog.BRLV45dm.js";import{m as N}from"./proxy.DN7iSgEi.js";import{H as q}from"./hash.BF7gxpjA.js";import{I as E,T as _}from"./tag.CM1jRcfN.js";import{C as D}from"./circle-check-big.q5sySWM8.js";const K=()=>{const r=w();return C({mutationFn:async a=>{const n=new FormData;return n.append("name",a.name),n.append("category",a.category),a.image&&n.append("image",a.image),(await S.post("/subcategory",n,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:()=>{f.success("Subcategory created successfully!"),r.invalidateQueries({queryKey:["sub-category"]})},onError:a=>{f.error(a?.response?.data?.error||a?.message||"Failed to create subcategory")}})},M=()=>{const r=w();return C({mutationFn:async({id:a,isActive:n})=>(await S.put(`/update-subcategory/${a}`,{isActive:n})).data,onSuccess:()=>{f.success("Subcategory status updated!"),r.invalidateQueries({queryKey:["sub-category"]})},onError:a=>{f.error(a?.response?.data?.error||a?.message||"Failed to update subcategory status")}})},O=({isOpen:r,onClose:a,categories:n,isCategoriesLoading:o,onSubmit:x})=>{const[l,c]=i.useState(""),[u,m]=i.useState(""),[g,p]=i.useState(null),[h,d]=i.useState(!1);i.useEffect(()=>{r||(c(""),m(""),p(null),d(!1))},[r]);const j=async s=>{if(s.preventDefault(),!l||!u){alert("Please fill all required fields");return}d(!0),await x({name:l,category:u,image:g||void 0}),d(!1),a()};return e.jsx(b,{appear:!0,show:r,as:i.Fragment,children:e.jsxs(v,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(b.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(b.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(v.Panel,{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(v.Title,{className:"text-lg font-semibold",children:"Add New Subcategory"}),e.jsx("button",{type:"button",onClick:a,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(z,{size:20})})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subcategory Name"}),e.jsx("input",{type:"text",value:l,onChange:s=>c(s.target.value),placeholder:"Enter subcategory name",className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),o?e.jsx("p",{className:"text-gray-500 text-sm",children:"Loading categories..."}):e.jsxs("select",{value:u,onChange:s=>m(s.target.value),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),n.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subcategory Image (Optional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>p(s.target.files?.[0]||null),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500"}),g&&e.jsx("img",{src:URL.createObjectURL(g),alt:"Preview",className:"w-20 h-20 object-cover rounded-lg mt-2 border"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 rounded-lg text-white bg-pink-600 hover:bg-pink-700 transition",children:"Add Subcategory"})]})]})]})})})]})})},W=()=>{const[r,a]=i.useState(""),[n,o]=i.useState(!1),{data:x,isLoading:l}=L(),{data:c,isLoading:u,refetch:m}=I(r),{mutateAsync:g}=K(),{mutateAsync:p}=M(),{pageNumber:h,pageSizeValue:d,handlePageChange:j,handlePageSizeChange:s}=P();if(l||u)return e.jsx(F,{});const k=async t=>{await g(t),o(!1),m()},A=async(t,y)=>{await p({id:t,isActive:!y}),m()};return e.jsxs(N.div,{className:"p-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-2 sm:gap-4 mb-4",children:[e.jsxs("select",{value:r,onChange:t=>a(t.target.value),className:"border rounded-md p-2 focus:ring-2 focus:ring-orange-400 outline-none w-full sm:w-auto",children:[e.jsx("option",{value:"",children:"All Categories"}),x?.results.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]}),e.jsx(N.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>o(!0),className:"bg-orange-200 hover:bg-orange-700 text-black px-4 py-2 rounded-lg font-medium transition",children:"+ Add Subcategory"})]}),e.jsx("div",{className:"overflow-x-auto max-h-[400px] rounded-lg shadow-sm",children:e.jsxs("table",{className:"min-w-full text-sm bg-white",children:[e.jsx("thead",{className:"bg-orange-100 text-gray-800 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(q,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{children:"S.No"})]})}),e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(E,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{children:"Image"})]})}),e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(_,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{children:"Name"})]})}),e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(D,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Active"})]})})]})}),e.jsx("tbody",{children:c?.results.map((t,y)=>e.jsxs(N.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:y*.05},className:"border-b hover:bg-gray-50 transition text-center",children:[e.jsx("td",{className:"p-3",children:(h-1)*d+(y+1)}),e.jsx("td",{className:"p-3",children:t.image?e.jsx("img",{src:t.image,alt:t.name,className:"w-12 h-12 object-cover rounded-md border mx-auto"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center text-gray-500 text-xs mx-auto",children:"No Image"})}),e.jsx("td",{className:"p-3 font-medium text-gray-800",children:t.name}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>A(t._id,t.isActive??!1),className:`relative w-11 h-6 rounded-full overflow-hidden transition-all duration-500 ease-in-out
      ${t.isActive?"bg-green-500":"bg-gray-300"} cursor-pointer`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transform transition-all duration-500 ease-in-out
        ${t.isActive?"translate-x-[20px]":"translate-x-0"}`})})})]},t._id))})]})}),c?.pagination&&e.jsx(T,{currentPage:h,handlePageChange:j,pageSize:d,handlePageSizeChange:s,totalCount:c.pagination.total}),e.jsx(O,{isOpen:n,onClose:()=>o(!1),categories:x?.results??[],isCategoriesLoading:!!l,onSubmit:k})]})};export{W as default};
