import{o as v,m as w,z as f,k as C,a as r,j as e,s as S}from"./index.1CbKXVec.js";import{u as k,a as A}from"./useCreateProduct.Bg9ggRT7.js";import{u as F,P as L}from"./usePagination.DBnjr7Ov.js";import{X as I}from"./x.DoIBlp4-.js";import{K as y}from"./transition.R8uNngye.js";import{h as b}from"./dialog.BPAf0H9O.js";import{H as P}from"./hash.CH7VhsAP.js";import{I as z,T}from"./tag.tCx9I-76.js";import{C as q}from"./circle-check-big.pjSSW5R6.js";const D=()=>{const n=v();return w({mutationFn:async s=>{const l=new FormData;return l.append("name",s.name),l.append("category",s.category),l.append("image",s.image),(await C.post("/subcategory",l,{headers:{"Content-Type":"multipart/form-data"}})).data},onSuccess:()=>{f.success("Subcategory created successfully!"),n.invalidateQueries({queryKey:["sub-category"]})},onError:s=>{f.error(s?.response?.data?.error||s?.message||"Failed to create subcategory")}})},E=({isOpen:n,onClose:s,categories:l,isCategoriesLoading:i,onSubmit:x})=>{const[o,c]=r.useState(""),[d,p]=r.useState(""),[m,u]=r.useState(null),[h,g]=r.useState(!1);r.useEffect(()=>{n||(c(""),p(""),u(null),g(!1))},[n]);const j=async t=>{if(t.preventDefault(),!o||!d){alert("Please fill all required fields");return}g(!0),await x({name:o,category:d,image:m||void 0}),g(!1),s()};return e.jsx(y,{appear:!0,show:n,as:r.Fragment,children:e.jsxs(b,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(y.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(y.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(b.Panel,{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(b.Title,{className:"text-lg font-semibold",children:"Add New Subcategory"}),e.jsx("button",{type:"button",onClick:s,className:"rounded-full p-1 hover:bg-gray-100",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subcategory Name"}),e.jsx("input",{type:"text",value:o,onChange:t=>c(t.target.value),placeholder:"Enter subcategory name",className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category"}),i?e.jsx("p",{className:"text-gray-500 text-sm",children:"Loading categories..."}):e.jsxs("select",{value:d,onChange:t=>p(t.target.value),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Category"}),l.map(t=>e.jsx("option",{value:t._id,children:t.name},t._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Subcategory Image (Optional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:t=>u(t.target.files?.[0]||null),className:"w-full border rounded-lg px-3 py-2 outline-none focus:ring-2 focus:ring-pink-500"}),m&&e.jsx("img",{src:URL.createObjectURL(m),alt:"Preview",className:"w-20 h-20 object-cover rounded-lg mt-2 border"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 rounded-lg text-white bg-pink-600 hover:bg-pink-700 transition",children:"Add Subcategory"})]})]})]})})})]})})},V=()=>{const[n,s]=r.useState(""),[l,i]=r.useState(!1),{data:x,isLoading:o}=k(),{data:c,isLoading:d,refetch:p}=A(n),{mutateAsync:m}=D(),{pageNumber:u,pageSizeValue:h,handlePageChange:g,handlePageSizeChange:j}=F();if(o||d)return e.jsx(S,{});const t=async a=>{await m(a),i(!1),p()};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("select",{value:n,onChange:a=>s(a.target.value),className:"border rounded-md p-2",children:[e.jsx("option",{value:"",children:"All Categories"}),x?.results.map(a=>e.jsx("option",{value:a._id,children:a.name},a._id))]}),e.jsx("button",{onClick:()=>i(!0),className:"bg-orange-200 text-black px-4 py-2 rounded-md hover:bg-orange-700",children:"+ Add Subcategory"})]}),e.jsx("div",{className:"overflow-x-auto max-h-[400px] rounded-lg shadow-sm",children:e.jsxs("table",{className:"min-w-full text-sm bg-white",children:[e.jsx("thead",{className:"bg-orange-100 text-black-800 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(P,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{children:"S.No"})]})}),e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(z,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{children:"Image"})]})}),e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(T,{className:"w-4 h-4 text-gray-700"}),e.jsx("span",{children:"Name"})]})}),e.jsx("th",{className:"p-3 text-center font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(q,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"Active"})]})})]})}),e.jsx("tbody",{children:c?.results.map((a,N)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 transition text-center",children:[e.jsx("td",{className:"p-3",children:(u-1)*h+(N+1)}),e.jsx("td",{className:"p-3",children:a.image?e.jsx("img",{src:a.image,alt:a.name,className:"w-12 h-12 object-cover rounded-md border mx-auto"}):e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center text-gray-500 text-xs mx-auto",children:"No Image"})}),e.jsx("td",{className:"p-3 font-medium text-gray-800",children:a.name}),e.jsx("td",{className:"p-3",children:e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.isActive,readOnly:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-all relative",children:e.jsx("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transform peer-checked:translate-x-5 transition"})})]})})]},a._id))})]})}),c?.pagination&&e.jsx(L,{currentPage:u,handlePageChange:g,pageSize:h,handlePageSizeChange:j,totalCount:c.pagination.total}),e.jsx(E,{isOpen:l,onClose:()=>i(!1),categories:x?.results??[],isCategoriesLoading:o,onSubmit:t})]})};export{V as default};
