import{n as S,o as k,A as R,a as _,p as C,r as y,K as U,D as I,j as e,m as j,i as F,b as M,g as $,V as m,F as L}from"./index.D_2yFTP8.js";import{L as Y,b as V,g as z,a as W}from"./user.BXbmnPQV.js";const D=async s=>(await k.post("/register",s)).data,B=()=>S({mutationFn:D,onSuccess:s=>{console.log("Registration success:",s)},onError:s=>{var l;console.error("Registration error:",((l=s==null?void 0:s.response)==null?void 0:l.data)||s.message)}}),K=async s=>(await k.post("/register/verify-otp",s)).data,X=()=>S({mutationFn:K,onSuccess:s=>{console.log("✅ OTP verified:",s)},onError:s=>{var l;console.error("❌ OTP verification failed:",((l=s==null?void 0:s.response)==null?void 0:l.data)||s.message)}}),u=$(),G=F[u==null?void 0:u.reseller_name]||M,x=({delay:s=0,inside:l=!1,variant:g="small"})=>{let c=0,o=1;switch(g){case"small":c=Math.random()*6+4,o=1;break;case"medium":c=Math.random()*12+8,o=2;break;case"large":c=Math.random()*20+16,o=4;break}const f=Math.random()*100,i=Math.random()*100;return e.jsx(j.div,{initial:{opacity:0,x:"-10vw",y:0},animate:{opacity:[0,1,0],x:["-5vw","5vw","0vw"],y:["0vh","10vh","-5vh"]},transition:{duration:6,repeat:1/0,delay:s,ease:"easeInOut"},className:`absolute rounded-full shadow-lg ${l?"opacity-60":"opacity-40"}`,style:{width:c,height:c,top:`${i}%`,left:`${f}%`,background:"radial-gradient(circle, #FFD700, #FF8C00)",filter:`blur(${o}px)`}})},Q=()=>{const s=R(),{register:l,handleSubmit:g,watch:c,formState:{errors:o}}=_(),{login:f}=C(),[i,A]=y.useState(null),[h,T]=y.useState(!1),w=B(),v=X(),E=U(),N=w.isPending||v.isPending;y.useEffect(()=>{I()&&s("/")},[]);const q=async t=>{var a;try{if(!t.password){m.error("Password is required");return}if(i){const d=V(),[r,p]=await Promise.all([z(),W()]);if(!r||!p)return m.error("Failed to get location.");if(!t.emailOtp||!t.mobileOtp){m.error("Please enter both OTPs.");return}const b={user_id:i,emailOtp:t.emailOtp,mobileOtp:t.mobileOtp,device_id:d,latitude:r,longitude:p},n=await v.mutateAsync(b);L(n.token),f(n),m.success(n.message),s("/login")}else{const d={email:t.email,password:t.password,role:t.role,mobile:t.mobile,fullName:t.fullName},r=await w.mutateAsync(d);A(r.user_id),m.success("OTP sent to email and WhatsApp!")}}catch(d){const r=(a=d==null?void 0:d.response)==null?void 0:a.data;m.error(Array.isArray(r==null?void 0:r.error)?r.error.join(" "):(r==null?void 0:r.message)||(r==null?void 0:r.error)||"Request failed.")}},P=t=>{const a=c("email"),d=c("mobile"),r=t==="email"?"Check Your Email OTP Sent Successfully!":"Check Your WhatsApp OTP Sent Successfully!",p=t==="email"?{email:a}:{mobile:d};E.mutate(p,{onSuccess:()=>m.success(r),onError:b=>{var O;const n=(O=b.response)==null?void 0:O.data;m.error((n==null?void 0:n.message)||(n==null?void 0:n.error))}})};return e.jsxs("div",{className:"relative min-h-screen flex items-center justify-center bg-gradient-to-b from-[#123C82] to-[#0D2B2F] px-4 overflow-hidden",children:[Array.from({length:15}).map((t,a)=>e.jsx(x,{delay:a*.6,variant:"small"},`bg-${a}`)),Array.from({length:5}).map((t,a)=>e.jsx(x,{delay:a*1.2,variant:"medium"},`bg-mid-${a}`)),Array.from({length:3}).map((t,a)=>e.jsx(x,{delay:a*2,variant:"large"},`bg-big-${a}`)),e.jsxs(j.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"relative flex flex-col md:flex-row w-full max-w-6xl rounded-2xl shadow-2xl overflow-hidden border border-gray-200 bg-white",children:[e.jsxs("div",{className:"hidden md:flex md:w-1/2 flex-col justify-between p-10 relative bg-gradient-to-b from-blue-50 to-gray-100 rounded-l-2xl overflow-hidden",children:[Array.from({length:8}).map((t,a)=>e.jsx(x,{delay:a*.5,inside:!0},`left-${a}`)),e.jsxs("div",{className:"absolute top-6 left-6 flex items-center gap-2 z-20",children:[e.jsx("img",{src:G,alt:"Company Logo",className:"w-10 h-10 rounded-lg shadow-md"}),e.jsx("span",{className:"text-lg font-bold text-[#123C82] tracking-wide",children:(u==null?void 0:u.reseller_name)||""})]}),e.jsxs("div",{className:"flex flex-col items-center text-center gap-4 relative z-10 mt-10",children:[e.jsx("img",{src:Y,alt:"Illustration",className:"w-full max-w-sm h-auto object-contain rounded-xl"}),e.jsx("h2",{className:"text-2xl font-bold text-[#123C82]",children:"Welcome to Your Secure Dashboard"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed max-w-md",children:"Create your account, verify your OTP, and manage all your transactions securely and efficiently."})]})]}),e.jsxs("div",{className:"relative w-full md:w-1/2 bg-white p-10 rounded-r-2xl overflow-hidden",children:[Array.from({length:10}).map((t,a)=>e.jsx(x,{delay:a*.4,inside:!0},`form-${a}`)),e.jsx("h2",{className:"text-3xl font-bold text-center text-[#123C82]",children:i?"Verify OTP":"Sign Up"}),e.jsx("p",{className:"text-center text-gray-500 mb-6 text-sm",children:"Securely create your merchant account and manage payments with ease."}),e.jsxs("form",{onSubmit:g(q),className:"space-y-5 relative z-10",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Full Name *"}),e.jsx("input",{type:"text",placeholder:"Enter your full name",...l("fullName",{required:"Name is required"}),disabled:!!i,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none"}),o.fullName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.fullName.message})]}),!i&&e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Password *"}),e.jsx("input",{type:h?"text":"password",placeholder:"Create your password",...l("password",{required:"Password is required"}),disabled:!!i,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none"}),e.jsx("span",{onClick:()=>T(!h),className:"material-symbols-outlined absolute right-3 top-8.5 text-gray-500 cursor-pointer",children:h?"visibility_off":"visibility"}),o.password&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.password.message})]}),!i&&e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Role *"}),e.jsxs("select",{...l("role",{required:"Role is required"}),disabled:!!i,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none",children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"API_USER",children:"API User"}),e.jsx("option",{value:"APP_USER",children:"App User"}),e.jsx("option",{value:"PAYOUT_API_USER",children:"Payout API User"}),e.jsx("option",{value:"PAYOUT_APP_USER",children:"Payout App User"})]}),o.role&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.role.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email *"}),e.jsx("input",{type:"email",placeholder:"Enter your email",...l("email",{required:"Email is required"}),disabled:!!i,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none"}),o.email&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Mobile *"}),e.jsx("input",{type:"text",placeholder:"Enter your mobile number",...l("mobile",{required:"Mobile is required"}),disabled:!!i,className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none"}),o.mobile&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:o.mobile.message})]}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Email OTP *"}),e.jsx("input",{type:"text",...l("emailOtp",{required:"Email OTP is required"}),placeholder:"Enter email OTP",className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none"}),e.jsx("button",{type:"button",className:"text-xs text-[#185e91] mt-1 hover:underline",onClick:()=>P("email"),children:"Resend OTP"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:"Mobile OTP *"}),e.jsx("input",{type:"text",...l("mobileOtp",{required:"Mobile OTP is required"}),placeholder:"Enter mobile OTP",className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-[#185e91] outline-none"}),e.jsx("button",{type:"button",className:"text-xs text-[#185e91] mt-1 hover:underline",onClick:()=>P("mobile"),children:"Resend OTP"})]})]}),e.jsx(j.button,{type:"submit",whileTap:{scale:.97},disabled:N,className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition",children:N?"Processing...":i?"Verify OTP":"Sign Up"})]}),e.jsxs("p",{className:"text-center text-sm mt-6 text-gray-600",children:["Already have an account?"," ",e.jsx("button",{onClick:()=>s("/login"),className:"text-[#185e91] hover:underline font-medium",children:"Login"})]})]})]})]})};export{Q as default};
