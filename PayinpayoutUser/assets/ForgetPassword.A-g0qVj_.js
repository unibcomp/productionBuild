import{A as q,r as n,a as V,K as k,M as F,O as $,j as e,m,P as M,Q as A,V as o}from"./index.DZx2rFBx.js";const u=["Send OTP","Verify OTP","Reset Password"],R=()=>{const x=q(),[s,p]=n.useState(0),[c,w]=n.useState(null),[g,j]=n.useState(!1),[l,N]=n.useState(null),{register:d,handleSubmit:v,formState:{errors:r,isSubmitting:h}}=V(),{mutateAsync:P}=k(),{mutateAsync:O}=F(),{mutateAsync:S}=$(),T=async t=>{var b,f;const a=t.emailOrMobile.trim(),y=a.includes("@")?"email":"mobile";try{if(s===0){const i=await P({[y]:a});w(y),N(i.user_id),p(1),o.success("OTP sent successfully")}else if(s===1){if(!t.otp||!c||!l)return;await O({user_id:l,[`${c}Otp`]:t.otp}),j(!0),p(2),o.success("OTP verified")}else if(s===2){if(!t.newPassword||!l)return;await S({user_id:l,newPassword:t.newPassword}),o.success("Password changed successfully"),x("/login")}}catch(i){const E=((f=(b=i==null?void 0:i.response)==null?void 0:b.data)==null?void 0:f.message)||"Something went wrong";o.error(E)}};return e.jsx(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},className:"min-h-screen flex items-center justify-center bg-gradient-to-r from-[#101F33] to-[#0D2B2F] px-4",children:e.jsxs(m.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:"relative w-full max-w-md bg-[#1a2c33] text-white border border-[#2a3e4c] shadow-2xl rounded-xl overflow-hidden",children:[e.jsx(M,{title:"Forgot Password",searchComponent:e.jsx(e.Fragment,{})}),e.jsxs("div",{className:"p-6 md:p-8 space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-[10%] right-[10%] h-1 bg-gray-600 z-0 rounded-full",children:e.jsx("div",{className:"h-1 bg-green-500 rounded-full transition-all duration-500",style:{width:`${s/(u.length-1)*100}%`}})}),e.jsx("div",{className:"flex justify-between relative z-10",children:u.map((t,a)=>e.jsxs("div",{className:"flex flex-col items-center",style:{width:`${80/u.length}%`},children:[e.jsx("div",{className:`w-8 h-8 flex items-center justify-center rounded-full text-sm font-bold ${a===s?"bg-cyan-500":a<s?"bg-green-500":"bg-gray-600 text-gray-300"} text-white`,children:a+1}),e.jsx("p",{className:`text-xs mt-1 ${a===s?"text-cyan-300":"text-gray-400"}`,children:t})]},t))})]}),e.jsxs("form",{onSubmit:v(T),className:"space-y-6 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200",children:"Email or Mobile"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-3 text-gray-500 text-lg",children:"person"}),e.jsx("input",{type:"text",placeholder:"Enter your email or mobile",...d("emailOrMobile",{required:"Email or mobile is required"}),className:"pl-10 pr-4 py-3 w-full rounded-md bg-white text-gray-900 placeholder-gray-500 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none transition",disabled:s!==0})]}),r.emailOrMobile&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:r.emailOrMobile.message})]}),s>=1&&e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200",children:"Enter OTP"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-3 text-gray-500 text-lg",children:"vpn_key"}),e.jsx("input",{type:"text",placeholder:`Enter ${c} OTP`,...d("otp",{required:"OTP is required"}),className:`pl-10 pr-4 py-3 w-full rounded-md ${g?"bg-green-100 border-green-500 text-green-700":"bg-white text-gray-900"} placeholder-gray-500 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none transition`,disabled:s!==1}),g&&e.jsx("span",{className:"absolute right-3 top-3 text-green-500 text-sm font-semibold",children:"Verified"})]}),r.otp&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:r.otp.message})]}),s===2&&e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-3 text-gray-500 text-lg",children:"lock"}),e.jsx("input",{type:"password",placeholder:"Enter new password",...d("newPassword",{required:"New password is required"}),className:"pl-10 pr-4 py-3 w-full rounded-md bg-white text-gray-900 placeholder-gray-500 border border-gray-300 focus:ring-2 focus:ring-[#185e91] focus:outline-none transition"})]}),r.newPassword&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:r.newPassword.message})]}),e.jsx(m.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:h,className:"w-full py-3 bg-[#185e91] hover:bg-[#144e7a] text-white font-semibold rounded-md transition",children:h?"Processing...":s===0?"Send OTP":s===1?"Verify OTP":"Save Password"}),e.jsx("div",{className:"text-right text-sm pt-2",children:e.jsx("button",{type:"button",onClick:()=>x("/login"),className:"text-gray-300 hover:text-cyan-400 font-medium transition",children:"Back to Login"})})]})]}),e.jsx(A,{})]})})};export{R as default};
