import{u as w,a as M,r as P,j as e,L as q,V as u,i as _,b as A,g as $}from"./index.JRmaLDge.js";import{u as k,a as E}from"./useCreateAndGetPaymentLink.BV78tNed.js";const c=$(),S=_[c==null?void 0:c.reseller_name]||A,L=[500,1e3,2e3,5e3,1e4,1e5],F=()=>{const[h]=w(),a=h.get("payment_session_id"),{data:o,isLoading:N,isError:j}=k(a||""),s=o==null?void 0:o.data,{register:l,handleSubmit:y,formState:{errors:n},setValue:f,reset:m}=M(),d=E();P.useEffect(()=>{o&&m({customerName:(s==null?void 0:s.customerName)||"",mobile:(s==null?void 0:s.PhoneNumber)||"",amount:0,paymentMethod:(s==null?void 0:s.paymentMetod)||""})},[o,m]);const v=t=>{if(!a){console.error("Missing payment_session_id");return}const i={amount:t.amount,payment_session_id:a,paymentMethod:t.paymentMethod,user_name:t==null?void 0:t.user_name,phone_number:t==null?void 0:t.phone_number,email_id:t==null?void 0:t.email_id,pin_code:t==null?void 0:t.pin_code};d.mutate(i,{onSuccess:r=>{u.success("payment request completed succesFully"),window.open(r.url,"_self")},onError:r=>{var b,x,p,g;u.error(((x=(b=r==null?void 0:r.response)==null?void 0:b.data)==null?void 0:x.message)||((g=(p=r==null?void 0:r.response)==null?void 0:p.data)==null?void 0:g.error)||"Something went wrong")}}),m(t)};return N?e.jsx(q,{}):j?(u.error("Failed to fetch payment data."),e.jsx("div",{className:"text-center text-red-600 font-semibold mt-20",children:"Something went wrong while loading the payment form."})):e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-4xl border-2 border-gray-300 rounded-2xl p-6 sm:p-8 shadow-sm relative bg-white",children:[e.jsx("div",{className:"absolute -top-8 left-6",children:e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden shadow-md border-4 border-white bg-white",children:e.jsx("img",{src:S,alt:"Reseller Logo",className:"w-full h-full object-cover"})})}),e.jsx("h2",{className:"text-2xl font-bold text-blue-700 mb-6 text-center mt-4 sm:mt-0",children:"Payment Details"}),e.jsxs("form",{onSubmit:y(v),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5 ",children:[e.jsxs("div",{className:"hidden",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"tel",...l("mobile",{required:"Mobile number is required",pattern:{value:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),disabled:!!(s!=null&&s.PhoneNumber),className:`w-full px-4 py-2 rounded-xl border ${n.mobile?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),n.mobile&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.mobile.message})]}),e.jsxs("div",{className:"hidden",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Customer Name"}),e.jsx("input",{type:"text",disabled:!!(s!=null&&s.customerName),...l("customerName",{required:"Customer name is required",pattern:{value:/^[A-Za-z\s]+$/,message:"Only alphabetic characters are allowed"}}),onInput:t=>{const i=t.target.value.replace(/[^A-Za-z\s]/g,"");t.target.value=i},className:`w-full px-4 py-2 rounded-xl border ${n.customerName?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),n.customerName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.customerName.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Full Name (as per PAN/Aadhaar)"}),e.jsx("input",{type:"text",...l("user_name",{required:" userName is required",pattern:{value:/^[A-Za-z\s]+$/,message:"Only alphabetic characters are allowed"}}),className:`w-full px-4 py-2 rounded-xl border ${n.user_name?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`,onInput:t=>{const i=t.target.value.replace(/[^A-Za-z\s]/g,"");t.target.value=i}}),n.user_name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.user_name.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"number",...l("phone_number",{required:" phone_number is required",pattern:{value:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),className:`w-full px-4 py-2 rounded-xl border ${n.phone_number?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),n.phone_number&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.phone_number.message})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Email Id"}),e.jsx("input",{type:"text",...l("email_id",{required:"Email id is required!",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/,message:"Enter a valid email address"}}),className:`w-full px-4 py-2 rounded-xl border ${n.email_id?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),n.email_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.email_id.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Pin Code (Valid Area Code)"}),e.jsx("input",{type:"text",inputMode:"numeric",maxLength:6,...l("pin_code",{required:"Pin code is required",pattern:{value:/^[1-9][0-9]{5}$/,message:"Enter a valid 6-digit Indian pin code"}}),className:`w-full px-4 py-2 rounded-xl border ${n.pin_code?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),n.pin_code&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.pin_code.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Payment Method"}),e.jsx("select",{...l("paymentMethod",{required:"Payment method is required"}),defaultValue:(s==null?void 0:s.paymentMetod)||"",className:`w-full px-4 py-2 rounded-xl border ${n.paymentMethod?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:(s==null?void 0:s.paymentMetod)==="ALL"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"Select Payment Method"}),e.jsx("option",{value:"upi",children:"UPI"}),e.jsx("option",{value:"CARD",children:"Card"}),e.jsx("option",{value:"netBanking",children:"Netbanking"}),e.jsx("option",{value:"wallet",children:"Wallet"})]}):e.jsx("option",{value:s==null?void 0:s.paymentMetod,children:s==null?void 0:s.paymentMetod})}),n.paymentMethod&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.paymentMethod.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",...l("amount",{required:"Amount is required",valueAsNumber:!0,min:{value:1,message:"Amount must be at least 1"}}),className:`w-full px-4 py-2 rounded-xl border ${n.amount?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),n.amount&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:n.amount.message})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:L.map(t=>e.jsxs("button",{type:"button",onClick:()=>f("amount",t),className:"px-4 py-1 rounded-full border border-blue-500 text-blue-500 hover:bg-blue-500 hover:text-white transition",children:["â‚¹",t.toLocaleString()]},t))})]}),e.jsx("button",{type:"submit",disabled:d==null?void 0:d.isPending,className:"mt-12 w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-xl shadow transition-all",children:"Submit Payment"})]})]})})};export{F as default};
