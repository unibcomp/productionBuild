import{n as w,o as P,r as g,a as A,A as T,p as R,D as U,M as F,j as e,m as h,P as _,F as C,V as c,G as M}from"./index.GJVPyu1U.js";import{b as I,g as V,a as Y}from"./user.BiIEwEb1.js";const D=async s=>(await P.post("/register",s)).data,L=()=>w({mutationFn:D,onSuccess:s=>{console.log("Registration success:",s)},onError:s=>{var l;console.error("Registration error:",((l=s==null?void 0:s.response)==null?void 0:l.data)||s.message)}}),z=async s=>(await P.post("/register/verify-otp",s)).data,H=()=>w({mutationFn:z,onSuccess:s=>{console.log("✅ OTP verified:",s)},onError:s=>{var l;console.error("❌ OTP verification failed:",((l=s==null?void 0:s.response)==null?void 0:l.data)||s.message)}}),G=()=>{const[s,l]=g.useState(null),{register:n,handleSubmit:O,watch:b,formState:{errors:t}}=A(),u=T(),{login:k}=R();g.useEffect(()=>{U()&&u("/")},[]);const y=L(),S=F(),f=H(),[p,E]=g.useState(!1),j=y.isPending||f.isPending,q=async r=>{var d;try{if(s){const o=I(),[a,m]=await Promise.all([V(),Y()]);if(!a||!m)return c.error("Failed to get location.");const x={user_id:s,emailOtp:r.emailOtp,mobileOtp:r.mobileOtp,device_id:o,latitude:a,longitude:m},i=await f.mutateAsync(x);M(i.token),k(i),c.success(i.message),u("/login")}else{const o=await y.mutateAsync({...r});l(o.user_id),c.success("OTP sent to email and WhatsApp!")}}catch(o){const a=(d=o==null?void 0:o.response)==null?void 0:d.data;c.error(Array.isArray(a.error)?a.error.join(" "):(a==null?void 0:a.message)||(a==null?void 0:a.error)||a.error.join(" ")||"Request failed.")}},v=r=>{const d=b("email"),o=b("mobile"),a=r==="email"?"Check Your Email otp Send SuccessFully!":"Check Your Whatsapp Otp Send SuccessFully",m=r==="email"?{email:d}:{mobile:o};S.mutate(m,{onSuccess:()=>{c.success(a)},onError:x=>{var N;const i=(N=x.response)==null?void 0:N.data;c.error((i==null?void 0:i.message)||(i==null?void 0:i.error))}})};return e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.6},className:"min-h-screen flex items-center justify-center bg-gradient-to-r from-[#101F33] to-[#0D2B2F] px-4",children:e.jsxs(h.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:"relative w-full sm:w-[90%] md:w-[70%] max-w-4xl bg-[#1a2c33] text-white border border-[#2a3e4c] shadow-2xl rounded-xl",children:[e.jsx(_,{title:"Create Account",searchComponent:e.jsx(e.Fragment,{})}),e.jsxs("div",{className:"p-6 md:p-8 space-y-6",children:[e.jsxs("form",{onSubmit:O(q),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Full Name"}),e.jsx("input",{type:"text",...n("fullName",{required:"Name is required"}),placeholder:"Enter your name",disabled:!!s,className:"w-full py-3 px-4 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 disabled:opacity-80"}),t.fullName&&e.jsx("p",{className:"text-red-400 text-sm",children:t.fullName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",...n("password",{required:"Password is required"}),placeholder:"Create a password",disabled:!!s,className:"w-full py-3 px-4 pr-12 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 disabled:opacity-80"}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 cursor-pointer",onClick:()=>E(!p),children:p?"visibility_off":"visibility"})]}),t.password&&e.jsx("p",{className:"text-red-400 text-sm",children:t.password.message})]}),e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Role"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{...n("role",{required:"Role is required"}),disabled:!!s,className:"w-full py-3 px-4 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-cyan-500 appearance-none disabled:opacity-80 relative z-20",children:[e.jsx("option",{value:"",children:"Select role"}),e.jsx("option",{value:"API_USER",children:"API User"}),e.jsx("option",{value:"APP_USER",children:"App User"}),e.jsx("option",{value:"PAYOUT_API_USER",children:"Payout Api User"}),e.jsx("option",{value:"PAYOUT_APP_USER",children:"Payout App User"})]}),e.jsx("span",{className:"material-symbols-outlined absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 pointer-events-none z-100 bg-redß",children:"expand_more"})]}),t.role&&e.jsx("p",{className:"text-red-400 text-sm",children:t.role.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Email"}),e.jsx("input",{type:"email",...n("email",{required:"Email is required"}),disabled:!!s,placeholder:"Enter your email",className:"w-full py-3 px-4 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 disabled:opacity-80"}),t.email&&e.jsx("p",{className:"text-red-400 text-sm",children:t.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Mobile"}),e.jsx("input",{type:"text",...n("mobile",{required:"Mobile is required"}),disabled:!!s,placeholder:"Enter your mobile number",className:"w-full py-3 px-4 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 disabled:opacity-80"}),t.mobile&&e.jsx("p",{className:"text-red-400 text-sm",children:t.mobile.message})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Email OTP"}),e.jsx("input",{type:"text",...n("emailOtp",{required:"Email OTP is required"}),placeholder:"Enter email OTP",className:"w-full py-3 px-4 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),t.emailOtp&&e.jsx("p",{className:"text-red-400 text-sm",children:t.emailOtp.message}),e.jsx("button",{type:"button",onClick:()=>v("email"),className:"mt-2 text-xs text-cyan-400 hover:underline focus:outline-none",children:"Resend OTP"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-1 text-sm font-medium text-gray-200 hidden md:block",children:"Mobile OTP"}),e.jsx("input",{type:"text",...n("mobileOtp",{required:"Mobile OTP is required"}),placeholder:"Enter mobile OTP",className:"w-full py-3 px-4 rounded-lg bg-white text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-cyan-500"}),t.mobileOtp&&e.jsx("p",{className:"text-red-400 text-sm",children:t.mobileOtp.message}),e.jsx("button",{type:"button",onClick:()=>v("mobile"),className:"mt-2 text-xs text-cyan-400 hover:underline focus:outline-none",children:"Resend OTP"})]})]})]}),e.jsx(h.button,{type:"submit",whileHover:{scale:1.03},whileTap:{scale:.97},disabled:j,className:"w-full py-3 bg-[#185e91] hover:bg-[#1b6ca8] transition text-white font-semibold rounded-lg",children:j?"Processing...":s?"Verify OTP":"Sign Up"})]}),!s&&e.jsx("div",{className:"text-right text-sm pt-4",children:e.jsx("button",{onClick:()=>u("/login"),className:"text-gray-300 hover:text-cyan-400 font-medium transition",children:"Already have an account?"})})]}),e.jsx(C,{})]})})};export{G as default};
