import{a as v,j as e,z as g,r as b,c as u,V as y,d as f,e as k,f as P,m as N,h as L,P as w,S as C,B as S,L as A,N as M,k as q}from"./index.DgsIRFPb.js";import{b as z,c as F}from"./useCreateAndGetPaymentLink.npNOUeCZ.js";function V({isOpen:l,closeModal:s,refetch:r}){const{register:i,handleSubmit:x,reset:p,formState:{errors:a,isSubmitting:t}}=v(),o=z(),c=d=>{console.log("Payment Link Data:",d),o.mutate(d,{onSuccess:()=>{r(),y.success("Payment Link Created SuccesFully"),s(),p()},onError:m=>{var j;const n=(j=m.response)==null?void 0:j.data,h=(n==null?void 0:n.message)||(n==null?void 0:n.error);y.error(Array.isArray(h)?h.join(","):h)}})};return e.jsx(g,{appear:!0,show:l,as:b.Fragment,children:e.jsxs(u,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(g.Child,{as:b.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-150",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs(u.Panel,{className:"w-full max-w-md transform overflow-hidden rounded bg-white p-6 shadow-xl transition-all",children:[e.jsx(u.Title,{className:"text-lg font-medium text-gray-900 mb-4",children:"Create Payment Link"}),e.jsxs("form",{onSubmit:x(c),className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsxs("select",{...i("paymentMetod",{required:"Please select a payment method"}),className:"input",children:[e.jsx("option",{value:"",children:"Select method"}),e.jsx("option",{value:"ALL",children:"ALL"}),e.jsx("option",{value:"UPI",children:"UPI"}),e.jsx("option",{value:"Master",children:"Mater Card"}),e.jsx("option",{value:"VISA",children:"Visa Card"})]}),a.paymentMetod&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.paymentMetod.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),e.jsx("input",{type:"text",...i("customerName",{required:"Customer name is required"}),className:"input"}),a.customerName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.customerName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"text",maxLength:10,...i("PhoneNumber",{required:"Mobile number is required",pattern:{value:/^[6-9]\d{9}$/,message:"Invalid mobile number"}}),className:"input"}),a.PhoneNumber&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.PhoneNumber.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expire At"}),e.jsx("input",{type:"datetime-local",maxLength:10,...i("expireAt",{required:"expireAt is required"}),className:"input"}),a.expireAt&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.expireAt.message})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-2",children:[e.jsx("button",{type:"button",onClick:s,className:"rounded border border-gray-300 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:`rounded px-4 py-2 text-sm text-white ${t?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:t?"Creating...":"Create Link"})]})]})]})})})]})})}const Q=()=>{var m,n;const{handlePageSizeChange:l,pageNumber:s,pageSizeValue:r}=f(),{isModalOpen:i,openModal:x,closeModal:p}=k(),{setSearchQuery:a}=P(),{data:t,isError:o,isLoading:c,refetch:d}=F({pageNumber:s,pageSize:r});return e.jsxs(N.div,{className:"bg-gradient-to-br from-slate-100 to-indigo-100 shadow-lg rounded-2xl p-2",variants:L,initial:"hidden",animate:"visible",children:[e.jsx(w,{title:"Payment Link",searchComponent:e.jsxs(e.Fragment,{children:[e.jsx(C,{handlePageSizeChange:l,pageSizeOptions:[10,20,30],pageSize:r,setSearchQuery:a}),e.jsx(S,{buttons:[{label:"Create Payment Link",onClick:()=>x({isPaymentLink:!0},{}),variant:"primary"}]})]})}),e.jsxs("div",{className:"custom-scroll h-[72vh] overflow-auto",children:[e.jsxs("table",{className:"min-w-full text-sm text-left text-gray-700 bg-transparent",children:[e.jsx("thead",{className:"bg-gray-100 border-b text-xs uppercase text-gray-500 sticky top-0 z-40",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"S.N"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Customer Name"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Phone Number"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Link"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"QR Code"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Payment Method"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-nowrap",children:"Created At"})]})}),!c&&!o&&((m=t==null?void 0:t.data)==null?void 0:m.length)>0&&e.jsx(I,{data:t.data})]}),c?e.jsx(A,{}):o||((n=t==null?void 0:t.data)==null?void 0:n.length)===0?e.jsx(M,{}):null]}),e.jsx(V,{isOpen:!!i.isPaymentLink,closeModal:()=>p({isPaymentLink:!1}),refetch:d})]})},I=({data:l})=>e.jsx("tbody",{className:"custom-scroll",children:l.map((s,r)=>e.jsxs(N.tr,{className:"hover:bg-gray-50 transition-all duration-150",variants:q,initial:"hidden",animate:"visible",custom:r,children:[e.jsx("td",{className:"px-4 py-3 font-bold",children:r+1}),e.jsx("td",{className:"px-4 py-3",children:s.customerName}),e.jsx("td",{className:"px-4 py-3",children:s.PhoneNumber}),e.jsx("td",{className:"px-4 py-3 ",children:e.jsxs("div",{className:"max-w-xs truncate flex items-center gap-2",children:[e.jsx("span",{className:"truncate",children:s.paymentLink}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(s.paymentLink),y.success("Link copied to clipboard!")},className:"text-blue-600 hover:text-blue-800 hover:cursor-pointer",title:"Copy Link",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"content_copy"})})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-center gap-3",children:s!=null&&s.qrcodelink?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:s.qrcodelink,alt:"QR Code",className:"w-20 h-20 object-contain border rounded",title:"QR Code Preview"}),e.jsx("a",{href:s.qrcodelink,download:`qrcode-${s.id||"file"}.png`,className:"text-green-600 hover:text-green-800",title:"Download QR Code",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"download"})})]}):e.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gray-100 text-sm text-gray-400 rounded",children:"N/A"})})}),e.jsx("td",{className:"px-4 py-3 capitalize",children:s.paymentMetod}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${s.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:new Date(s.createdAt).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"})})]},r))});export{Q as default};
