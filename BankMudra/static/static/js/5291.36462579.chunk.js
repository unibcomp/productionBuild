"use strict";(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[5291],{65291:(e,i,o)=>{o.r(i),o.d(i,{default:()=>T});var r=o(65043),t=o(73216),l=o(67784),n=o(94516),a=o(67254),d=o(94496),s=o(39336),c=o(68903),u=o(27108),v=o(11906),x=o(90035),p=o(83625),h=o(24056),m=o(12110),b=o(26494),g=o(26600),y=o(35316),A=o(51787),j=o(29347),f=o(17555),C=o(73575),S=o(72777),w=o(8751),I=o(54358),P=(o(91036),o(35717)),k=o(74802),R=o(17392),L=o(70579);const M=e=>(0,L.jsx)(l.A,{variant:"outlined",size:"small",fullWidth:!0,sx:{"& .MuiInputLabel-root":{color:"var(--bs-primary2)"},"& .MuiOutlinedInput-root":{height:42,"& input, & textarea":{color:"var(--bs-primary2) !important"},"& fieldset":{borderColor:"var(--bs-primary2)"},"&:hover fieldset":{borderColor:"var(--bs-primary1)"},"&.Mui-focused fieldset":{borderColor:"var(--bs-primary1)"}}},InputLabelProps:{shrink:!0},...e}),z=e=>{let{children:i}=e;return(0,L.jsx)(n.A,{sx:{width:"100%",mx:"auto",my:1,px:3,py:4,pb:6,backgroundColor:"var(--bs-primary3)",color:"var(--bs-primary2)"},children:i})},T=e=>{var i,o,l;let{walletCall:T}=e;const E=(0,t.Zp)(),{serviceId:W}=(0,t.g)(),[N,D]=(0,r.useState)(!1),[F,O]=(0,r.useState)([]),[B,_]=(0,r.useState)(""),[q,H]=(0,r.useState)(null),[V,G]=(0,r.useState)({}),[U,Y]=(0,r.useState)({}),[$,K]=(0,r.useState)(null),[Q,X]=(0,r.useState)(""),[Z,J]=(0,r.useState)(!1),[ee,ie]=(0,r.useState)(),[oe,re]=(0,r.useState)(""),[te,le]=(0,r.useState)(!1),[ne,ae]=(0,r.useState)(""),de=(0,r.useRef)(!1),[se,ce]=(0,r.useState)(!1),[ue,ve]=(0,r.useState)(!1),[xe,pe]=(0,r.useState)(!1),[he,me]=(0,r.useState)([]),[be,ge]=(0,r.useState)(null),[ye,Ae]=(0,r.useState)(null),[je,fe]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(!W)return void _("Invalid service ID");(async()=>{D(!0),ce(!1),ve(!1);try{var e;const u=await(0,C.SxK)(W);var i,o,r,t,l,n,a,d,s,c;if(null!==u&&void 0!==u&&null!==(e=u.data)&&void 0!==e&&e.error)_("Failed to fetch operator data");else O((null===u||void 0===u||null===(i=u.data)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.Operator)||[]),H(null),ge(null),ae(null===u||void 0===u||null===(r=u.data)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.service),"Mobile Recharge"===(null===u||void 0===u||null===(l=u.data)||void 0===l||null===(n=l.data)||void 0===n||null===(a=n.service)||void 0===a?void 0:a.service_name)&&ce(!0),"DTH"===(null===u||void 0===u||null===(d=u.data)||void 0===d||null===(s=d.data)||void 0===s||null===(c=s.service)||void 0===c?void 0:c.service_name)&&ve(!0)}catch{_("Something went wrong while fetching operators")}finally{D(!1)}})(),Ie()}),[W]);(0,r.useEffect)((()=>{se&&Ce()}),[se]);const Ce=async()=>{try{var e;let i=await(0,C.gvC)();me((null===i||void 0===i||null===(e=i.data)||void 0===e?void 0:e.data)||[])}catch(B){me([])}},Se=(0,w.A)((async(e,i)=>{if(!de.current){D(!0),_(""),Ae(null),J(!1),de.current=!0;try{const c={opretorId:null===q||void 0===q?void 0:q.operatorid,state:(null===be||void 0===be?void 0:be.circle)||"ALL INDIA",latitude:e,longitude:i};try{var o,r,t;let e=await(0,C.$Qv)(c);var l;if(200===(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.statusCode))Ae(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.data),J(!1),fe(!0);(0,I.A)(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.error,null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)}catch(B){var n,a,d,s;(0,I.A)(null===B||void 0===B||null===(n=B.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.error,null===B||void 0===B||null===(d=B.data)||void 0===d||null===(s=d.data)||void 0===s?void 0:s.message)}}catch(B){}finally{D(!1),de.current=!1}}})),we=(0,w.A)((async(e,i)=>{D(!0);const o={billerId:null===q||void 0===q?void 0:q.operatorid,telecomCircle:"",inputParameters:V,latitude:String(e).slice(0,7),longitude:String(i).slice(0,7),amount:Q,enquiryReferenceId:oe,tpin:ee};se&&(o.telecomCircle=null===be||void 0===be?void 0:be.circleCode);try{var r,t,l;let e=await(0,C.Fy)(o);var n,a;if(!1===(null===e||void 0===e||null===(r=e.data)||void 0===r?void 0:r.error))Ie(),T(),ke(),E("/bill-invoice/".concat(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.id));ie(""),(0,I.A)(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error,null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.message)}catch(B){}finally{D(!1)}})),Ie=()=>{G({}),Y({}),K(null),X(""),J(!1),_(""),Ae(null)},Pe=()=>{var e;return null===q||void 0===q||null===(e=q.customerParams)||void 0===e?void 0:e.every((e=>{if("Amount"===e.desc)return!0;const i=V[e.name]||"";return(!e.regex||new RegExp(e.regex).test(i))&&i.length>=e.minLength}))},ke=()=>{le(!1),ie("")},Re=[...null!==ye&&void 0!==ye&&ye.plans?Object.keys(null===ye||void 0===ye?void 0:ye.plans):[],...null!==ye&&void 0!==ye&&ye.offerPlan?Object.keys(null===ye||void 0===ye?void 0:ye.offerPlan):[]],Le={...(null===ye||void 0===ye?void 0:ye.plans)||{},...(null===ye||void 0===ye?void 0:ye.offerPlan)||{}},[Me,ze]=(0,r.useState)(0);return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(n.A,{sx:{background:"var(--bs-primary3)",color:"var(--bs-primary2)",backgroundSize:"cover",minHeight:"100vh",padding:2},children:(0,L.jsxs)(n.A,{p:.5,maxWidth:"620px",m:"auto",position:"relative",zIndex:1,children:[N&&(0,L.jsx)(S.A,{}),B&&(0,L.jsx)(a.A,{severity:"error",sx:{mb:2},children:B}),(0,L.jsxs)(z,{children:[(0,L.jsxs)(n.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,L.jsxs)(n.A,{display:"flex",alignItems:"center",gap:1,children:[(null===ne||void 0===ne?void 0:ne.icon)&&(0,L.jsx)("img",{src:(0,P.q)(null===ne||void 0===ne?void 0:ne.icon),alt:"Service Icon",width:30,height:30,style:{objectFit:"contain"},onError:e=>{e.currentTarget.src="/bbpslogo.png"}}),(0,L.jsx)(d.A,{variant:"h6",gutterBottom:!0,mt:1,fontSize:18,children:null===ne||void 0===ne?void 0:ne.service_name})]}),(0,L.jsx)(n.A,{children:(0,L.jsx)("img",{src:"/bbpslogo.png",alt:"BBPS Logo",width:90})})]}),(0,L.jsx)(s.A,{sx:{mb:2}}),(0,L.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,L.jsx)(c.Ay,{item:!0,xs:12,children:(0,L.jsx)(u.A,{options:F,getOptionLabel:e=>e.name,value:q,disabled:Z,onChange:(e,i)=>{H(i);let o="MANDATORY"===(null===i||void 0===i?void 0:i.fetchRequirement);pe(o),Ie()},fullWidth:!0,renderOption:(e,i)=>(0,r.createElement)("li",{...e,key:i._id},(0,L.jsxs)(n.A,{component:"div",sx:{fontSize:"13px",color:"var(--bs-nav)"},display:"flex",columnGap:1.5,alignItems:"center",children:[(0,L.jsx)("img",{src:null===i||void 0===i?void 0:i.logo_url,alt:"Service Icon",width:20,height:20,style:{objectFit:"contain"},onError:e=>{e.currentTarget.src="/bbpslogo.png"}}),i.name]})),renderInput:e=>(0,L.jsx)(M,{...e,label:"Select Operator",fullWidth:!0,InputLabelProps:{sx:{"&.MuiInputLabel-root:not(.MuiInputLabel-shrink)":{top:"-6px"}}}})})}),q&&se&&(0,L.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(u.A,{options:he,getOptionLabel:e=>e.circle,value:be,onChange:(e,i)=>{ge(i)},disabled:Z,fullWidth:!0,renderOption:(e,i)=>(0,L.jsx)("li",{...e,children:(0,L.jsx)(n.A,{component:"span",sx:{fontSize:"13px",color:"var(--bs-primary2)"},children:i.circle})}),renderInput:e=>(0,L.jsx)(M,{...e,label:"Select Circle",fullWidth:!0,InputLabelProps:{sx:{"&.MuiInputLabel-root:not(.MuiInputLabel-shrink)":{top:"-6px"}}}})})}),null===q||void 0===q||null===(i=q.customerParams)||void 0===i?void 0:i.map((e=>(0,L.jsx)(c.Ay,{item:!0,xs:12,sm:6,sx:{display:"Amount"===e.desc?"none":"block"},children:(0,L.jsx)(M,{label:e.desc,type:"Amount"===e.desc?"hidden":"text",value:V[e.name]||"",inputProps:{maxLength:e.maxLength,minLength:e.minLength,inputMode:"NUMERIC"===e.inputType?"numeric":"text"},onChange:i=>((e,i)=>{var o;const r=null===q||void 0===q||null===(o=q.customerParams)||void 0===o?void 0:o.find((i=>i.name===e));"Amount"!==(null===r||void 0===r?void 0:r.desc)?(G((o=>({...o,[e]:i}))),null!==r&&void 0!==r&&r.regex&&!new RegExp(r.regex).test(i)?Y((i=>({...i,[e]:"Invalid input"}))):Y((i=>({...i,[e]:""})))):G((o=>({...o,[e]:i})))})(e.name,i.target.value),error:!!U[e.name],helperText:U[e.name],disabled:Z})},e.name))),q&&!xe&&(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(c.Ay,{item:!0,xs:12,sm:12,children:(0,L.jsxs)(n.A,{sx:{position:"relative"},children:[(0,L.jsx)(M,{label:"Amount to Pay (\u20b9)",value:Q,type:"number",disabled:se,onChange:e=>X(e.target.value)}),(!xe&&ue||se)&&(0,L.jsx)(n.A,{sx:{position:"absolute",right:"10px",top:"10px",cursor:"pointer",backgroundColor:"var(--bs-primary3)",color:"var(--bs-primary2)","&:hover":{backgroundColor:"var(--bs-primary1)"},"&.Mui-disabled":{backgroundColor:"rgba(0,0,0,0.12)",color:"var(--bs-primary2)",opacity:.6}},onClick:Se,children:(0,L.jsx)("p",{style:{fontSize:"12px",cursor:"pointer"},children:"View Plans"})})]})}),(0,L.jsx)(c.Ay,{container:!0,item:!0,sx:12,justifyContent:"center",children:(0,L.jsxs)(v.A,{variant:"contained",disabled:!q||Q<9||!Pe(),onClick:async()=>{!xe||ue?await(async()=>{D(!0),_(""),re(""),K(null),J(!1);try{var e,i,o;let a={...V};"SUND00000NAT02"===(null===q||void 0===q?void 0:q.operatorid)&&(a.param2=Q);const d={billerId:null===q||void 0===q?void 0:q.operatorid,inputParameters:a};xe||(d.transactionAmount=Q);const s=await(0,C.zCS)(d),c=null===s||void 0===s||null===(e=s.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.billerResponse;var r,t,l,n;!0===(null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.error)?(0,I.A)(null===(r=s.data)||void 0===r?void 0:r.error,null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.message):(K(c),le(!0),J(!1),re(null===s||void 0===s||null===(l=s.data)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.refId))}catch{_("Failed to fetch bill. Please try again.")}finally{D(!1)}})():le(!0)},sx:{width:250,backgroundColor:"var(--bs-primary3)",color:"var(--bs-primary2)",textTransform:"none",fontWeight:600,"&:hover":{backgroundColor:"var(--bs-primary1)"},"&.Mui-disabled":{backgroundColor:"rgba(0,0,0,0.12)",color:"var(--bs-primary2)",opacity:.6}},children:["Process to Pay ",Q]})})," "]}),q&&xe&&(0,L.jsx)(c.Ay,{container:!0,item:!0,sx:12,justifyContent:"center",children:(0,L.jsx)(v.A,{variant:"contained",color:"primary",disabled:!q||!Pe()||Z,onClick:async()=>{D(!0),_(""),re(""),K(null),J(!1);try{var e,i;const n={billerId:null===q||void 0===q?void 0:q.operatorid,inputParameters:V};xe||(n.transactionAmount=Q);const a=await(0,C.zCS)(n),d=null===a||void 0===a||null===(e=a.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.billerResponse;var o,r,t,l;if(d)K(d),X((null===d||void 0===d?void 0:d.BillAmount)||""),J(!0),re(null===a||void 0===a||null===(o=a.data)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.refId);else(0,I.A)(null===(t=a.data)||void 0===t?void 0:t.error,null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)}catch{_("Failed to fetch bill. Please try again.")}finally{D(!1)}},sx:{width:"250px",borderColor:"var(--bs-primary3) !important",backgroundColor:"var(--bs-primary1) !important",color:"var(--bs-primary2) !important"},children:"Fetch Bill"})})]})]}),Z&&$&&(0,L.jsxs)(z,{children:[(0,L.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:"Bill Details"}),(0,L.jsx)(s.A,{sx:{mb:2}}),(0,L.jsxs)(c.Ay,{container:!0,spacing:2,children:[null===(o=[...Array.isArray(null===$||void 0===$?void 0:$.CustomerParamsDetails)?$.CustomerParamsDetails:[],...Array.isArray(null===$||void 0===$?void 0:$.AdditionalDetails)?$.AdditionalDetails:[]])||void 0===o?void 0:o.map(((e,i)=>(0,L.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsxs)(n.A,{display:"flex",justifyContent:"space-between",border:"1px solid #eee",borderRadius:1,p:1,boxShadow:1,children:[(0,L.jsx)(d.A,{variant:"body2",color:"text.secondary",children:e.Name}),(0,L.jsx)(d.A,{variant:"body2",fontWeight:500,children:e.Value})]})},i))),(0,L.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsxs)(n.A,{display:"flex",justifyContent:"space-between",border:"1px solid #eee",borderRadius:1,p:1,boxShadow:1,children:[(0,L.jsx)(d.A,{variant:"body2",color:"text.secondary",children:"Customer Name"}),(0,L.jsx)(d.A,{variant:"body2",fontWeight:500,children:$.CustomerName})]})}),(0,L.jsx)(c.Ay,{item:!0,xs:12,sm:6,children:(0,L.jsx)(M,{label:"Amount to Pay (\u20b9)",value:Q,type:"number",onChange:e=>X(e.target.value)})}),(0,L.jsx)(c.Ay,{container:!0,item:!0,xs:12,justifyContent:"center",children:(0,L.jsxs)(v.A,{variant:"contained",color:"success",disabled:!Q,onClick:()=>le(!0),sx:{backgroundColor:"var(--bs-primary1)",borderColor:"var(--bs-primary1)",width:"250px"},children:["Pay \u20b9",Q||""]})})]})]})]})}),(0,L.jsxs)(x.A,{open:je,onClose:()=>fe(!1),PaperProps:{sx:()=>({borderRadius:4,p:2,backdropFilter:"blur(10px)",background:"white",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",width:"100%",maxWidth:800,overflow:0===(null===Re||void 0===Re?void 0:Re.length)?"hidden":"auto"})},children:[(0,L.jsx)(R.A,{onClick:()=>fe(!1),sx:{position:"absolute",top:8,right:8,zIndex:10,color:"#000",fontSize:"16px"},children:(0,L.jsx)(k.A,{})}),(0,L.jsxs)(z,{sx:{width:"100%",borderRadius:2},children:[(0,L.jsx)(p.A,{value:Me,onChange:(e,i)=>{ze(i)},variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,orientation:"horizontal",sx:{"& .MuiTabs-flexContainer":{gap:"8px"},"& .MuiTab-root":{fontSize:"14px",textTransform:"none",padding:"10px 16px",fontWeight:500,color:"var(--bs-nav)"},"& .MuiTab-root.Mui-selected":{color:"var(--bs-primary1)",fontWeight:"bold"},"& .MuiTabs-indicator":{backgroundColor:"var(--bs-primary1)",height:"2px",borderRadius:"2px"}},children:null===Re||void 0===Re?void 0:Re.map(((e,i)=>(0,L.jsx)(h.A,{label:e},i)))}),0===(null===Re||void 0===Re?void 0:Re.length)&&(0,L.jsxs)(n.A,{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,L.jsx)("img",{src:"/noplandata.png",style:{top:"50%"},width:100}),(0,L.jsx)(d.A,{component:"h4",children:"No Plan Found"})]}),(0,L.jsx)(n.A,{sx:{mt:2},children:(0,L.jsx)(d.A,{variant:"body1",color:"text.secondary",children:(0,L.jsx)(n.A,{sx:{mt:2},children:(0,L.jsx)(c.Ay,{container:!0,spacing:2,height:"600px",sx:{overflowY:"auto",overflowX:"hidden "},children:null===(l=Le[Re[Me]])||void 0===l?void 0:l.map(((e,i)=>(0,L.jsx)(c.Ay,{item:!0,xs:12,children:(0,L.jsx)(m.A,{elevation:1,onClick:()=>{return i=null===e||void 0===e?void 0:e.rs,X(i),void fe(!1);var i},sx:{borderRadius:3,transition:"transform 0.3s","&:hover":{transform:"scale(1.02)"},cursor:"pointer"},children:(0,L.jsxs)(b.A,{children:[(0,L.jsx)(n.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:(0,L.jsxs)(d.A,{variant:"h5",fontWeight:"bold",fontSize:16,children:["\u20b9",null===e||void 0===e?void 0:e.rs]})}),(0,L.jsx)(s.A,{sx:{my:1}}),(0,L.jsx)(n.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:(0,L.jsxs)(d.A,{variant:"body1",color:"text.secondary",fontSize:13,children:["Validity: ",null===e||void 0===e?void 0:e.validity]})}),(0,L.jsx)(n.A,{display:"flex",alignItems:"center",gap:1,children:(0,L.jsx)(d.A,{variant:"body2",fontSize:13,children:null===e||void 0===e?void 0:e.desc})})]})})},i)))})})})})]})]}),(0,L.jsxs)(x.A,{open:te,onClose:ke,PaperProps:{sx:{borderRadius:4,p:2,backdropFilter:"blur(10px)",background:"rgba(255, 255, 255, 0.9)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",width:"100%",maxWidth:400}},children:[(0,L.jsx)(g.A,{sx:{color:"var(--bs-primary1)",fontWeight:600,textAlign:"center",fontSize:"1.0rem"},children:"Enter TPIN"}),(0,L.jsxs)(y.A,{sx:{textAlign:"center"},children:[(0,L.jsx)(d.A,{sx:{color:"var(--bs-nav)",mb:.5},fontSize:14,children:"Please enter your 4-digit TPIN to continue."}),(0,L.jsx)(n.A,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,gap:1,children:(0,L.jsxs)(d.A,{variant:"h6",sx:{color:"var(--bs-nav)",mb:.5},fontSize:14,children:["Payable Amount: \u20b9",Q]})}),(0,L.jsx)(M,{label:"TPIN",type:"password",value:ee||"",onChange:e=>{const i=e.target.value;/^\d{0,4}$/.test(i)&&ie(i)},autoComplete:"off",inputProps:{inputMode:"numeric",maxLength:4},InputProps:{startAdornment:(0,L.jsx)(A.A,{position:"start",children:(0,L.jsx)(f.A,{})})},fullWidth:!0})]}),(0,L.jsxs)(j.A,{sx:{justifyContent:"center",mt:2},children:[(0,L.jsx)(v.A,{onClick:ke,color:"error",variant:"outlined",sx:{borderRadius:2,px:4,width:"150px"},children:"Cancel"}),(0,L.jsx)(v.A,{onClick:()=>{(null===ee||void 0===ee?void 0:ee.length)<4?alert("Please enter 4 digit TPIN"):we()},disabled:N,color:"primary",variant:"contained",sx:{backgroundColor:"var(--bs-primary1)",borderRadius:2,px:4,width:"150px"},children:"Submit"})]})]})]})}},35717:(e,i,o)=>{o.d(i,{q:()=>t});var r=o(94414);const t=e=>r.cu+(e||"")},89349:(e,i,o)=>{o.d(i,{g:()=>r});const r=()=>new Promise(((e,i)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((i=>{e({latitude:i.coords.latitude,longitude:i.coords.longitude})}),(e=>{e.code===e.PERMISSION_DENIED&&alert("Please Enable Location to Proceed"),i(e)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):i(new Error("Geolocation is not supported"))}))},54358:(e,i,o)=>{o.d(i,{A:()=>t});var r=o(91036);function t(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"something went wrong";!1===e?r.oR.success(i):r.oR.error(i)}},8751:(e,i,o)=>{o.d(i,{A:()=>t});var r=o(89349);const t=e=>async function(){try{let{latitude:l,longitude:n}=await(0,r.g)();if(!l||!n)return alert("Please Enable Location");for(var i=arguments.length,o=new Array(i),t=0;t<i;t++)o[t]=arguments[t];return await e(l,n,...o)}catch(l){console.error("Error fetching location:",l)}}}}]);
//# sourceMappingURL=5291.36462579.chunk.js.map