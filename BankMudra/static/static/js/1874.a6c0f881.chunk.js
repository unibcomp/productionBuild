"use strict";(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[1874],{11874:(e,n,t)=>{t.r(n),t.d(n,{default:()=>L});var r=t(89121),a=t(72777),i=t(65043),o=t(23546),l=t(17200),s=t(67784),d=t(94516),c=t(90035),u=t(26600),x=t(27108),h=t(51787),m=t(29347),p=t(11906),v=t(94496),b=t(53193),j=t(72221),g=t(91449),A=t(79650),y=t(71806),f=t(84882),k=t(28076),C=t(10039),w=t(73460),N=t(18356),S=t(59135),I=t(73575),W=t(80899),O=t(17555),M=t(71462),P=(t(58613),t(8751)),_=(t(91036),t(54358)),D=t(70579);const E={1:"Pending",2:"Success",3:"Failed",4:"Refund"},R={1:"btn btn-warning",2:"btn btn-success",3:"btn btn-danger",4:"btn btn-light",5:"btn btn-light"},q=e=>(0,D.jsx)(s.A,{variant:"outlined",size:"small",InputLabelProps:{shrink:!0},sx:{"& label.Mui-focused":{color:"var(--bs-nav)"},"& .MuiOutlinedInput-root":{height:40,"& .MuiOutlinedInput-input":{py:0},"&:hover fieldset":{borderColor:"var(--bs-primary1)"},"&.Mui-focused fieldset":{borderColor:"var(--bs-primary1)"}}},...e}),T=e=>{let{children:n}=e;return(0,D.jsx)(d.A,{sx:{width:"100%",mx:"auto",my:1,py:3,px:3,bgcolor:"white",borderRadius:1,boxShadow:0},children:n})},B=(W.Ik({mobile:W.Yj().matches(/^[6-9]\d{9}$/,"Invalid mobile number").required("Mobile number is required"),accountHolder:W.Yj().required("Account holder name is required"),accountNumber:W.Yj().matches(/^\d{9,18}$/,"Invalid account number").required("Account number is required"),confirmAccountNumber:W.Yj().oneOf([W.KR("accountNumber")],"Account numbers must match").required("Confirm account number is required"),bank:W.Ik().nullable().required("Select a bank"),ifsc:W.Yj().matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code").required("IFSC code is required"),profile:W.gl().required("Bank proof is required")}),e=>{var n,t,a,s,b,j;let{setResetKey:g}=e;const{popupOpen:A,setpopupOpen:y,walletData:f,setLoader:k,walletCall:C}=(0,r.P)(),[w,N]=(0,i.useState)([]),[S,W]=(0,i.useState)(1),[E,R]=(0,i.useState)({bank:null,amount:"",tpin:""}),[T,B]=(0,i.useState)({}),z=e=>(n,t)=>{const r="bank"===e?t:n.target.value;R((n=>({...n,[e]:r}))),T[e]&&B((n=>({...n,[e]:""})))},L=(0,P.A)((async(e,n)=>{var t;const r=E.tpin?/^\d{4}$/.test(E.tpin)?"":"TPIN must be 4 digits":"Enter TPIN";if(r)return void B((e=>({...e,tpin:r})));let a={bank_id:null===E||void 0===E||null===(t=E.bank)||void 0===t?void 0:t._id,latlong:"".concat(e,",").concat(n),txnMode:"imps",tpin:null===E||void 0===E?void 0:E.tpin,amount:null===E||void 0===E?void 0:E.amount};k(!0);try{var i,o,l,s;let e=await(0,I.o64)(a);if((0,_.A)(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.error,null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.message),200===(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.statusCode)&&(y(!1),g((e=>!e)),W(1),R({bank:null,amount:"",tpin:""}),C()),405===(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.statusCode))return void R((e=>({...e,tpin:""})))}catch(d){}finally{k(!1)}}));return(0,i.useEffect)((()=>{(async()=>{try{var e;const n=await(0,I.NO4)();N((null===n||void 0===n||null===(e=n.data)||void 0===e?void 0:e.data)||[])}catch(n){console.error("Bank list fetch failed:",n)}})()}),[]),(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(c.A,{open:A,onClose:()=>y(!1),PaperProps:{sx:()=>({borderRadius:4,paddingY:2,backdropFilter:"blur(10px)",background:"white",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",width:"100%",maxWidth:450})},children:(0,D.jsx)(o.N,{mode:"wait",children:1===S?(0,D.jsxs)(l.P.div,{initial:{opacity:0,x:-30},animate:{opacity:1,x:0},exit:{opacity:0,x:30},transition:{duration:.3},children:[(0,D.jsxs)(u.A,{sx:{color:"var(--bs-primary2)",fontWeight:600,textAlign:"center",fontSize:"1.0rem"},children:["Transfer Money into Bank Account",(0,D.jsx)("br",{}),"Your Cashback Wallet Balance is : ",null===f||void 0===f?void 0:f.cashback_wallet]}),(0,D.jsxs)(d.A,{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",mb:2,gap:1,sx:{px:2},children:[(0,D.jsx)(d.A,{sx:{maxWidth:380,width:"100%",mb:2},children:(0,D.jsx)(x.A,{options:w,getOptionLabel:e=>(null===e||void 0===e?void 0:e.bank_name)||"",value:E.bank,onChange:z("bank"),size:"small",renderOption:(e,n)=>(0,D.jsx)("li",{...e,children:(0,D.jsx)(d.A,{sx:{fontSize:"13px",color:"var(--bs-nav)"},children:n.bank_name})}),renderInput:e=>(0,D.jsx)(q,{...e,label:"Select Bank",error:Boolean(T.bank),helperText:T.bank,InputLabelProps:{sx:{"&.MuiInputLabel-root:not(.MuiInputLabel-shrink)":{top:"-3px"}}}})})}),(null===E||void 0===E||null===(n=E.bank)||void 0===n?void 0:n.bank_account_number)&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(d.A,{sx:{maxWidth:380,width:"100%",mb:2},children:(0,D.jsx)(q,{label:"Account Holder Name",name:"account holdernamer",type:"text",disabled:!0,value:(null===E||void 0===E||null===(t=E.bank)||void 0===t?void 0:t.bank_account_name)||"",fullWidth:!0})}),(0,D.jsx)(d.A,{sx:{maxWidth:380,width:"100%",mb:2},children:(0,D.jsx)(q,{label:"IFSC code",name:"IFSC code",type:"text",disabled:!0,value:(null===E||void 0===E||null===(a=E.bank)||void 0===a?void 0:a.bank_ifsc)||"",fullWidth:!0})}),(0,D.jsx)(d.A,{sx:{maxWidth:380,width:"100%",mb:2},children:(0,D.jsx)(q,{label:"Account Number",name:"account number",type:"number",disabled:!0,value:(null===E||void 0===E||null===(s=E.bank)||void 0===s?void 0:s.bank_account_number)||"",fullWidth:!0})})]}),(0,D.jsx)(d.A,{sx:{maxWidth:380,width:"100%"},children:(0,D.jsx)(q,{label:"Amount",name:"amt",type:"number",placeholder:"Enter Amount",value:E.amount,onChange:z("amount"),error:Boolean(T.amount),helperText:T.amount,autoComplete:"off",inputProps:{inputMode:"numeric",maxLength:10},InputProps:{startAdornment:(0,D.jsx)(h.A,{position:"start",children:(0,D.jsx)(M.A,{})})},fullWidth:!0})})]}),(0,D.jsx)(m.A,{sx:{justifyContent:"center",mt:2,columnGap:2},children:(0,D.jsxs)(d.A,{sx:{display:"flex",width:"100%",maxWidth:380,justifyContent:"space-between"},children:[(0,D.jsx)(d.A,{children:(0,D.jsx)(p.A,{onClick:()=>y(!1),color:"error",variant:"outlined",sx:{borderRadius:2,px:4,width:"150px"},children:"Cancel"})}),(0,D.jsx)(d.A,{children:(0,D.jsx)(p.A,{onClick:()=>{(()=>{const e={};E.bank||(e.bank="Select a bank");const n=Number(E.amount);return E.amount?Number.isNaN(n)||n<=99?e.amount="Minimum Amount is 100.":n>((null===f||void 0===f?void 0:f.cashback_wallet)||0)&&(e.amount="Amount exceeds wallet balance"):e.amount="Enter an amount",B(e),0===Object.keys(e).length})()&&W(2)},color:"primary",variant:"contained",sx:{backgroundColor:"var(--bs-primary2)",borderRadius:2,px:4,width:"150px"},children:"Continue"})})]})})]},"step1"):(0,D.jsxs)(l.P.div,{initial:{opacity:0,x:30},animate:{opacity:1,x:0},exit:{opacity:0,x:-30},transition:{duration:.3},children:[(0,D.jsx)(u.A,{sx:{color:"var(--bs-primary1)",fontWeight:600,textAlign:"center",fontSize:"1.3rem"},children:"Confirm Transfer"}),(0,D.jsxs)(d.A,{display:"flex",flexDirection:"column",alignItems:"center",gap:3,px:2,pb:2,children:[(0,D.jsxs)(v.A,{fontSize:"0.95rem",textAlign:"center",children:["Are you sure you want to transfer\xa0",(0,D.jsxs)("strong",{children:["\u20b9",E.amount]})," to\xa0",(0,D.jsxs)("p",{children:[(0,D.jsx)("strong",{children:null===E||void 0===E||null===(b=E.bank)||void 0===b?void 0:b.bank_name})," \xa0",(0,D.jsx)("strong",{children:null===E||void 0===E||null===(j=E.bank)||void 0===j?void 0:j.bank_account_number})," "]})]}),(0,D.jsx)(d.A,{sx:{maxWidth:380,width:"100%"},children:(0,D.jsx)(q,{label:"TPIN",type:"password",name:"tpin",placeholder:"Enter TPin",value:E.tpin,onChange:z("tpin"),error:Boolean(T.tpin),helperText:T.tpin,autoComplete:"new-password",inputProps:{inputMode:"numeric",maxLength:4},InputProps:{startAdornment:(0,D.jsx)(h.A,{position:"start",children:(0,D.jsx)(O.A,{})})},fullWidth:!0})})]}),(0,D.jsx)(m.A,{sx:{justifyContent:"center",mt:2,columnGap:2},children:(0,D.jsxs)(d.A,{sx:{display:"flex",width:"100%",maxWidth:380,justifyContent:"space-between"},children:[(0,D.jsx)(d.A,{children:(0,D.jsx)(p.A,{onClick:()=>{W(1),R((e=>({...e,tpin:""})))},color:"error",variant:"outlined",sx:{borderRadius:2,px:4,width:"150px"},children:"Back"})}),(0,D.jsx)(d.A,{children:(0,D.jsx)(p.A,{onClick:L,color:"primary",variant:"contained",sx:{backgroundColor:"var(--bs-primary1)",borderRadius:2,px:4,width:"150px"},children:"Confirm"})})]})})]},"step2")})})})}),z=()=>{var e;const n=(new Date).toISOString().split("T")[0],{popupOpen:t,setpopupOpen:a,loader:o,setLoader:l}=(0,r.P)(),[s,c]=(0,i.useState)(1),[u,x]=(0,i.useState)(10),[h,m]=(0,i.useState)(!1),[W,O]=(0,i.useState)(0),[M,P]=(0,i.useState)([]),[q,z]=(0,i.useState)({startDate:n,endDate:n,status:"",search:""}),L=e=>{const{name:n,value:t}=e.target;z((e=>({...e,[n]:t})))};(0,i.useEffect)((()=>{(async()=>{let e={page:s,count:u,start_date:q.startDate,end_date:q.endDate,status:q.status,search:q.search};try{var n;let o=await(0,I.icV)(e);var t,r,a,i;200===(null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.statusCode)?(P(null===o||void 0===o||null===(t=o.data)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.trans),O(null===o||void 0===o||null===(a=o.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.total)):(P([]),O(0))}catch(o){}})()}),[h,s,u]);const F=Math.ceil(W/u);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{className:"PageHeading",children:(0,D.jsx)("h1",{children:"Cashback Settlement"})}),(0,D.jsxs)(T,{children:[(0,D.jsx)(d.A,{justifyContent:"flex-end",display:"flex",children:(0,D.jsx)(p.A,{variant:"contained",color:"primary",onClick:()=>a(!0),sx:{borderColor:"var(--bs-primary1)",width:"200px",backgroundColor:"var(--bs-primary2)",color:"white"},children:"Make Settlement"})}),(0,D.jsxs)("div",{className:"card",children:[(0,D.jsx)("div",{className:"card-header",children:" "}),(0,D.jsx)("div",{className:"card-body",children:(0,D.jsx)("form",{children:(0,D.jsxs)("div",{className:"form-row",style:{alignItems:"end"},children:[(0,D.jsxs)("div",{className:"form-group col-md-4",children:[(0,D.jsx)("label",{children:"Start Date"}),(0,D.jsx)("input",{type:"date",name:"startDate",className:"form-control",value:q.startDate,onChange:L,max:n})]}),(0,D.jsxs)("div",{className:"form-group col-md-4",children:[(0,D.jsx)("label",{children:"End Date"}),(0,D.jsx)("input",{type:"date",name:"endDate",className:"form-control",value:q.endDate,onChange:L,max:n})]}),(0,D.jsxs)("div",{className:"form-group col-md-4",children:[(0,D.jsx)("label",{children:"Status"}),(0,D.jsx)(b.A,{fullWidth:!0,size:"small",children:(0,D.jsxs)(j.A,{value:(null===q||void 0===q?void 0:q.status)||"",name:"status",onChange:L,displayEmpty:!0,sx:{color:"rgba(0, 0, 0, 0.6)",fontSize:"14px","& .MuiOutlinedInput-notchedOutline":{borderColor:"grey.400"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"var(--bs-primary1)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"var(--bs-primary1)"}},children:[(0,D.jsx)(g.A,{value:"",disabled:!0,sx:{fontSize:"14px",color:"var(--bs-nav)",px:2},children:"Select Status"}),null===Object||void 0===Object||null===(e=Object.entries(E))||void 0===e?void 0:e.map((e=>{let[n,t]=e;return(0,D.jsx)(g.A,{value:n,sx:{fontSize:"14px",color:"var(--bs-nav)",px:2},children:t})}))]})})]}),(0,D.jsxs)("div",{className:"form-group col-md-4",children:[(0,D.jsx)("label",{children:"Txn Id / Account Number / Mobile No"}),(0,D.jsx)("input",{type:"text",name:"search",className:"form-control",value:q.search,onChange:L,placeholder:"Txn Id / Account Number / Mobile No"})]}),(0,D.jsx)("div",{className:"form-group col-md-12 col-lg-12",children:(0,D.jsxs)("div",{children:[(0,D.jsx)("button",{type:"button",className:"btn btn-secondary mr-3",onClick:()=>{m((e=>!e))},children:"Search"}),(0,D.jsx)("button",{type:"button",className:"btn btn-light",onClick:()=>{z({startDate:"",endDate:"",status:"",search:""}),c(1),x(10),m((e=>!e))},children:"Reset"})]})})]})})})]}),(0,D.jsx)(d.A,{sx:{my:2},children:(0,D.jsx)(A.A,{component:d.A,elevation:3,children:(0,D.jsxs)(y.A,{children:[(0,D.jsx)(f.A,{sx:{backgroundColor:"#f5f5f5"},children:(0,D.jsxs)(k.A,{children:[(0,D.jsx)(C.A,{children:(0,D.jsx)("strong",{children:"S.No."})}),(0,D.jsx)(C.A,{style:{minWidth:"180px"},children:(0,D.jsx)("strong",{children:" Date"})}),(0,D.jsx)(C.A,{style:{minWidth:"180px"},children:(0,D.jsx)("strong",{children:"Transaction Id"})}),(0,D.jsx)(C.A,{style:{minWidth:"180px"},children:(0,D.jsx)("strong",{children:"UTR Number"})}),(0,D.jsx)(C.A,{style:{minWidth:"180px"},children:(0,D.jsx)("strong",{children:"Bank Name"})}),(0,D.jsx)(C.A,{style:{minWidth:"120px"},children:(0,D.jsx)("strong",{children:"Account Number"})}),(0,D.jsx)(C.A,{style:{minWidth:"100px"},children:(0,D.jsx)("strong",{children:"Opening Balance"})}),(0,D.jsx)(C.A,{style:{minWidth:"60px"},children:(0,D.jsx)("strong",{children:"Charges"})}),(0,D.jsx)(C.A,{style:{minWidth:"100px"},children:(0,D.jsx)("strong",{children:"Amount"})}),(0,D.jsx)(C.A,{style:{minWidth:"120px"},children:(0,D.jsx)("strong",{children:"Closing Balance"})}),(0,D.jsx)(C.A,{style:{minWidth:"180px"},children:(0,D.jsx)("strong",{children:"Status"})}),(0,D.jsx)(C.A,{style:{minWidth:"180px"},children:(0,D.jsx)("strong",{children:"Enquiry"})})]})}),(0,D.jsxs)(w.A,{children:[null===M||void 0===M?void 0:M.map(((e,n)=>(0,D.jsxs)(k.A,{hover:!0,children:[(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:n+1+(s-1)*u}),(0,D.jsxs)(C.A,{sx:{color:"var(--bs-nav)"},children:[null===e||void 0===e?void 0:e.createdAt," "]}),(0,D.jsxs)(C.A,{sx:{color:"var(--bs-nav)"},children:[null===e||void 0===e?void 0:e.txn_id," "]}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:(null===e||void 0===e?void 0:e.utr)||"Not generated"}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:null===e||void 0===e?void 0:e.bank_name}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:null===e||void 0===e?void 0:e.account_number}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:null===e||void 0===e?void 0:e.o_bal}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:null===e||void 0===e?void 0:e.charge}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:null===e||void 0===e?void 0:e.amount}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:null===e||void 0===e?void 0:e.c_bal}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:(0,D.jsx)("button",{className:"btn ".concat(R[e.status]),style:{width:"130px"},children:E[null===e||void 0===e?void 0:e.status]||"unknown"})}),(0,D.jsx)(C.A,{sx:{color:"var(--bs-nav)"},children:(0,D.jsx)(p.A,{variant:"contained",color:"primary",disabled:o||1!==(null===e||void 0===e?void 0:e.status),onClick:()=>(async e=>{l(!0);try{var n,t;let r=await(0,I.pjy)(e);m((e=>!e)),(0,_.A)(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.error,null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message)}catch(r){}finally{l(!1)}})(null===e||void 0===e?void 0:e._id),sx:{borderColor:"var(--bs-primary1)",width:"150px",backgroundColor:"var(--bs-primary1)",color:"white"},children:"Enquiry"})})]},n))),0===(null===M||void 0===M?void 0:M.length)&&(0,D.jsx)(k.A,{children:(0,D.jsx)(C.A,{colSpan:8,align:"center",sx:{color:"gray"},children:"No data found"})})]})]})})}),(0,D.jsxs)(d.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,flexWrap:"wrap",gap:2,children:[(0,D.jsxs)(d.A,{display:"flex",alignItems:"center",gap:2,children:[(0,D.jsxs)(b.A,{size:"small",sx:{width:"150px"},children:[(0,D.jsx)(N.A,{children:"Rows per page"}),(0,D.jsx)(j.A,{value:u,onChange:e=>{x(Number(e.target.value)),c(1)},label:"Rows per page",sx:{fontSize:"14px","& .MuiOutlinedInput-notchedOutline":{borderColor:"#ccc"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"var(--bs-primary1)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"var(--bs-primary1)"}},children:[5,10,25,50].map((e=>(0,D.jsx)(g.A,{value:e,children:e},e)))})]}),(0,D.jsxs)(v.A,{variant:"body2",sx:{fontSize:"14px",color:"#555"},children:["Total Entries: ",W]})]}),(0,D.jsx)(S.A,{count:F,page:s,onChange:(e,n)=>{c(n)},shape:"rounded",showFirstButton:!0,showLastButton:!0,sx:{"& .MuiPaginationItem-root":{color:"var(--bs-primary1)",borderRadius:"8px"},"& .MuiPaginationItem-root.Mui-selected":{backgroundColor:"var(--bs-primary1)",color:"#fff",fontWeight:"bold","&:hover":{backgroundColor:"var(--bs-primary1)"}}}})]})]}),t&&(0,D.jsx)(B,{setResetKey:m})]})},L=()=>{const{currentPage:e,loader:n}=(0,r.P)();return(0,D.jsxs)(D.Fragment,{children:[n&&(0,D.jsx)(a.A,{}),""===e&&(0,D.jsx)(z,{})]})}},89349:(e,n,t)=>{t.d(n,{g:()=>r});const r=()=>new Promise(((e,n)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((n=>{e({latitude:n.coords.latitude,longitude:n.coords.longitude})}),(e=>{e.code===e.PERMISSION_DENIED&&alert("Please Enable Location to Proceed"),n(e)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):n(new Error("Geolocation is not supported"))}))},54358:(e,n,t)=>{t.d(n,{A:()=>a});var r=t(91036);function a(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"something went wrong";!1===e?r.oR.success(n):r.oR.error(n)}},8751:(e,n,t)=>{t.d(n,{A:()=>a});var r=t(89349);const a=e=>async function(){try{let{latitude:i,longitude:o}=await(0,r.g)();if(!i||!o)return alert("Please Enable Location");for(var n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return await e(i,o,...t)}catch(i){console.error("Error fetching location:",i)}}}}]);
//# sourceMappingURL=1874.a6c0f881.chunk.js.map