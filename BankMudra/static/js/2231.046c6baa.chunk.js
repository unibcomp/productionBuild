(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[2231],{69202:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var r=n(65043),o=n(73216),a=n(8738),i=n(71722),s=n(90434),c=n.n(s),l=n(86213),d=n(94414),p=n(70579);const u=()=>{const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(null),[u,f]=(0,r.useState)(!0),[h,g]=(0,r.useState)(""),[y,m]=(0,r.useState)(""),[w,A]=(0,r.useState)(""),[I,b]=(0,r.useState)(!1),[E,S]=(0,r.useState)(null),v=(0,a.En)();(0,o.Zp)();(0,r.useEffect)((()=>{(async()=>{try{const e=await fetch("https://api.ipify.org?format=json"),n=await e.json();t(n.ip);const r=await i.Ay.load(),o=await r.get();s(o.visitorId)}catch(E){console.error("Error fetching data:",E),S("Failed to fetch device information")}finally{f(!1)}})()}),[]);return u?(0,p.jsx)("div",{children:"Loading device information..."}):(0,p.jsxs)("div",{children:[(0,p.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),b(!0),S(null);try{if(!h||h.length<4)throw new Error("TPIN must be at least 4 digits long.");if(h!==y)throw new Error("TPIN and Confirm TPIN do not match.");const t=(e=>{if("string"!==typeof e||e.length<4)throw new Error("TPIN must be a string with at least 4 characters.");const t=parseInt(e,10);if(isNaN(t))throw new Error("TPIN must be a valid number.");return"PP@".concat(e.slice(0,2),"PS").concat(e.slice(2))})(h),r={tpin:h,cTpin:y,userId:window.localStorage.getItem("userToken"),deviceId:n||"Unknown",ipAddress:e||"Unknown",deviceType:a.uF?"Windows PC":a.Ue?"MacBook or iMac":a.m0?"Android Device":a.un?"iOS Device":a.v1?"Tablet":a.Fr?"Mobile Device":a.Bd?"Desktop Browser":"Unknown Device",device_info:JSON.stringify(v),long:"",lat:"",expiry_date:"",expiry_status:!0,fingerprint:n||"Unknown"},o=(e=>{if("string"!==typeof e||0===e.length)throw new Error("AES encryption failed: Input must be a non-empty string");const t=c().cipher.createCipher("AES-CBC",c().util.hexToBytes("03ab4a43059239fd13d75987d7dfafda51467e871b87bd3847f01474116d311c"));return t.start({iv:c().util.hexToBytes("3529f86c41ab1bb8b8f6d788cbb3f6f9")}),t.update(c().util.createBuffer(e)),t.finish(),t.output.toHex()})(JSON.stringify(r)),i=(e=>{if("string"!==typeof e||0===e.length)throw new Error("RSA encryption failed: Input must be a non-empty string");try{const t=c().pki.publicKeyFromPem("-----BEGIN PUBLIC KEY-----\nMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBBUuux5GAG/Fm9YoeGJeYr5qT6WFXga3/\npV935e83f01KK+1E/Av6myqwYsmqRG/FuCFeMyv+mlXGIKu5fO3+X18CAwEAAQ==\n-----END PUBLIC KEY-----\n").encrypt(e,"RSA-OAEP");return c().util.encode64(t)}catch(E){throw console.error("RSA encryption failed:",E),new Error("RSA encryption failed: ".concat(E.message))}})(t);console.log("rsaendata Response:",i);const s=await((e,t)=>l.A.post("".concat(d.pc,"tpin/addTpin"),e,{headers:{Authorization:"Bearer ".concat(window.localStorage.getItem("userToken")),rsaendata:t}}))({enData:o},i);console.log("API Response:",s.data);const p=(e=>{if("string"!==typeof e||0===e.length)throw new Error("RSA decryption failed: Input must be a non-empty string");try{return c().pki.privateKeyFromPem("-----BEGIN PRIVATE KEY-----\nMIIBVgIBADANBgkqhkiG9w0BAQEFAASCAUAwggE8AgEAAkEFS67HkYAb8Wb1ih4Y\nl5ivmpPpYVeBrf+lX3fl7zd/TUor7UT8C/qbKrBiyapEb8W4IV4zK/6aVcYgq7l8\n7f5fXwIDAQABAkECYINWbxgK8uOdKV7y+PD/OapU4m2t9tU+fMjLvAG0MZHt8y8N\nVwgmKSIKJhIJCJhi0yQ8OfktrXqR2WWPSB2KcQIhA4H1Vkwe1Yy+SxqYIV80kMIg\nleWhKjT0n9ulhPWR/sUpAiEBgn5BMwTzTYFJ2XQvanpLxm5NYKjm3ZtZbbDq6KfV\nSUcCIQGSBGHfcIqRGX0MagG+2wzYLLiPdwkrbj3Hm6IcQ4G5iQIgcUOay97Zho8r\nG0UHWEb6ye4tUvRso+kQ7ip4zTHSOaUCIQCPYrDcX7TBHjL8ymTorezbRm4AcT5l\nL2o97zb984pyGg==\n-----END PRIVATE KEY-----\n").decrypt(c().util.decode64(e),"RSA-OAEP")}catch(E){throw console.error("RSA decryption failed:",E),new Error("RSA decryption failed: ".concat(E.message))}})(i);console.log("Decrypted TPIN:",p)}catch(E){console.error("Error in handleSubmit:",E),S(E.message||"Failed to set TPIN. Please try again.")}finally{b(!1)}},children:[(0,p.jsx)("input",{type:"number",value:h,onChange:e=>g(e.target.value),placeholder:"Enter TPIN",maxLength:4}),(0,p.jsx)("input",{type:"number",value:y,onChange:e=>m(e.target.value),placeholder:"Confirm TPIN",maxLength:4}),(0,p.jsx)("button",{type:"submit",disabled:I,children:I?"Submitting...":"Submit"})]}),E&&(0,p.jsx)("p",{style:{color:"red"},children:E})]})}},50310:()=>{}}]);
//# sourceMappingURL=2231.046c6baa.chunk.js.map