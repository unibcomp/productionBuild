"use strict";(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[5291],{65291:(e,i,o)=>{o.r(i),o.d(i,{default:()=>E});var l=o(65043),t=o(73216),n=o(67784),r=o(94516),a=o(67254),d=o(94496),s=o(39336),u=o(68903),c=o(27108),v=o(11906),x=o(90035),p=o(83625),h=o(24056),m=o(12110),b=o(26494),g=o(26600),y=o(35316),A=o(51787),f=o(29347),j=o(17555),C=o(73575),S=o(72777),w=o(8751),I=o(54358),P=(o(91036),o(35717)),k=o(74802),R=o(17392),M=o(70579);const z=e=>(0,M.jsx)(n.A,{variant:"outlined",size:"small",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{height:42,"& .MuiOutlinedInput-input":{py:1},"&:hover fieldset":{borderColor:"var(--bs-primary1)"},"&.Mui-focused fieldset":{borderColor:"var(--bs-primary1)"}},"& label.Mui-focused":{color:"var(--bs-nav)"}},...e}),L=e=>{let{children:i}=e;return(0,M.jsx)(r.A,{sx:{width:"100%",mx:"auto",my:1,px:3,py:4,pb:6,bgcolor:"white",borderRadius:1,boxShadow:0},children:i})},E=e=>{var i,o,n;let{walletCall:E}=e;const T=(0,t.Zp)(),{serviceId:N}=(0,t.g)(),[W,D]=(0,l.useState)(!1),[F,O]=(0,l.useState)([]),[B,_]=(0,l.useState)(""),[q,H]=(0,l.useState)(null),[V,G]=(0,l.useState)({}),[U,Y]=(0,l.useState)({}),[$,K]=(0,l.useState)(null),[Q,X]=(0,l.useState)(""),[Z,J]=(0,l.useState)(!1),[ee,ie]=(0,l.useState)(),[oe,le]=(0,l.useState)(""),[te,ne]=(0,l.useState)(!1),[re,ae]=(0,l.useState)(""),de=(0,l.useRef)(!1),[se,ue]=(0,l.useState)(!1),[ce,ve]=(0,l.useState)(!1),[xe,pe]=(0,l.useState)(!1),[he,me]=(0,l.useState)([]),[be,ge]=(0,l.useState)(null),[ye,Ae]=(0,l.useState)(null),[fe,je]=(0,l.useState)(!1);(0,l.useEffect)((()=>{if(!N)return void _("Invalid service ID");(async()=>{D(!0),ue(!1),ve(!1);try{var e;const c=await(0,C.SxK)(N);var i,o,l,t,n,r,a,d,s,u;if(null!==c&&void 0!==c&&null!==(e=c.data)&&void 0!==e&&e.error)_("Failed to fetch operator data");else O((null===c||void 0===c||null===(i=c.data)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.Operator)||[]),H(null),ge(null),ae(null===c||void 0===c||null===(l=c.data)||void 0===l||null===(t=l.data)||void 0===t?void 0:t.service),"Mobile Recharge"===(null===c||void 0===c||null===(n=c.data)||void 0===n||null===(r=n.data)||void 0===r||null===(a=r.service)||void 0===a?void 0:a.service_name)&&ue(!0),"DTH"===(null===c||void 0===c||null===(d=c.data)||void 0===d||null===(s=d.data)||void 0===s||null===(u=s.service)||void 0===u?void 0:u.service_name)&&ve(!0)}catch{_("Something went wrong while fetching operators")}finally{D(!1)}})(),Ie()}),[N]);(0,l.useEffect)((()=>{se&&Ce()}),[se]);const Ce=async()=>{try{var e;let i=await(0,C.gvC)();me((null===i||void 0===i||null===(e=i.data)||void 0===e?void 0:e.data)||[])}catch(B){me([])}},Se=(0,w.A)((async(e,i)=>{if(!de.current){D(!0),_(""),Ae(null),J(!1),de.current=!0;try{const u={opretorId:null===q||void 0===q?void 0:q.operatorid,state:(null===be||void 0===be?void 0:be.circle)||"ALL INDIA",latitude:e,longitude:i};try{var o,l,t;let e=await(0,C.$Qv)(u);var n;if(200===(null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.statusCode))Ae(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data),J(!1),je(!0);(0,I.A)(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.error,null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)}catch(B){var r,a,d,s;(0,I.A)(null===B||void 0===B||null===(r=B.data)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.error,null===B||void 0===B||null===(d=B.data)||void 0===d||null===(s=d.data)||void 0===s?void 0:s.message)}}catch(B){}finally{D(!1),de.current=!1}}})),we=(0,w.A)((async(e,i)=>{D(!0);const o={billerId:null===q||void 0===q?void 0:q.operatorid,telecomCircle:"",inputParameters:V,latitude:String(e).slice(0,7),longitude:String(i).slice(0,7),amount:Q,enquiryReferenceId:oe,tpin:ee};se&&(o.telecomCircle=null===be||void 0===be?void 0:be.circleCode);try{var l,t,n;let e=await(0,C.Fy)(o);var r,a;if(!1===(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.error))Ie(),E(),ke(),T("/bill-invoice/".concat(null===e||void 0===e||null===(r=e.data)||void 0===r||null===(a=r.data)||void 0===a?void 0:a.id));ie(""),(0,I.A)(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error,null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.message)}catch(B){}finally{D(!1)}})),Ie=()=>{G({}),Y({}),K(null),X(""),J(!1),_(""),Ae(null)},Pe=()=>{var e;return null===q||void 0===q||null===(e=q.customerParams)||void 0===e?void 0:e.every((e=>{if("Amount"===e.desc)return!0;const i=V[e.name]||"";return(!e.regex||new RegExp(e.regex).test(i))&&i.length>=e.minLength}))},ke=()=>{ne(!1),ie("")},Re=[...null!==ye&&void 0!==ye&&ye.plans?Object.keys(null===ye||void 0===ye?void 0:ye.plans):[],...null!==ye&&void 0!==ye&&ye.offerPlan?Object.keys(null===ye||void 0===ye?void 0:ye.offerPlan):[]],Me={...(null===ye||void 0===ye?void 0:ye.plans)||{},...(null===ye||void 0===ye?void 0:ye.offerPlan)||{}},[ze,Le]=(0,l.useState)(0);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(r.A,{sx:{background:"linear-gradient(120deg, #fffaf5 0%, #e8efff 100%)",backgroundSize:"cover",minHeight:"100vh",padding:2},children:(0,M.jsxs)(r.A,{p:.5,maxWidth:"620px",m:"auto",position:"relative",zIndex:1,children:[W&&(0,M.jsx)(S.A,{}),B&&(0,M.jsx)(a.A,{severity:"error",sx:{mb:2},children:B}),(0,M.jsxs)(L,{children:[(0,M.jsxs)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,M.jsxs)(r.A,{display:"flex",alignItems:"center",gap:1,children:[(null===re||void 0===re?void 0:re.icon)&&(0,M.jsx)("img",{src:(0,P.q)(null===re||void 0===re?void 0:re.icon),alt:"Service Icon",width:30,height:30,style:{objectFit:"contain"},onError:e=>{e.currentTarget.src="/bbpslogo.png"}}),(0,M.jsx)(d.A,{variant:"h6",gutterBottom:!0,mt:1,fontSize:18,children:null===re||void 0===re?void 0:re.service_name})]}),(0,M.jsx)(r.A,{children:(0,M.jsx)("img",{src:"/bbpslogo.png",alt:"BBPS Logo",width:90})})]}),(0,M.jsx)(s.A,{sx:{mb:2}}),(0,M.jsxs)(u.Ay,{container:!0,spacing:2,children:[(0,M.jsx)(u.Ay,{item:!0,xs:12,children:(0,M.jsx)(c.A,{options:F,getOptionLabel:e=>e.name,value:q,disabled:Z,onChange:(e,i)=>{H(i);let o="MANDATORY"===(null===i||void 0===i?void 0:i.fetchRequirement);pe(o),Ie()},fullWidth:!0,renderOption:(e,i)=>(0,l.createElement)("li",{...e,key:i._id},(0,M.jsxs)(r.A,{component:"div",sx:{fontSize:"13px",color:"var(--bs-nav)"},display:"flex",columnGap:1.5,alignItems:"center",children:[(0,M.jsx)("img",{src:null===i||void 0===i?void 0:i.logo_url,alt:"Service Icon",width:20,height:20,style:{objectFit:"contain"},onError:e=>{e.currentTarget.src="/bbpslogo.png"}}),i.name]})),renderInput:e=>(0,M.jsx)(z,{...e,label:"Select Operator",fullWidth:!0,InputLabelProps:{sx:{"&.MuiInputLabel-root:not(.MuiInputLabel-shrink)":{top:"-6px"}}}})})}),q&&se&&(0,M.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,M.jsx)(c.A,{options:he,getOptionLabel:e=>e.circle,value:be,onChange:(e,i)=>{ge(i)},disabled:Z,fullWidth:!0,renderOption:(e,i)=>(0,M.jsx)("li",{...e,children:(0,M.jsx)(r.A,{component:"span",sx:{fontSize:"13px",color:"var(--bs-nav)"},children:i.circle})}),renderInput:e=>(0,M.jsx)(z,{...e,label:"Select Circle",fullWidth:!0,InputLabelProps:{sx:{"&.MuiInputLabel-root:not(.MuiInputLabel-shrink)":{top:"-6px"}}}})})}),null===q||void 0===q||null===(i=q.customerParams)||void 0===i?void 0:i.map((e=>(0,M.jsx)(u.Ay,{item:!0,xs:12,sm:6,sx:{display:"Amount"===e.desc?"none":"block"},children:(0,M.jsx)(z,{label:e.desc,type:"Amount"===e.desc?"hidden":"text",value:V[e.name]||"",inputProps:{maxLength:e.maxLength,minLength:e.minLength,inputMode:"NUMERIC"===e.inputType?"numeric":"text"},onChange:i=>((e,i)=>{var o;const l=null===q||void 0===q||null===(o=q.customerParams)||void 0===o?void 0:o.find((i=>i.name===e));"Amount"!==(null===l||void 0===l?void 0:l.desc)?(G((o=>({...o,[e]:i}))),null!==l&&void 0!==l&&l.regex&&!new RegExp(l.regex).test(i)?Y((i=>({...i,[e]:"Invalid input"}))):Y((i=>({...i,[e]:""})))):G((o=>({...o,[e]:i})))})(e.name,i.target.value),error:!!U[e.name],helperText:U[e.name],disabled:Z})},e.name))),q&&!xe&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(u.Ay,{item:!0,xs:12,sm:12,children:(0,M.jsxs)(r.A,{sx:{position:"relative"},children:[(0,M.jsx)(z,{label:"Amount to Pay (\u20b9)",value:Q,type:"number",disabled:se,onChange:e=>X(e.target.value)}),(!xe&&ce||se)&&(0,M.jsx)(r.A,{sx:{position:"absolute",right:"10px",top:"10px",cursor:"pointer"},onClick:Se,children:(0,M.jsx)("p",{style:{fontSize:"12px",cursor:"pointer"},children:"View Plans"})})]})}),(0,M.jsx)(u.Ay,{container:!0,item:!0,sx:12,justifyContent:"center",children:(0,M.jsxs)(v.A,{variant:"contained",color:"primary",disabled:!q||Q<9||!Pe(),onClick:async()=>{!xe||ce?await(async()=>{D(!0),_(""),le(""),K(null),J(!1);try{var e,i,o;let a={...V};"SUND00000NAT02"===(null===q||void 0===q?void 0:q.operatorid)&&(a.param2=Q);const d={billerId:null===q||void 0===q?void 0:q.operatorid,inputParameters:a};xe||(d.transactionAmount=Q);const s=await(0,C.zCS)(d),u=null===s||void 0===s||null===(e=s.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.billerResponse;var l,t,n,r;!0===(null===s||void 0===s||null===(o=s.data)||void 0===o?void 0:o.error)?(0,I.A)(null===(l=s.data)||void 0===l?void 0:l.error,null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.message):(K(u),ne(!0),J(!1),le(null===s||void 0===s||null===(n=s.data)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.refId))}catch{_("Failed to fetch bill. Please try again.")}finally{D(!1)}})():ne(!0)},sx:{width:"250px",borderColor:"var(--bs-primary1)",backgroundColor:"var(--bs-primary1)",color:"white"},children:["Process to Pay ",Q]})})," "]}),q&&xe&&(0,M.jsx)(u.Ay,{container:!0,item:!0,sx:12,justifyContent:"center",children:(0,M.jsx)(v.A,{variant:"contained",color:"primary",disabled:!q||!Pe()||Z,onClick:async()=>{D(!0),_(""),le(""),K(null),J(!1);try{var e,i;const r={billerId:null===q||void 0===q?void 0:q.operatorid,inputParameters:V};xe||(r.transactionAmount=Q);const a=await(0,C.zCS)(r),d=null===a||void 0===a||null===(e=a.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.billerResponse;var o,l,t,n;if(d)K(d),X((null===d||void 0===d?void 0:d.BillAmount)||""),J(!0),le(null===a||void 0===a||null===(o=a.data)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.refId);else(0,I.A)(null===(t=a.data)||void 0===t?void 0:t.error,null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)}catch{_("Failed to fetch bill. Please try again.")}finally{D(!1)}},sx:{width:"250px",borderColor:"var(--bs-primary1)",backgroundColor:"var(--bs-primary1)",color:"white"},children:"Fetch Bill"})})]})]}),Z&&$&&(0,M.jsxs)(L,{children:[(0,M.jsx)(d.A,{variant:"h6",gutterBottom:!0,children:"Bill Details"}),(0,M.jsx)(s.A,{sx:{mb:2}}),(0,M.jsxs)(u.Ay,{container:!0,spacing:2,children:[null===(o=[...Array.isArray(null===$||void 0===$?void 0:$.CustomerParamsDetails)?$.CustomerParamsDetails:[],...Array.isArray(null===$||void 0===$?void 0:$.AdditionalDetails)?$.AdditionalDetails:[]])||void 0===o?void 0:o.map(((e,i)=>(0,M.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,M.jsxs)(r.A,{display:"flex",justifyContent:"space-between",border:"1px solid #eee",borderRadius:1,p:1,boxShadow:1,children:[(0,M.jsx)(d.A,{variant:"body2",color:"text.secondary",children:e.Name}),(0,M.jsx)(d.A,{variant:"body2",fontWeight:500,children:e.Value})]})},i))),(0,M.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,M.jsxs)(r.A,{display:"flex",justifyContent:"space-between",border:"1px solid #eee",borderRadius:1,p:1,boxShadow:1,children:[(0,M.jsx)(d.A,{variant:"body2",color:"text.secondary",children:"Customer Name"}),(0,M.jsx)(d.A,{variant:"body2",fontWeight:500,children:$.CustomerName})]})}),(0,M.jsx)(u.Ay,{item:!0,xs:12,sm:6,children:(0,M.jsx)(z,{label:"Amount to Pay (\u20b9)",value:Q,type:"number",onChange:e=>X(e.target.value)})}),(0,M.jsx)(u.Ay,{container:!0,item:!0,xs:12,justifyContent:"center",children:(0,M.jsxs)(v.A,{variant:"contained",color:"success",disabled:!Q,onClick:()=>ne(!0),sx:{backgroundColor:"var(--bs-primary1)",borderColor:"var(--bs-primary1)",width:"250px"},children:["Pay \u20b9",Q||""]})})]})]})]})}),(0,M.jsxs)(x.A,{open:fe,onClose:()=>je(!1),PaperProps:{sx:()=>({borderRadius:4,p:2,backdropFilter:"blur(10px)",background:"white",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",width:"100%",maxWidth:800,overflow:0===(null===Re||void 0===Re?void 0:Re.length)?"hidden":"auto"})},children:[(0,M.jsx)(R.A,{onClick:()=>je(!1),sx:{position:"absolute",top:8,right:8,zIndex:10,color:"#000",fontSize:"16px"},children:(0,M.jsx)(k.A,{})}),(0,M.jsxs)(L,{sx:{width:"100%",borderRadius:2},children:[(0,M.jsx)(p.A,{value:ze,onChange:(e,i)=>{Le(i)},variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,orientation:"horizontal",sx:{"& .MuiTabs-flexContainer":{gap:"8px"},"& .MuiTab-root":{fontSize:"14px",textTransform:"none",padding:"10px 16px",fontWeight:500,color:"var(--bs-nav)"},"& .MuiTab-root.Mui-selected":{color:"var(--bs-primary1)",fontWeight:"bold"},"& .MuiTabs-indicator":{backgroundColor:"var(--bs-primary1)",height:"2px",borderRadius:"2px"}},children:null===Re||void 0===Re?void 0:Re.map(((e,i)=>(0,M.jsx)(h.A,{label:e},i)))}),0===(null===Re||void 0===Re?void 0:Re.length)&&(0,M.jsxs)(r.A,{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,M.jsx)("img",{src:"/noplandata.png",style:{top:"50%"},width:100}),(0,M.jsx)(d.A,{component:"h4",children:"No Plan Found"})]}),(0,M.jsx)(r.A,{sx:{mt:2},children:(0,M.jsx)(d.A,{variant:"body1",color:"text.secondary",children:(0,M.jsx)(r.A,{sx:{mt:2},children:(0,M.jsx)(u.Ay,{container:!0,spacing:2,height:"600px",sx:{overflowY:"auto",overflowX:"hidden "},children:null===(n=Me[Re[ze]])||void 0===n?void 0:n.map(((e,i)=>(0,M.jsx)(u.Ay,{item:!0,xs:12,children:(0,M.jsx)(m.A,{elevation:1,onClick:()=>{return i=null===e||void 0===e?void 0:e.rs,X(i),void je(!1);var i},sx:{borderRadius:3,transition:"transform 0.3s","&:hover":{transform:"scale(1.02)"},cursor:"pointer"},children:(0,M.jsxs)(b.A,{children:[(0,M.jsx)(r.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:(0,M.jsxs)(d.A,{variant:"h5",fontWeight:"bold",fontSize:16,children:["\u20b9",null===e||void 0===e?void 0:e.rs]})}),(0,M.jsx)(s.A,{sx:{my:1}}),(0,M.jsx)(r.A,{display:"flex",alignItems:"center",gap:1,mb:1,children:(0,M.jsxs)(d.A,{variant:"body1",color:"text.secondary",fontSize:13,children:["Validity: ",null===e||void 0===e?void 0:e.validity]})}),(0,M.jsx)(r.A,{display:"flex",alignItems:"center",gap:1,children:(0,M.jsx)(d.A,{variant:"body2",fontSize:13,children:null===e||void 0===e?void 0:e.desc})})]})})},i)))})})})})]})]}),(0,M.jsxs)(x.A,{open:te,onClose:ke,PaperProps:{sx:{borderRadius:4,p:2,backdropFilter:"blur(10px)",background:"rgba(255, 255, 255, 0.9)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",width:"100%",maxWidth:400}},children:[(0,M.jsx)(g.A,{sx:{color:"var(--bs-primary1)",fontWeight:600,textAlign:"center",fontSize:"1.0rem"},children:"Enter TPIN"}),(0,M.jsxs)(y.A,{sx:{textAlign:"center"},children:[(0,M.jsx)(d.A,{sx:{color:"var(--bs-nav)",mb:.5},fontSize:14,children:"Please enter your 4-digit TPIN to continue."}),(0,M.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",mb:2,gap:1,children:(0,M.jsxs)(d.A,{variant:"h6",sx:{color:"var(--bs-nav)",mb:.5},fontSize:14,children:["Payable Amount: \u20b9",Q]})}),(0,M.jsx)(z,{label:"TPIN",type:"password",value:ee||"",onChange:e=>{const i=e.target.value;/^\d{0,4}$/.test(i)&&ie(i)},autoComplete:"off",inputProps:{inputMode:"numeric",maxLength:4},InputProps:{startAdornment:(0,M.jsx)(A.A,{position:"start",children:(0,M.jsx)(j.A,{})})},fullWidth:!0})]}),(0,M.jsxs)(f.A,{sx:{justifyContent:"center",mt:2},children:[(0,M.jsx)(v.A,{onClick:ke,color:"error",variant:"outlined",sx:{borderRadius:2,px:4,width:"150px"},children:"Cancel"}),(0,M.jsx)(v.A,{onClick:()=>{(null===ee||void 0===ee?void 0:ee.length)<4?alert("Please enter 4 digit TPIN"):we()},disabled:W,color:"primary",variant:"contained",sx:{backgroundColor:"var(--bs-primary1)",borderRadius:2,px:4,width:"150px"},children:"Submit"})]})]})]})}},35717:(e,i,o)=>{o.d(i,{q:()=>t});var l=o(94414);const t=e=>l.cu+(e||"")},89349:(e,i,o)=>{o.d(i,{g:()=>l});const l=()=>new Promise(((e,i)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((i=>{e({latitude:i.coords.latitude,longitude:i.coords.longitude})}),(e=>{e.code===e.PERMISSION_DENIED&&alert("Please Enable Location to Proceed"),i(e)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):i(new Error("Geolocation is not supported"))}))},54358:(e,i,o)=>{o.d(i,{A:()=>t});var l=o(91036);function t(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"something went wrong";!1===e?l.oR.success(i):l.oR.error(i)}},8751:(e,i,o)=>{o.d(i,{A:()=>t});var l=o(89349);const t=e=>async function(){try{let{latitude:n,longitude:r}=await(0,l.g)();if(!n||!r)return alert("Please Enable Location");for(var i=arguments.length,o=new Array(i),t=0;t<i;t++)o[t]=arguments[t];return await e(n,r,...o)}catch(n){console.error("Error fetching location:",n)}}}}]);
//# sourceMappingURL=5291.ddee6f1d.chunk.js.map