"use strict";(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[1721],{47943:(e,a,r)=>{r.d(a,{A:()=>o});var t=r(65043),s=r(73575),l=r(91036),n=(r(76323),r(70579));const o=e=>{let{userId:a,onClose:r,longitude:o,latitude:i,transferAmount:d,open:c,walletShowHeader:u,fetchData:m,resetModalStates:x}=e;const[h,v]=(0,t.useState)(new Array(6).fill("")),[p,b]=(0,t.useState)(120),[y,g]=(0,t.useState)(!1),[j,f]=(0,t.useState)(!1),[C,N]=(0,t.useState)(!1),[A,k]=(0,t.useState)(""),[w,S]=(0,t.useState)(""),R=(0,t.useRef)([]),T=(0,t.useRef)(null),P=(0,t.useCallback)((()=>{T.current&&clearInterval(T.current),b(120),g(!1),T.current=setInterval((()=>{b((e=>e<=1?(clearInterval(T.current),g(!0),0):e-1))}),1e3)}),[]),_=(0,t.useCallback)((()=>{T.current&&clearInterval(T.current),b(0),g(!0)}),[]);(0,t.useEffect)((()=>(c?P():_(),()=>clearInterval(T.current))),[c,P,_]);const E=(0,t.useCallback)((()=>{_(),v(new Array(6).fill("")),k(""),S(""),r()}),[r,_]),L=(0,t.useCallback)(((e,a)=>{const r=[...h];r[e]=a.slice(0,1),v(r),a&&e<5&&R.current[e+1]&&R.current[e+1].focus()}),[h]),I=(0,t.useCallback)(((e,a)=>{if("Backspace"===e.key&&!h[a]&&a>0){const e=[...h];e[a-1]="",v(e),R.current[a-1].focus()}}),[h]),z=(0,t.useCallback)((async()=>{f(!0),S(""),k("");try{200==(await(0,s.eVi)({token:a,amount:Number(d)})).status?(k("OTP has been resent successfully."),P(),v(new Array(6).fill(""))):S("Failed to resend OTP.")}catch(w){S("Failed to resend OTP.")}finally{f(!1)}}),[a,P,d]),O=(0,t.useCallback)((async()=>{N(!0),k(""),S("");try{var e;const v=await(0,s.AkL)({token:a,otp:h.join(""),lat:i,long:o});var t,n,d,c;if(200==(null===v||void 0===v||null===(e=v.data)||void 0===e?void 0:e.statusCode))k((null===v||void 0===v||null===(t=v.data)||void 0===t?void 0:t.message)||"OTP verified successfully."),l.oR.success((null===v||void 0===v||null===(n=v.data)||void 0===n?void 0:n.message)||"OTP verified successfully."),r(),u&&u(),m&&m(),x&&x();else S((null===v||void 0===v||null===(d=v.data)||void 0===d?void 0:d.message)||(null===v||void 0===v?void 0:v.data)||"Failed to verify OTP."),l.oR.error((null===v||void 0===v||null===(c=v.data)||void 0===c?void 0:c.message)||(null===v||void 0===v?void 0:v.data)||"Failed to verify OTP.")}catch(w){S("Failed to verify OTP."),l.oR.error("Failed to verify OTP.")}finally{N(!1)}}),[a,h,r,i,o]);return(0,n.jsx)("div",{className:"modal fade modal-cssclasss mediaqurymodalpop ".concat(c?"show d-block":""),tabIndex:"-1",role:"dialog",children:(0,n.jsx)("div",{className:"modal-dialog",role:"document",style:{zIndex:1050},children:(0,n.jsxs)("div",{className:"modal-content modal-content-otp",children:[(0,n.jsxs)("div",{className:"modal-header text-center",children:[(0,n.jsx)("h5",{className:"modal-title modaltitle-otp",children:"OTP Verification"}),(0,n.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:E})]}),(0,n.jsx)("div",{className:"modal-body",style:{backgroundColor:"#ffffff",transform:"translateZ(0)",backfaceVisibility:"hidden"},children:y?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"Please Enter 6-digit Code Sent To Your Registered Mobile Number!"}),(0,n.jsx)("button",{type:"button",className:"btn btn-resend-otp",onClick:z,children:j?(0,n.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):"Resend OTP"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"Please Enter 6-digit Code Sent To Your Registered Mobile Number!"}),(0,n.jsxs)("div",{className:"verification-timer",children:["Verification Code: ",(e=>{const a=Math.floor(e/60),r=e%60;return"".concat(a.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))})(p)," seconds ",(0,n.jsx)("span",{className:"resend-otp",onClick:z,children:"Resend OTP"})]}),(0,n.jsx)("div",{className:"otp-inputs",children:h.map(((e,a)=>(0,n.jsx)("input",{type:"password",maxLength:"1",value:e,onChange:e=>L(a,e.target.value),onKeyDown:e=>I(e,a),ref:e=>R.current[a]=e,className:"otp-input"},a)))}),(0,n.jsx)("button",{type:"button",className:"btn btn-submit-otp",onClick:O,disabled:h.some((e=>""===e))||C,children:C?(0,n.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):"Submit OTP"}),A&&(0,n.jsx)("div",{className:"alert alert-success mt-3",children:A}),w&&(0,n.jsx)("div",{className:"alert alert-danger mt-3",children:w})]})})]})})})}},51721:(e,a,r)=>{r.r(a),r.d(a,{default:()=>j});var t=r(65043),s=r(14282),l=r(64196),n=r(38628),o=r(25284),i=r(73722),d=r(85369),c=r(73216),u=r(91036),m=(r(92342),r(1281)),x=r(76245),h=r(47943),v=r(73575),p=r(72777),b=(r(22871),r(70579));const y=e=>{let{users:a,totalCount:r,onUserClick:s,onTransferClick:n,onReverseTransferClick:o,onReportClick:i,onPageChange:c,handleReportClickmainreportasmzsm:u,level:m=0,initialPage:h=1,initialPageSize:v=10}=e;const[p,y]=(0,t.useState)(h),[j,f]=(0,t.useState)(v),[C,N]=(0,t.useState)({});(0,t.useEffect)((()=>{y(h),f(v)}),[h,v]);const A=async(e,a)=>{y(e),a!==j&&f(a),await c(e,a)};return null!==a&&void 0!==a&&a.length?(0,b.jsxs)("div",{className:"border rounded my-2",style:{backgroundColor:"var(--bs-primary1)",border:"1px solid var(--bs-primary2)",borderRadius:"16px",width:"100%"},children:[(0,b.jsx)("div",{className:"p-2 border-bottom d-flex justify-content-between align-items-center",style:{backgroundColor:"var(--bs-primary3)",color:"var(--bs-primary2)",borderBottom:"1px solid var(--bs-primary2)",borderRadius:"16px 16px 0 0",width:"100%"},children:(0,b.jsxs)("h6",{className:"mb-0 text-center w-100",style:{color:"var(--bs-primary2)",fontWeight:600},children:["Downstream Members (Level ",m+1,")"]})}),(0,b.jsxs)(l.A,{hover:!0,className:"mb-0",style:{backgroundColor:"var(--bs-primary1)",color:"var(--bs-primary2)",border:"1px solid var(--bs-primary2)",borderRadius:"12px",overflow:"hidden"},children:[(0,b.jsx)("thead",{style:{backgroundColor:"var(--bs-primary3)",color:"var(--bs-primary2)",fontWeight:600,borderBottom:"1px solid var(--bs-primary2)",textAlign:"center"},children:(0,b.jsxs)("tr",{style:{backgroundColor:"var(--bs-primary3)"},children:[(0,b.jsx)("th",{className:"text-center",children:"S.No"}),(0,b.jsx)("th",{className:"text-center",children:"Refer ID"}),(0,b.jsx)("th",{className:"text-center",children:"Name"}),(0,b.jsx)("th",{className:"text-center",style:{whiteSpace:"nowrap"},children:"User Type"}),(0,b.jsx)("th",{className:"text-center",children:"Mobile no"}),(0,b.jsx)("th",{className:"text-center",children:"Email Id"}),(0,b.jsx)("th",{className:"text-center",children:"Status"}),(0,b.jsx)("th",{className:"text-center",children:"Downstream"}),(0,b.jsx)("th",{className:"text-center",children:"Actions"}),(0,b.jsx)("th",{className:"text-center",children:"Wallet"}),(0,b.jsx)("th",{className:"text-center",colSpan:"2",children:"Report"})]})}),(0,b.jsx)("tbody",{children:a.map(((e,a)=>{var r,t;return(0,b.jsx)(g,{user:e,index:a+(p-1)*j,onUserClick:s,onTransferClick:n,onReverseTransferClick:o,onReportClick:i,level:m,currentPage:(null===(r=C[e._id])||void 0===r?void 0:r.page)||1,pageSize:(null===(t=C[e._id])||void 0===t?void 0:t.size)||10,onPageChange:(a,r)=>(async(e,a,r)=>{N((t=>({...t,[e]:{page:a,size:r}})))})(e._id,a,r),handleReportClickmainreportasmzsm:u},e._id)}))})]}),r>j&&(0,b.jsx)("div",{className:"p-3 border-top",style:{borderTop:"1px solid var(--bs-primary2)",backgroundColor:"var(--bs-primary1)"},children:(0,b.jsx)(x.A,{current:p,total:r,pageSize:j,onChange:e=>A(e,j),showSizeChanger:!0,onShowSizeChange:(e,a)=>A(1,a),showQuickJumper:!0,showTotal:(e,a)=>"".concat(a[0],"-").concat(a[1]," of ").concat(e," items"),className:"justify-content-end"})})]}):(0,b.jsxs)("div",{className:"text-center py-4",children:[(0,b.jsx)(d.YXz,{size:24,className:"mb-2",style:{color:"var(--bs-primary2)"}}),(0,b.jsx)("p",{style:{color:"var(--bs-primary2)"},children:"No downstream members available"})]})},g=e=>{let{user:a,index:r,onUserClick:l,onTransferClick:n,onReverseTransferClick:o,onReportClick:i,level:c,currentPage:u,pageSize:m,onPageChange:x,handleReportClickmainreportasmzsm:h}=e;const[v,p]=(0,t.useState)(!1),[g,j]=(0,t.useState)([]),[f,C]=(0,t.useState)(!1),[N,A]=(0,t.useState)(0),k=async(e,r)=>{C(!0);try{const t=await l(a._id,e,r);null!==t&&void 0!==t&&t.data&&(j(t.data),A(t.totalCount))}catch(t){}C(!1)};return(0,b.jsxs)(t.Fragment,{children:[(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{children:r+1}),(0,b.jsx)("td",{children:null===a||void 0===a?void 0:a.refer_id}),(0,b.jsx)("td",{children:null===a||void 0===a?void 0:a.name}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"badge",style:{backgroundColor:"var(--bs-primary3)",color:"var(--bs-primary2)",padding:"6px 10px",borderRadius:"10px",fontWeight:600},children:null===a||void 0===a?void 0:a.user_type})}),(0,b.jsx)("td",{children:null===a||void 0===a?void 0:a.mobile}),(0,b.jsx)("td",{children:null===a||void 0===a?void 0:a.email}),(0,b.jsx)("td",{children:(0,b.jsx)("span",{className:"badge",style:{backgroundColor:a.is_approved?"var(--bs-success)":"var(--bs-warning)",color:"#000",padding:"6px 10px",borderRadius:"10px",fontWeight:600},children:null!==a&&void 0!==a&&a.is_approved?"Approved":"Pending"})}),(0,b.jsx)("td",{children:"Retailer"!==a.user_type&&(0,b.jsxs)(s.A,{onClick:async()=>{v||g.length||await k(u,m),p(!v)},disabled:f,className:"d-flex align-items-center",style:{backgroundColor:"var(--bs-primary1)",color:"var(--bs-primary2)",border:"1px solid var(--bs-primary2)",borderRadius:"10px",padding:"4px 12px",fontWeight:500},children:[f?"Loading...":"View",v?(0,b.jsx)(d.Ucs,{className:"ms-1",style:{color:"var(--bs-primary2)"}}):(0,b.jsx)(d.Vr3,{className:"ms-1",style:{color:"var(--bs-primary2)"}})]})}),(0,b.jsx)("td",{children:(0,b.jsxs)("div",{className:"d-flex gap-2",children:[(0,b.jsx)(s.A,{size:"sm",onClick:()=>n(a),style:{backgroundColor:"var(--bs-primary1)",color:"var(--bs-primary2)",border:"1px solid var(--bs-primary2)",borderRadius:"10px",fontWeight:500,padding:"4px 12px"},children:"Transfer"}),(0,b.jsx)(s.A,{size:"sm",onClick:()=>o(a),style:{backgroundColor:"var(--bs-primary1)",color:"var(--bs-primary2)",border:"1px solid var(--bs-primary2)",borderRadius:"10px",fontWeight:500,padding:"4px 12px"},children:"Reverse"})]})}),(0,b.jsxs)("td",{children:["\u20b9",(null===a||void 0===a?void 0:a.main_wallet)||0]}),(0,b.jsx)("td",{children:(0,b.jsx)(s.A,{onClick:()=>i(a._id),style:{backgroundColor:"transparent",border:"1px solid var(--bs-primary2)",borderRadius:"10px",padding:"6px 10px"},children:(0,b.jsx)(d.Ny1,{style:{color:"black"}})})}),(0,b.jsx)("td",{style:{whiteSpace:"nowrap"},children:(0,b.jsx)(s.A,{variant:"warning",onClick:()=>h(a._id),children:"Wallet Report"})})]}),v&&(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"11",className:"p-0",children:(0,b.jsx)("div",{className:"ps-4 border-start border-primary",style:{marginLeft:"".concat(20*c,"px")},children:f?(0,b.jsx)("div",{className:"text-center py-3",style:{color:"var(--bs-primary2)"},children:"Loading..."}):g.length>0?(0,b.jsx)(y,{users:g,totalCount:N,onUserClick:l,onTransferClick:n,onReverseTransferClick:o,onReportClick:i,onPageChange:async(e,a)=>{await k(e,a),x(e,a)},level:c+1,initialPage:u,initialPageSize:m,handleReportClickmainreportasmzsm:h}):(0,b.jsx)("div",{className:"text-center py-3",style:{color:"var(--bs-primary2)"},children:"No downstream members available"})})})})]})};const j=function(e){let{walletShowHeader:a,position:r}=e;const[l,d]=(0,t.useState)(!1),[g,j]=(0,t.useState)([]),[f,C]=(0,t.useState)(0),[N,A]=(0,t.useState)(0),[k,w]=(0,t.useState)(10),[S,R]=(0,t.useState)(!1),[T,P]=(0,t.useState)(null),[_,E]=(0,t.useState)(null),[L,I]=(0,t.useState)(1),z=(0,c.Zp)(),[O,B]=(0,t.useState)(""),[G,H]=(0,t.useState)(10),[F,U]=(0,t.useState)({}),[M,D]=(0,t.useState)({userId:"",name:"",email:"",mobile:"",is_approved:"",refer_id:"",userType:""}),[W,V]=(0,t.useState)(!1),[Y,q]=(localStorage.getItem("userType"),localStorage.getItem("userTypeId"),(0,t.useState)(!1)),[Q,X]=(0,t.useState)(!1),[K,Z]=(0,t.useState)(""),[J,$]=(0,t.useState)(""),[ee,ae]=(0,t.useState)(!1),[re,te]=(0,t.useState)(""),[se,le]=(0,t.useState)(!1),[ne,oe]=(0,t.useState)(null),[ie,de]=(0,t.useState)(null),[ce,ue]=(0,t.useState)(null),[me,xe]=(0,t.useState)(""),[he,ve]=(0,t.useState)({}),[pe,be]=(0,t.useState)(!1),[ye,ge]=(0,t.useState)(!1),[je,fe]=(0,t.useState)(),[Ce,Ne]=(0,t.useState)(!1),Ae=(0,t.useRef)(null);(0,t.useEffect)((()=>{const e=()=>{if(Ae.current){const{top:e}=Ae.current.getBoundingClientRect();e<=0?Ae.current.classList.add("sticky-header"):Ae.current.classList.remove("sticky-header")}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]),(0,t.useEffect)((()=>{ke(),Te(),Pe()}),[L,k]);const ke=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G;d(!0);try{var r,t;const s=await(0,v.XCx)(e-1,a,"",M);j((null===s||void 0===s||null===(r=s.data)||void 0===r?void 0:r.data)||[]),C((null===s||void 0===s||null===(t=s.data)||void 0===t?void 0:t.totalCount)||0),I(e),H(a)}catch(s){console.error("Error fetching users:",s),u.oR.error("Failed to fetch users"),j([]),C(0)}d(!1)};(0,t.useEffect)((()=>{ke(),Te(),Pe()}),[L,G]);const we=(e,a)=>{I(e),H(a),ke(e,a)},Se=async e=>{P(e),R(!0)},Re=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;d(!0);try{const t=await(0,v.XCx)(a-1,r,e);if("200"==t.data.statusCode){const a=g.map((a=>a._id===e?{...a,subUsers:t.data.data||[],subUsersTotalCount:t.data.totalCount||0}:a));return j(a),{data:t.data.data||[],totalCount:t.data.totalCount||0}}u.oR.error(t.data.message||"Failed to fetch sub-users")}catch(t){console.error("Error fetching sub-users:",t),u.oR.error("Failed to fetch sub-users. Please try again.")}finally{d(!1)}return{data:[],totalCount:0}},Te=async()=>{try{var e;const a=await(0,v.aQK)();U(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.data)}catch(a){console.error("Error fetching wallet data:",a)}},Pe=async()=>{try{var e;const a=await(0,v.mQ9)();ve(null===a||void 0===a||null===(e=a.data)||void 0===e?void 0:e.data)}catch(a){console.error("Error fetching profile data:",a)}},_e=()=>new Promise(((e,a)=>{ne&&ie?e(!0):r.latitude&&r.longitude?(oe(r.latitude),de(r.longitude),ue(null),e(!0)):"geolocation"in navigator?(Ne(!0),navigator.geolocation.getCurrentPosition((a=>{oe(a.coords.latitude),de(a.coords.longitude),ue(null),Ne(!1),e(!0)}),(e=>{console.error("Geolocation error:",e),ue("Unable to retrieve your location. Please ensure location services are enabled."),Ne(!1),a(e)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})):(ue("Geolocation is not supported by your browser"),a(new Error("Geolocation not supported")))})),Ee=e=>{P(e),ae(!0)},Le=e=>{z("/user-report/".concat(e))},Ie=()=>{R(!1),q(!1),ae(!1),X(!1),le(!1),B(""),te(""),Z(""),xe(""),$(""),V(!1),be(!1),ge(!1),P(null)};return(0,b.jsxs)(b.Fragment,{children:[l&&(0,b.jsx)(p.A,{}),(0,b.jsxs)("div",{className:"container-fluid",children:[(0,b.jsx)("div",{className:"PageHeading",children:(0,b.jsx)("h1",{className:"h3 mb-2 text-gray-800",children:"Downstream Users"})}),(0,b.jsxs)(n.A,{className:"shadow mb-4 mt-4",children:[(0,b.jsx)(n.A.Header,{className:"py-3 d-flex justify-content-between align-items-center ",children:(0,b.jsx)("h6",{className:"m-0 font-weight-bold",children:"User List"})}),(0,b.jsxs)(n.A.Body,{children:[(0,b.jsx)("div",{className:"table-responsive",children:(0,b.jsx)(y,{users:g,totalCount:f,onUserClick:Re,onTransferClick:Se,onReverseTransferClick:Ee,onReportClick:Le,onPageChange:we,initialPage:L,initialPageSize:G,handleReportClickmainreportasmzsm:e=>{z("/main-report/".concat(e))}})}),f>0&&(0,b.jsx)(x.A,{current:L,total:f,pageSize:k,onChange:we,showSizeChanger:!1,className:"mt-3 justify-content-end"})]})]})]}),(0,b.jsxs)(o.A,{show:S,onHide:()=>{R(!1),Ie()},children:[(0,b.jsxs)(o.A.Header,{closeButton:!0,className:"d-flex justify-content-between",children:[(0,b.jsx)("div",{className:"modal-title h5",children:"Transfer Money"}),(0,b.jsxs)("span",{id:"baldiv",style:{marginLeft:"20%"},children:["Available Balance: ",Math.max(0,((null===F||void 0===F?void 0:F.main_wallet)||0)-((null===he||void 0===he?void 0:he.locking_amt)||0))]})]}),(0,b.jsx)(o.A.Body,{children:(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Refer ID"}),(0,b.jsx)(i.A.Control,{type:"text",value:(null===T||void 0===T?void 0:T.refer_id)||"",readOnly:!0})]}),(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Name"}),(0,b.jsx)(i.A.Control,{type:"text",value:(null===T||void 0===T?void 0:T.name)||"",readOnly:!0})]}),(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Mobile"}),(0,b.jsx)(i.A.Control,{type:"text",value:(null===T||void 0===T?void 0:T.mobile)||"",readOnly:!0})]}),(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Amount"}),(0,b.jsx)(i.A.Control,{type:"number",placeholder:"Enter amount (minimum 100)",required:!0,value:O,onChange:e=>{const a=e.target.value;B(a),V(Number(a)>=100&&Number(a)<=Number((null===F||void 0===F?void 0:F.main_wallet)-(null===he||void 0===he?void 0:he.locking_amt)))}}),!W&&""!==O&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:Number(O)<100?"Amount must be at least 100 rupees":"Insufficient balance"})]}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(s.A,{variant:"primary",onClick:()=>{Number(O)<100?u.oR.error("Amount must be at least 100 rupees"):(R(!1),q(!0))},disabled:!W,children:"Transfer"})})]})})]}),(0,b.jsxs)(o.A,{show:Y,onHide:()=>{q(!1),Ie()},children:[(0,b.jsx)(o.A.Header,{closeButton:!0,children:(0,b.jsx)(o.A.Title,{children:"Enter TPIN"})}),(0,b.jsx)(o.A.Body,{children:(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"TPIN"}),(0,b.jsx)(i.A.Control,{type:"password",placeholder:"Enter your TPIN",value:K,onChange:e=>{const a=e.target.value.replace(/[^0-9]/g,"").slice(0,4);Z(a),xe("*".repeat(a.length))},maxLength:4}),ce&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:ce}),J&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:J})]}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(m.A,{title:"Are you sure you want to transfer this money?",open:pe,getPopupContainer:e=>e.parentElement,onConfirm:()=>{be(!1),(async()=>{try{if(await _e(),ce)return u.oR.error(ce),void u.oR.error("Location information is not available. Please try again.");const t=await(0,v.a50)({transferTo:T._id,amount:Number(O),tpin:K,trans_type:"transfer",lat:ne,long:ie});if("200"==t.data.statusCode)u.oR.success("Money transferred successfully"),q(!1),Ie(),Te(),a&&a(),ke&&ke();else if("403"==t.data.statusCode){var e,r;$(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.message),u.oR.error(null===t||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)}else u.oR.error(t.data.message||"Transfer failed. Please try again.")}catch(t){console.error("Error transferring money:",t),"GeolocationPositionError"===t.name?u.oR.error("Unable to access location. Please enable location services and try again."):u.oR.error("Transfer failed. Please try again.")}})()},onCancel:()=>be(!1),okText:"Yes",cancelText:"No",children:(0,b.jsx)(s.A,{variant:"primary",disabled:4!==K.length||ce,onClick:()=>be(!0),children:"Submit"})})})]})})]}),(0,b.jsxs)(o.A,{show:ee,onHide:()=>{ae(!1),Ie()},children:[(0,b.jsxs)(o.A.Header,{closeButton:!0,className:"d-flex justify-content-between",children:[(0,b.jsx)("div",{className:"modal-title h5",children:"Reverse Transfer"}),(0,b.jsxs)("span",{id:"baldiv",style:{marginLeft:"20%"},children:["Available Balance: ",(null===T||void 0===T?void 0:T.main_wallet)||0]})]}),(0,b.jsx)(o.A.Body,{children:(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Refer ID"}),(0,b.jsx)(i.A.Control,{type:"text",value:(null===T||void 0===T?void 0:T.refer_id)||"",readOnly:!0})]}),(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Name"}),(0,b.jsx)(i.A.Control,{type:"text",value:(null===T||void 0===T?void 0:T.name)||"",readOnly:!0})]}),(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Mobile"}),(0,b.jsx)(i.A.Control,{type:"text",value:(null===T||void 0===T?void 0:T.mobile)||"",readOnly:!0})]}),(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"Amount"}),(0,b.jsx)(i.A.Control,{type:"number",placeholder:"Enter amount (minimum 100)",required:!0,value:re,onChange:e=>{const a=e.target.value;te(a)}}),Number(re)>Number(null===T||void 0===T?void 0:T.main_wallet)&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:"Insufficient balance"}),Number(re)<100&&""!==re&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:"Amount must be at least 100 rupees"})]}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(s.A,{variant:"primary",onClick:()=>{ae(!1),X(!0)},disabled:Number(re)>Number(null===T||void 0===T?void 0:T.main_wallet)||Number(re)<100,children:"Reverse Transfer"})})]})})]}),(0,b.jsxs)(o.A,{show:Q,onHide:()=>{X(!1),Ie()},children:[(0,b.jsx)(o.A.Header,{closeButton:!0,children:(0,b.jsx)(o.A.Title,{children:"Enter TPIN for Reverse Transfer"})}),(0,b.jsx)(o.A.Body,{children:(0,b.jsxs)(i.A,{children:[(0,b.jsxs)(i.A.Group,{className:"mb-3",children:[(0,b.jsx)(i.A.Label,{children:"TPIN"}),(0,b.jsx)(i.A.Control,{type:"password",placeholder:"Enter your TPIN",value:K,onChange:e=>{const a=e.target.value.replace(/[^0-9]/g,"").slice(0,4);Z(a),xe("*".repeat(a.length))},maxLength:4}),ce&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:ce}),J&&(0,b.jsx)(i.A.Text,{className:"text-danger",children:J})]}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(m.A,{title:"Are you sure you want to reverse transfer this money?",open:ye,getPopupContainer:e=>e.parentElement,onConfirm:()=>{ge(!1),(async()=>{try{if(await _e(),ce)return void u.oR.error(ce);const r=await(0,v.a50)({transferTo:T._id,amount:Number(re),tpin:K,trans_type:"refund",lat:ne,long:ie});if("200"==r.data.statusCode){const e=r.data.data.token;fe(e),X(!1),le(!0)}else if("403"==r.data.statusCode){var e,a;$(null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.message),u.oR.error(null===r||void 0===r||null===(a=r.data)||void 0===a?void 0:a.message)}else u.oR.error(r.data.message||"Reverse transfer failed. Please try again.")}catch(r){console.error("Error reverse transferring money:",r),u.oR.error("Reverse transfer failed. Please try again.")}})()},onCancel:()=>ge(!1),okText:"Yes",cancelText:"No",children:(0,b.jsx)(s.A,{variant:"primary",disabled:4!==K.length||ce,onClick:()=>ge(!0),children:"Submit"})})})]})})]}),(0,b.jsx)(h.A,{open:se,userId:je,onClose:()=>le(!1),longitude:ie,latitude:ne,transferAmount:re,walletShowHeader:a,fetchData:ke,resetModalStates:Ie})]})}},76323:()=>{},22871:()=>{}}]);
//# sourceMappingURL=1721.48148ea6.chunk.js.map