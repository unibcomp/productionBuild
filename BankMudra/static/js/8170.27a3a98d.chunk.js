"use strict";(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[8170],{48170:(e,a,i)=>{i.r(a),i.d(a,{default:()=>x});var n=i(65043),t=i(94516),l=i(94496),r=i(68903),s=i(67784),c=i(11906),d=i(90035),o=i(26600),f=i(35316),u=i(29347),m=i(4026),b=i(67361),y=i.n(b),h=i(54358),_=i(73575),v=i(70579);const x=()=>{const[e,a]=(0,n.useState)(!1),[i,b]=(0,n.useState)(!1),[x,A]=(0,n.useState)(!1),[g,p]=(0,n.useState)(!1),[j,I]=(0,n.useState)(!1),[C,P]=(0,n.useState)(""),[w,U]=(0,n.useState)({transfer_mode:"UPI",vpa:"",transfer_amount:"",beneficiary_name:"",beneficiary_account_name:"",beneficiary_email:"",beneficiary_mobile:"",beneficiary_add:"",beneficiary_city:"",beneficiary_state:"",beneficiary_pin_code:""}),N=(e,a)=>U((i=>({...i,[e]:a}))),S=async e=>{try{var i;A(!0);const r=await(0,_.PrO)({accountNumber:e,transfer_mode:"UPI"});var n,t,l;if(null!==r&&void 0!==r&&null!==(i=r.data)&&void 0!==i&&i.success)a(!0),N("beneficiary_name",(null===(n=r.data.data)||void 0===n?void 0:n.name)||""),N("beneficiary_account_name",(null===(t=r.data.data)||void 0===t?void 0:t.bank_name)||""),(0,h.A)(!1,"UPI Verified");else(0,h.A)(!0,null===r||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)}catch{(0,h.A)(!0,"UPI verification error")}finally{A(!1)}},k=e=>{if(null===e||void 0===e||!e.toLowerCase().startsWith("upi://"))return void(0,h.A)(!0,"Invalid UPI QR");const i=new URLSearchParams(e.split("?")[1]||""),n=i.get("pa"),t=i.get("am");if(n){const e=decodeURIComponent(n);N("vpa",e),a(!1),S(e)}t&&!isNaN(t)?(N("transfer_amount",t),b(!0)):b(!1),p(!1)},R=()=>{a(!1),b(!1),I(!1),P(""),U({transfer_mode:"UPI",vpa:"",transfer_amount:"",beneficiary_name:"",beneficiary_account_name:"",beneficiary_email:"",beneficiary_mobile:"",beneficiary_add:"",beneficiary_city:"",beneficiary_state:"",beneficiary_pin_code:""})};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(t.A,{p:3,bgcolor:"#fff",borderRadius:2,children:[(0,v.jsx)(l.A,{variant:"h6",mb:2,children:"UPI Transfer"}),(0,v.jsxs)(r.Ay,{container:!0,spacing:2,children:[(0,v.jsxs)(r.Ay,{item:!0,xs:12,md:4,children:[(0,v.jsx)(s.A,{fullWidth:!0,className:"mui-autofill-fix",label:"UPI ID",value:w.vpa,disabled:e||x,onChange:e=>{N("vpa",e.target.value.toLowerCase()),a(!1)}}),!e&&(0,v.jsxs)(t.A,{mt:1,display:"flex",gap:1,children:[(0,v.jsx)(c.A,{onClick:()=>p(!0),disabled:x,children:"Scan QR"}),(0,v.jsx)(c.A,{onClick:()=>S(w.vpa),disabled:!w.vpa||x,children:x?"Verifying...":"Verify"})]})]}),e&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(r.Ay,{item:!0,xs:12,md:4,children:[(0,v.jsx)(s.A,{fullWidth:!0,label:"Beneficiary Name",className:"mui-autofill-fix",value:w.beneficiary_name,disabled:!0}),(0,v.jsx)(l.A,{variant:"caption",sx:{color:"green",fontWeight:600},children:"\u2714 Verified"})]}),(0,v.jsx)(r.Ay,{item:!0,xs:12,md:4,children:(0,v.jsx)(s.A,{fullWidth:!0,label:"Bank Name",className:"mui-autofill-fix",value:w.beneficiary_account_name})}),(0,v.jsx)(r.Ay,{item:!0,xs:12,md:4,children:(0,v.jsx)(s.A,{fullWidth:!0,label:"Amount",className:"mui-autofill-fix",value:w.transfer_amount,disabled:x||i,onChange:e=>N("transfer_amount",e.target.value)})}),[["beneficiary_email","Email"],["beneficiary_mobile","Mobile"],["beneficiary_add","Address"],["beneficiary_city","City"],["beneficiary_state","State"],["beneficiary_pin_code","PIN Code"]].map((e=>{let[a,i]=e;return(0,v.jsx)(r.Ay,{item:!0,xs:12,md:4,children:(0,v.jsx)(s.A,{fullWidth:!0,className:"mui-autofill-fix",label:i,value:w[a],disabled:x,onChange:e=>N(a,e.target.value)})},a)}))]})]}),e&&(0,v.jsx)(t.A,{mt:3,textAlign:"center",children:(0,v.jsx)(c.A,{variant:"contained",disabled:x,onClick:()=>I(!0),children:"Submit"})})]}),(0,v.jsxs)(d.A,{open:g,maxWidth:"xs",fullWidth:!0,children:[(0,v.jsx)(o.A,{align:"center",children:"Scan UPI QR"}),(0,v.jsxs)(f.A,{children:[(0,v.jsx)(m.Lp,{constraints:{facingMode:"environment"},onScan:e=>{var a;const i="string"===typeof e?e:(null===e||void 0===e?void 0:e.rawValue)||(null===e||void 0===e||null===(a=e[0])||void 0===a?void 0:a.rawValue);i&&k(i)}}),(0,v.jsx)(t.A,{mt:2,textAlign:"center",children:(0,v.jsxs)(c.A,{component:"label",variant:"outlined",disabled:x,children:["Upload QR",(0,v.jsx)("input",{hidden:!0,type:"file",accept:"image/*",onChange:e=>{var a;const i=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!i)return;const n=new Image;n.src=URL.createObjectURL(i),n.onload=()=>{const e=document.createElement("canvas"),a=e.getContext("2d");e.width=n.width,e.height=n.height,a.drawImage(n,0,0);const i=a.getImageData(0,0,e.width,e.height),t=y()(i.data,i.width,i.height);null!==t&&void 0!==t&&t.data&&k(t.data)}}})]})})]}),(0,v.jsx)(u.A,{children:(0,v.jsx)(c.A,{onClick:()=>p(!1),disabled:x,children:"Close"})})]}),(0,v.jsxs)(d.A,{open:j,children:[(0,v.jsx)(o.A,{align:"center",children:"Enter TPIN"}),(0,v.jsx)(f.A,{children:(0,v.jsx)(s.A,{fullWidth:!0,className:"mui-autofill-fix",type:"password",value:C,inputProps:{maxLength:4},disabled:x,onChange:e=>/^\d{0,4}$/.test(e.target.value)&&P(e.target.value)})}),(0,v.jsxs)(u.A,{children:[(0,v.jsx)(c.A,{onClick:()=>I(!1),disabled:x,children:"Cancel"}),(0,v.jsx)(c.A,{onClick:async()=>{if(e)if(/^\d{4}$/.test(C))try{var a;A(!0);const e={transfer_mode:"UPI",vpa:w.vpa,transfer_amount:Number(w.transfer_amount),beneficiary_name:w.beneficiary_name,beneficiary_account_name:w.beneficiary_account_name,beneficiary_email:w.beneficiary_email,beneficiary_mobile:w.beneficiary_mobile,beneficiary_add:w.beneficiary_add,beneficiary_city:w.beneficiary_city,beneficiary_state:w.beneficiary_state,beneficiary_pin_code:w.beneficiary_pin_code,tpin:C},n=await(0,_.IJ8)(e);var i;if(null!==n&&void 0!==n&&null!==(a=n.data)&&void 0!==a&&a.success)(0,h.A)(!1,"UPI Payout Successful"),R();else(0,h.A)(!0,null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message)}finally{A(!1)}else(0,h.A)(!0,"Invalid TPIN");else(0,h.A)(!0,"UPI verification required")},disabled:x,children:x?"Processing...":"Confirm"})]})]})]})}},54358:(e,a,i)=>{i.d(a,{A:()=>t});var n=i(91036);function t(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"something went wrong";!1===e?n.oR.success(a):n.oR.error(a)}}}]);
//# sourceMappingURL=8170.27a3a98d.chunk.js.map