(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[6836],{96836:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>y});var s=t(22019),l=t(94434),n=t(87021),o=t(76245),r=t(65043),i=t(73575),d=t(72777),c=t(95702),m=t(35475),u=t(76191),h=t(73216),p=t(91036),x=(t(92342),t(94414)),v=t(86213),b=t(70579);const g=function(){const[e,a]=(0,r.useState)((new Date).toISOString().substr(0,10)),[t,g]=(0,r.useState)(!1),[y,f]=(0,r.useState)(10),[_,j]=(0,r.useState)(0),[N,w]=(0,r.useState)(null),[T,k]=(0,r.useState)([]),[C,S]=(0,r.useState)(null),A=(0,h.Zp)(),E=(0,r.useRef)(10),[I,W]=(0,r.useState)(null),[O,D]=(0,r.useState)({user_id:"",count:"",page:"",end_date:"",start_date:"",customer_mobile:"",adhaar_no:"",txn_id:"",sortType:"",sortKey:"",status:""}),R=e=>{const{name:a,value:t}=e.target;D((e=>"start_date"===a&&e.end_date&&t>e.end_date?{...e,start_date:t,end_date:t}:{...e,[a]:t}))},P=(0,r.useCallback)((async(e,a)=>{g(!0);const t=void 0!==a?a:E.current,s={...O,count:t,page:e||0,min_amt:+O.min_amt,max_amt:+O.max_amt,user_id:window.localStorage.getItem("userIdToken")};try{const e=await(0,i.CCK)(s);var l;if(e&&null!==e&&void 0!==e&&e.data&&null!==e&&void 0!==e&&e.data.data)w((null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.totalCount)||0),k(null===e||void 0===e?void 0:e.data);else w(0),k(null)}catch(n){console.error(n),w(0),k(null)}g(!1)}),[O]),[B,F]=(0,r.useState)(),[M,q]=(0,r.useState)(1),U=async e=>{q("asc"==B?1:-1),F("asc"===B?"desc":"asc"),g(!0);const a={...O,count:y,page:_,min_amt:+O.min_amt,max_amt:+O.max_amt,sortType:+M,sortKey:e,user_id:window.localStorage.getItem("userIdToken")};try{var t,s,l,n;const e=await(0,i.CCK)(a);w((null===e||void 0===e||null===(t=e.data)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.totalCount)||0),k(null===e||void 0===e||null===(l=e.data)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.dashboard)}catch(o){}g(!1)};(0,r.useEffect)((()=>{P(0)}),[]);const z=(0,r.useCallback)((e=>{E.current=e,f(e),j(0),D((a=>({...a,count:e,page:0}))),P(0,e)}),[P]);return console.log("totalCount",N),(0,b.jsxs)(b.Fragment,{children:[t&&(0,b.jsx)(d.A,{}),(0,b.jsx)("div",{className:"PageHeading",children:(0,b.jsx)("h1",{children:"AEPS Transaction Report"})}),(0,b.jsxs)("div",{className:"ContentArea",children:[(0,b.jsxs)("div",{className:"card",children:[(0,b.jsx)("div",{className:"card-header",children:" "}),(0,b.jsx)("div",{className:"card-body",children:(0,b.jsxs)("form",{action:"",method:"post",name:"frmReport",id:"frmReport",children:[(0,b.jsx)("input",{type:"hidden",id:"hidID",name:"hidID"}),(0,b.jsxs)("div",{className:"form-row",style:{alignItems:"end"},children:[(0,b.jsxs)("div",{className:"form-group col-md-4",children:[(0,b.jsx)("label",{htmlFor:"txtUserId",children:"Start Date"}),(0,b.jsx)("input",{type:"date",name:"start_date",id:"account_no",className:"form-control input-white-bg",max:e,value:O.start_date,onChange:R})]}),(0,b.jsxs)("div",{className:"form-group col-md-4",children:[(0,b.jsx)("label",{htmlFor:"txtUserId",children:"End Date"}),(0,b.jsx)("input",{type:"date",name:"end_date",id:"account_no",max:e,className:"form-control input-white-bg",value:O.end_date,onChange:R,min:O.start_date||void 0,onBlur:()=>{O.start_date&&O.end_date&&O.end_date<O.start_date&&(s.Ay.error("End date cannot be earlier than start date"),D((e=>({...e,end_date:e.start_date}))))}})]}),(0,b.jsxs)("div",{className:"form-group col-md-4",children:[(0,b.jsx)("label",{htmlFor:"customer_mobile",children:"Customer Mobile"}),(0,b.jsx)("input",{type:"number",name:"customer_mobile",id:"customer_mobile",className:"form-control bs-autofill-fix",placeholder:"Enter Customer Mobile",value:O.customer_mobile,onChange:R})]}),(0,b.jsxs)("div",{className:"form-group col-md-4",children:[(0,b.jsx)("label",{htmlFor:"adhaar_no",children:"Aadhaar Number"}),(0,b.jsx)("input",{type:"number",name:"adhaar_no",id:"adhaar_no",className:"form-control bs-autofill-fix",placeholder:"Enter Aadhaar Number",value:O.adhaar_no,onChange:R})]}),(0,b.jsxs)("div",{className:"form-group col-md-4",children:[(0,b.jsx)("label",{htmlFor:"txn_id",children:"Txn Id"}),(0,b.jsx)("input",{type:"text",name:"txn_id",id:"txn_id",className:"form-control bs-autofill-fix",placeholder:"Enter Txn Id",value:O.txn_id,onChange:R})]}),(0,b.jsxs)("div",{className:"form-group col-md-4",children:[(0,b.jsx)("label",{htmlFor:"status",children:"Status"}),(0,b.jsx)(l.A,{id:"status",style:{width:"100%"},value:O.status||"",onChange:e=>{D((a=>({...a,status:e})))},options:[{value:"",label:"All"},{value:"1",label:"Pending"},{value:"2",label:"Success"},{value:"3",label:"Failed"},{value:"4",label:"Refunded"}],allowClear:!1})]}),(0,b.jsxs)("div",{className:"form-group col-md-2",children:[(0,b.jsx)("label",{children:"\xa0"}),(0,b.jsx)("button",{type:"button",className:"btn btn-secondary mr-3",onClick:()=>{P(0),j(0)},children:"Search"}),(0,b.jsx)("button",{type:"button",className:"btn btn-light",onClick:async()=>{g(!0);const e={count:10,page:0,end_date:"",start_date:"",customer_mobile:"",adhaar_no:"",txn_id:"",sortType:"",sortKey:"",user_id:window.localStorage.getItem("userIdToken"),status:""};try{var a;const t=await(0,i.CCK)(e);w((null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.totalCount)||0),k(null===t||void 0===t?void 0:t.data),D({end_date:"",start_date:"",customer_mobile:"",adhaar_no:"",txn_id:"",status:""}),j(0)}catch(t){}g(!1)},children:"Reset"})]})]})]})})]}),(0,b.jsx)("div",{className:"card mt-4",style:{overflow:"auto"},children:(0,b.jsx)("div",{className:"card-body",children:(0,b.jsxs)("div",{id:"myTable_wrapper",className:"dataTables_wrapper no-footer",children:[(0,b.jsxs)("div",{className:"d-flex  justify-content-end align-items-center",children:[(0,b.jsxs)("div",{className:"dataTables_length mb-3",id:"myTable_length",children:[(0,b.jsx)(n.Ay,{className:"btn btn-success cusxel",onClick:async()=>{g(!0);const e={...O,count:y,page:_,min_amt:+O.min_amt,max_amt:+O.max_amt,user_id:window.localStorage.getItem("userIdToken")};try{var a,t;const l=await(0,i.LiT)(e),n=null===l||void 0===l||null===(a=l.data)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.dashboard;if(!n||0===n.length)return s.Ay.error("No data available to export."),void g(!1);W(n),setTimeout((()=>{document.getElementById("test-table-xls-button").click(),g(!1),s.Ay.success("Excel file download initiated.")}),100)}catch(l){console.error("Error preparing data for export:",l),s.Ay.error("Failed to prepare data for export. Please try again."),g(!1)}},disabled:t,style:{backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"8px",padding:"10px 24px",fontSize:"15px",fontWeight:"600",cursor:"pointer",minWidth:"160px",height:"42px",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",opacity:t?.7:1,transform:t?"none":"translateY(0)",":hover":{backgroundColor:"#059669",transform:"translateY(-1px)"},":active":{transform:"translateY(0)"},":disabled":{backgroundColor:"#9ca3af",cursor:"not-allowed"}},children:"Download Excel sheet"}),(0,b.jsx)(c.A,{id:"test-table-xls-button",className:"download-table-xls-button d-none",table:"table-to-xlsx",filename:"Aeps_Tx._Report",sheet:"Sheet1",buttonText:"Download Excel Sheet"})]}),(0,b.jsx)("div",{className:"dataTables_info_page"})]}),(0,b.jsx)("div",{id:"myTable_processing",className:"dataTables_processing",style:{display:"none"},children:"Processing..."}),(0,b.jsxs)("table",{style:{whiteSpace:"nowrap"},className:"table table-striped table-bordered table-hover display dataTable no-footer dtr-inline collapsed",id:"myTable",role:"grid","aria-describedby":"myTable_info",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{role:"row",children:[(0,b.jsx)("th",{className:"sorting",children:"S.No"}),(0,b.jsx)("th",{className:"sorting",onClick:()=>U("createdAt"),children:"Txn Date"}),(0,b.jsx)("th",{className:"sorting",children:"Txn Id"}),(0,b.jsx)("th",{className:"sorting",children:"Ack No"}),(0,b.jsx)("th",{className:"sorting",children:"Bank Name"}),(0,b.jsx)("th",{className:"sorting",children:"Service Type"}),(0,b.jsx)("th",{className:"sorting",children:"Opening Balance"}),(0,b.jsx)("th",{className:"sorting",children:"Amount"}),(0,b.jsx)("th",{className:"sorting",children:"Closing Balance"}),(0,b.jsx)("th",{className:"sorting",children:"Status"}),(0,b.jsx)("th",{className:"sorting",children:"Aadhaar Number"}),(0,b.jsx)("th",{className:"sorting",children:"Customer Mobile"}),(0,b.jsx)("th",{className:"sorting",children:"Message"}),(0,b.jsx)("th",{className:"sorting",children:"Status update At"}),(0,b.jsx)("th",{className:"sorting",children:"Enquiry"}),(0,b.jsx)("th",{className:"sorting",children:"Invoice"}),(0,b.jsx)("th",{className:"sorting",children:"Dispute"})]})}),(0,b.jsx)("tbody",{children:T&&T.data&&T.data.length>0?T.data.map(((e,a)=>{var t,l;const o={1:{class:"warning",text:"Pending"},2:{class:"success",text:"Success"},3:{class:"danger",text:"Failed"},4:{class:"light",text:"Refunded"}},r=(null===(t=o[null===e||void 0===e?void 0:e.response])||void 0===t?void 0:t.class)||"secondary",i=(null===(l=o[null===e||void 0===e?void 0:e.response])||void 0===l?void 0:l.text)||"Unknown",d={CD:"Cash Deposit",BE:"Balance Enquiry",MS:"Mini Statement",CW:"Cash Withdrawal",AP:"Aadhar Pay"}[e.type]||e.type;return(0,b.jsxs)("tr",{className:"odd",children:[(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:a+1+_*y}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.createdAt}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.txn_id}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.ack_no}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.bank_name}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:d}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.opening_balance}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.amount}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.closing_balance}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:(0,b.jsx)("button",{className:"btn btn-".concat(r," btn-sm"),style:{width:"130px"},children:i})}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.last_adhar}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:(null===e||void 0===e?void 0:e.customer_mobile)||"N/A"}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:(null===e||void 0===e?void 0:e.message)||""}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.status_update_time}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:["CW","CD","AP"].includes(e.type)&&(0,b.jsx)(n.Ay,{onClick:()=>(async(e,a)=>{let t="";switch(e){case"CW":case"CD":t="".concat(x.pc,"aeps/enquiry/").concat(a);break;case"AP":t="".concat(x.pc,"aeps/adhaarpay/enquiry/").concat(a);break;default:return void console.error("Invalid transaction type for inquiry")}try{var l;g(!0);const e=await v.A.get(t,{headers:{"Content-type":"application/json; charset=UTF-8",Authorization:"Bearer ".concat(window.localStorage.getItem("userToken"))}}),a=e.data;console.log("data",a);const n=(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.message)||(null===e||void 0===e?void 0:e.message);switch(e.data.statusCode){case 200:s.Ay.success(n||"successful"),await P(_);break;case 300:s.Ay.info(n||"pending"),await P(_);break;case 400:s.Ay.error(n||"failed");break;default:s.Ay.error(n||"Unknown status")}}catch(i){var n,o,r;console.error("Inquiry error:",i),p.oR.error((null===(n=i.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message)||(null===(r=i.response)||void 0===r?void 0:r.message)||"An error occurred during inquiry")}finally{g(!1)}})(e.type,e._id),disabled:1!==(null===e||void 0===e?void 0:e.response),children:"Enquiry"})}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:(0,b.jsx)(n.Ay,{icon:(0,b.jsx)(u.A,{}),onClick:()=>{return a=null===e||void 0===e?void 0:e._id,void A("/aeps-invoice/".concat(a));var a}})}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:(0,b.jsxs)(m.N_,{className:"btn btn-primary",to:"/add-ticket/".concat(null===e||void 0===e?void 0:e._id),state:{item:e,serviceId:"65f9484a26eb74e182c640fc"},children:[" ",(0,b.jsx)("span",{style:{color:"var(--bs-primary2)"},children:"Dispute"})]})})]},null===e||void 0===e?void 0:e._id)})):(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"12",className:"text-center",children:"No records found"})})})]}),(0,b.jsxs)("div",{className:"dataTables_info_page",children:[(0,b.jsxs)("div",{className:"d-flex align-items-center",children:[(0,b.jsxs)("div",{className:"dataTables_length me-3",children:[(0,b.jsx)("label",{className:"me-2",children:"Show"}),(0,b.jsx)(l.A,{value:y,onChange:z,style:{width:120},options:[{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:50,label:"50 / page"},{value:100,label:"100 / page"}]})]}),(0,b.jsxs)("div",{className:"dataTables_info",id:"empoloyees-tblwrapper_info",role:"status","aria-live":"polite",children:["Total ",N," entries"]})]}),(0,b.jsx)("div",{className:"dataTables_paginate paging_simple_numbers",id:"empoloyees-tblwrapper_paginate",children:(0,b.jsx)(o.A,{current:_+1,onChange:e=>{console.log("newpage",e-1),j(e-1),P(e-1)},total:N,pageSize:y,showSizeChanger:!1})})]})]})})})]}),(0,b.jsxs)("table",{className:"table table-striped table-bordered table-hover display dataTable no-footer dtr-inline collapsed d-none",id:"table-to-xlsx",role:"grid","aria-describedby":"myTable_info",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{role:"row",children:[(0,b.jsx)("th",{className:"sorting",onClick:()=>U("createdAt"),children:"Created Date"}),(0,b.jsx)("th",{className:"sorting",children:"Txn Id"}),(0,b.jsx)("th",{className:"sorting",children:"Ack No"}),(0,b.jsx)("th",{className:"sorting",children:"Customer Mobile"}),(0,b.jsx)("th",{className:"sorting",children:"Bank"}),(0,b.jsx)("th",{className:"sorting",children:"Type"}),(0,b.jsx)("th",{className:"sorting",children:"Balance Amount"}),(0,b.jsx)("th",{className:"sorting",children:"Amount"}),(0,b.jsx)("th",{className:"sorting",children:"Aadhaar Number"}),(0,b.jsx)("th",{className:"sorting",children:"Commission"}),(0,b.jsx)("th",{className:"sorting",children:"Message"}),(0,b.jsx)("th",{className:"sorting",children:"Status"}),(0,b.jsx)("th",{className:"sorting",children:"Status Update At"})]})}),(0,b.jsx)("tbody",{children:I&&(null===I||void 0===I?void 0:I.map((e=>{var a,t;const s={1:{class:"warning",text:"Pending"},2:{class:"success",text:"Success"},3:{class:"danger",text:"Failed"},4:{class:"light",text:"Refunded"}},l=(null===(a=s[null===e||void 0===e?void 0:e.response])||void 0===a||a.class,(null===(t=s[null===e||void 0===e?void 0:e.response])||void 0===t?void 0:t.text)||"Unknown"),n={CD:"Cash Deposit",BE:"Balance Enquiry",MS:"Mini Statement",CW:"Cash Withdrawal",AP:"Aadhar Pay"}[e.type]||e.type;return(0,b.jsxs)("tr",{className:"odd",children:[(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.createdAt}),(0,b.jsx)("th",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.txn_id}),(0,b.jsx)("th",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.ack_no}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.customer_mobile}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.bank_name}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:n}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.bal_amount}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.amount}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.last_adhar}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.commission}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.message}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:l}),(0,b.jsx)("td",{valign:"top",className:"dataTables_empty",children:null===e||void 0===e?void 0:e.status_update_time})]},null===e||void 0===e?void 0:e._id)})))})]})]})};const y=function(){return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(g,{})})}},76191:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var s=t(58168),l=t(65043);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"};var o=t(22172),r=function(e,a){return l.createElement(o.A,(0,s.A)({},e,{ref:a,icon:n}))};const i=l.forwardRef(r)},41497:(e,a,t)=>{"use strict";var s=t(13218);function l(){}function n(){}n.resetWarningCache=l,e.exports=function(){function e(e,a,t,l,n,o){if(o!==s){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}function a(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:a,element:e,elementType:e,instanceOf:a,node:e,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:l};return t.PropTypes=t,t}},65173:(e,a,t)=>{e.exports=t(41497)()},13218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},95702:(e,a,t)=>{"use strict";var s=function(){function e(e,a){for(var t=0;t<a.length;t++){var s=a[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(a,t,s){return t&&e(a.prototype,t),s&&e(a,s),a}}(),l=t(65043),n=r(l),o=r(t(65173));function r(e){return e&&e.__esModule?e:{default:e}}var i={table:o.default.string.isRequired,filename:o.default.string.isRequired,sheet:o.default.string.isRequired,id:o.default.string,className:o.default.string,buttonText:o.default.string},d=function(e){function a(e){!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.handleDownload=t.handleDownload.bind(t),t}return function(e,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,e),s(a,[{key:"handleDownload",value:function(){if(!document)return null;if(1!==document.getElementById(this.props.table).nodeType||"TABLE"!==document.getElementById(this.props.table).nodeName)return null;var e=document.getElementById(this.props.table).outerHTML,t=String(this.props.sheet),s=String(this.props.filename)+".xls",l={worksheet:t||"Worksheet",table:e};if(window.navigator.msSaveOrOpenBlob){var n=new Blob(['<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>'+e+"</body></html>"]);return document.getElementById("react-html-table-to-excel").click()((function(){window.navigator.msSaveOrOpenBlob(n,s)})),!0}var o=window.document.createElement("a");return o.href="data:application/vnd.ms-excel;base64,"+a.base64(a.format('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>{table}</body></html>',l)),o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),!0}},{key:"render",value:function(){return n.default.createElement("button",{id:this.props.id,className:this.props.className,type:"button",onClick:this.handleDownload},this.props.buttonText)}}],[{key:"base64",value:function(e){return window.btoa(unescape(encodeURIComponent(e)))}},{key:"format",value:function(e,a){return e.replace(/{(\w+)}/g,(function(e,t){return a[t]}))}}]),a}(l.Component);d.propTypes=i,d.defaultProps={id:"button-download-as-xls",className:"button-download",buttonText:"Download"},a.A=d}}]);
//# sourceMappingURL=6836.3abf2506.chunk.js.map