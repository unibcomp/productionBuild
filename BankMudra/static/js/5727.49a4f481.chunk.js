"use strict";(self.webpackChunkpaymaster=self.webpackChunkpaymaster||[]).push([[5727],{88175:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var l=a(65043),s=a(48555),r=a.n(s),i=a(95922),n=a(91036),o=a(73216),c=a(73575),d=a(94414),m=a(70579);const u=function(e){let{placeholder:t}=e;const a=(0,o.Zp)(),s=(0,o.zy)(),u=((0,o.g)(),(0,l.useRef)(null)),[v,p]=(0,l.useState)(),[h,x]=(0,l.useState)([]),[f,j]=(0,l.useState)([]),[y,b]=(0,l.useState)([]),[g,N]=(0,l.useState)({name:"",email:"",phone:""}),[w,C]=(0,l.useState)({type:"",subject:"",service_id:"",priority:"",description:"",attachments:[]}),[S,k]=(0,l.useState)([]);(0,l.useEffect)((()=>p(s.state)),[s]),(0,l.useEffect)((()=>{_(),E(),z()}),[]),(0,l.useEffect)((()=>{C((e=>({...e,service_id:null===v||void 0===v?void 0:v.serviceId})))}),[null===v||void 0===v?void 0:v.serviceId]);const O=e=>{C((t=>({...t,[e.target.name]:e.target.value})))},_=async()=>{try{var e;const t=await(0,c.LiJ)();x((null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data)||[])}catch{}},E=async()=>{try{var e;const t=await(0,c.CDu)();j((null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.data)||[])}catch{}},z=async()=>{try{var e,t,a,l,s;const r=await(0,c.VBp)(),i=await(0,c.qMm)();let n=(null===r||void 0===r||null===(e=r.data)||void 0===e?void 0:e.data)||[];null!==d.wV&&void 0!==d.wV&&d.wV.includes(null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.mobile)&&(n=n.filter((e=>"Courier"===e.service_name))),b(n),N({email:null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a.email,name:null===i||void 0===i||null===(l=i.data)||void 0===l?void 0:l.name,phone:null===i||void 0===i||null===(s=i.data)||void 0===s?void 0:s.mobile})}catch{}};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"PageHeading mb-4",children:(0,m.jsx)("h1",{className:"fw-bold",children:"Add Ticket"})}),(0,m.jsx)("div",{className:"ContentArea",children:(0,m.jsxs)("div",{className:"card shadow-sm rounded-4 p-4",children:[(0,m.jsx)("h5",{className:"mb-4 fw-semibold",children:"Open Ticket"}),(0,m.jsx)("form",{children:(0,m.jsxs)("div",{className:"row g-3",children:[["name","email","phone"].map(((e,t)=>(0,m.jsxs)("div",{className:"col-md-4",children:[(0,m.jsxs)("label",{className:"form-label text-secondary text-uppercase",children:[e," ",(0,m.jsx)("span",{className:"text-danger",children:"*"})]}),(0,m.jsx)("input",{type:"email"===e?"email":"text",className:"form-control",disabled:!0,value:g[e]})]},t))),(0,m.jsxs)("div",{className:"col-md-8",children:[(0,m.jsxs)("label",{className:"form-label text-secondary text-uppercase",children:["Subject ",(0,m.jsx)("span",{className:"text-danger",children:"*"})]}),(0,m.jsx)("input",{type:"text",name:"subject",className:"form-control",placeholder:"Enter Subject",value:w.subject,onChange:O})]}),(0,m.jsxs)("div",{className:"col-md-4",children:[(0,m.jsx)("label",{className:"form-label text-secondary text-uppercase",children:"Department *"}),(0,m.jsxs)("select",{className:"form-select",name:"type",onChange:O,value:w.type,children:[(0,m.jsx)("option",{disabled:!0,children:"Select Type"}),h.map((e=>(0,m.jsx)("option",{value:e._id,children:e.department},e._id)))]})]}),(0,m.jsxs)("div",{className:"col-md-4",children:[(0,m.jsx)("label",{className:"form-label text-secondary text-uppercase",children:"Related Service *"}),(0,m.jsxs)("select",{className:"form-select",name:"service_id",value:w.service_id,onChange:O,children:[(0,m.jsx)("option",{disabled:!0,children:"Select Service"}),y.map((e=>(0,m.jsx)("option",{value:e._id,children:e.service_name},e._id)))]})]}),(0,m.jsxs)("div",{className:"col-md-4",children:[(0,m.jsx)("label",{className:"form-label text-secondary text-uppercase",children:"Priority *"}),(0,m.jsxs)("select",{className:"form-select",name:"priority",value:w.priority,onChange:O,children:[(0,m.jsx)("option",{disabled:!0,children:"Select Priority"}),f.map((e=>(0,m.jsx)("option",{value:e._id,children:e.priority},e._id)))]})]}),(0,m.jsxs)("div",{className:"col-12",children:[(0,m.jsx)("label",{className:"form-label text-secondary text-uppercase",children:"Message *"}),(0,m.jsx)(r(),{ref:u,value:w.description,onChange:e=>C({...w,description:e}),className:"shadow-sm rounded-3 border"})]}),(0,m.jsxs)("div",{className:"col-md-8",children:[(0,m.jsx)("label",{className:"form-label text-secondary text-uppercase",children:"Attachments"}),(0,m.jsx)("input",{type:"file",className:"form-control mb-2",multiple:!0,onChange:async e=>{const t=new FormData,a=Array.from(e.target.files),l=["image/png","image/jpeg","image/jpg","image/gif","video/mp4"];for(let i of a)if(l.includes(i.type))try{var s;t.append("image",i);const e=await(0,c.zGb)(t);null!==e&&void 0!==e&&null!==(s=e.data)&&void 0!==s&&s.error||k((t=>{var a,l;return[...t,{id:Math.random(),url:null===e||void 0===e||null===(a=e.data)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.url}]}))}catch(r){n.oR.error("Upload failed!")}else n.oR.error("Only images and mp4 videos are allowed!")}})]}),(0,m.jsx)("div",{className:"col-md-12 d-flex flex-wrap gap-2",children:S.map((e=>(0,m.jsxs)("div",{className:"position-relative",style:{width:"100px",height:"100px"},children:[(0,m.jsx)("img",{src:"".concat(d.cu).concat(e.url),className:"rounded-2 shadow-sm",style:{width:"100%",height:"100%",objectFit:"cover"}}),(0,m.jsx)(i.TCu,{onClick:()=>{return t=e.id,void k((e=>e.filter((e=>e.id!==t))));var t},className:"position-absolute top-0 end-0 text-danger",style:{cursor:"pointer",fontSize:"1.2rem"}})]},e.id)))}),(0,m.jsx)("div",{className:"col-md-2 mt-3",children:(0,m.jsx)("button",{type:"button",className:"btn btn-primary w-100",onClick:async()=>{const e={...w,description:u.current.value,attachments:S.map((e=>e.url)),user_id:window.localStorage.getItem("userIdToken")};try{var t,l;const r=await(0,c.ieO)(e);var s;if(null!==r&&void 0!==r&&null!==(t=r.data)&&void 0!==t&&t.error)n.oR.error(null===r||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message);else n.oR.success(null===r||void 0===r||null===(s=r.data)||void 0===s?void 0:s.message),setTimeout((()=>a("/list-tickets")),2e3)}catch{}},disabled:!w.subject||!w.description||!w.priority||!w.type||!w.service_id,children:"Create Ticket"})})]})})]})}),(0,m.jsx)(n.N9,{position:"top-center",autoClose:2e3})]})};const v=function(){return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)(u,{})})}},66688:(e,t,a)=>{a.d(t,{k5:()=>c});var l=a(65043),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},r=l.createContext&&l.createContext(s),i=function(){return i=Object.assign||function(e){for(var t,a=1,l=arguments.length;a<l;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},i.apply(this,arguments)},n=function(e,t){var a={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(l=Object.getOwnPropertySymbols(e);s<l.length;s++)t.indexOf(l[s])<0&&Object.prototype.propertyIsEnumerable.call(e,l[s])&&(a[l[s]]=e[l[s]])}return a};function o(e){return e&&e.map((function(e,t){return l.createElement(e.tag,i({key:t},e.attr),o(e.child))}))}function c(e){return function(t){return l.createElement(d,i({attr:i({},e.attr)},t),o(e.child))}}function d(e){var t=function(t){var a,s=e.attr,r=e.size,o=e.title,c=n(e,["attr","size","title"]),d=r||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),l.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,c,{className:a,style:i(i({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),o&&l.createElement("title",null,o),e.children)};return void 0!==r?l.createElement(r.Consumer,null,(function(e){return t(e)})):t(s)}}}]);
//# sourceMappingURL=5727.49a4f481.chunk.js.map