import{u as p,a as j,r as y,j as e,L as N,V as l,i as w,b as v,g as M}from"./index.CQ1mGLNM.js";import{u as L,a as P}from"./useCreateAndGetPaymentLink.D2bHQjU1.js";const i=M(),q=w[i==null?void 0:i.reseller_name]||v,A=()=>{const[d]=p(),n=d.get("payment_session_id"),{data:r,isLoading:u,isError:c}=L(n||""),s=r==null?void 0:r.data,{register:o,handleSubmit:b,formState:{errors:t},reset:m}=j(),x=P();y.useEffect(()=>{r&&m({customerName:(s==null?void 0:s.customerName)||"",mobile:(s==null?void 0:s.PhoneNumber)||"",amount:0,paymentMethod:""})},[r,m]);const h=a=>{if(!n){console.error("Missing payment_session_id");return}const g={amount:a.amount,payment_session_id:n,paymentMethod:a.paymentMethod};x.mutate(g,{onSuccess:f=>{l.success("payment request completed succesFully"),window.open(f.url,"_self")},onError:()=>{l.error("failed to initt")}}),m()};return u?e.jsx(N,{}):c?(l.error("Failed to fetch payment data."),e.jsx("div",{className:"text-center text-red-600 font-semibold mt-20",children:"Something went wrong while loading the payment form."})):e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 bg-gray-50",children:e.jsxs("div",{className:"w-full max-w-4xl border-2 border-gray-300 rounded-2xl p-6 sm:p-8 shadow-sm relative bg-white",children:[e.jsx("div",{className:"absolute -top-8 left-6",children:e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden shadow-md border-4 border-white bg-white",children:e.jsx("img",{src:q,alt:"Reseller Logo",className:"w-full h-full object-cover"})})}),e.jsx("h2",{className:"text-2xl font-bold text-blue-700 mb-6 text-center mt-4 sm:mt-0",children:"Payment Details"}),e.jsxs("form",{onSubmit:b(h),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"tel",...o("mobile",{required:"Mobile number is required",pattern:{value:/^[6-9]\d{9}$/,message:"Enter a valid 10-digit mobile number"}}),disabled:!!(s!=null&&s.PhoneNumber),className:`w-full px-4 py-2 rounded-xl border ${t.mobile?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),t.mobile&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.mobile.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Customer Name"}),e.jsx("input",{type:"text",disabled:!!(s!=null&&s.customerName),...o("customerName",{required:"Customer name is required"}),className:`w-full px-4 py-2 rounded-xl border ${t.customerName?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),t.customerName&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.customerName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",...o("amount",{required:"Amount is required",valueAsNumber:!0,min:{value:1,message:"Amount must be at least 1"}}),className:`w-full px-4 py-2 rounded-xl border ${t.amount?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`}),t.amount&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.amount.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Payment Method"}),e.jsx("select",{...o("paymentMethod",{required:"Payment method is required"}),className:`w-full px-4 py-2 rounded-xl border ${t.paymentMethod?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:(s==null?void 0:s.paymentMetod)==="ALL"?e.jsx(e.Fragment,{children:e.jsx("option",{value:"ALL",selected:!0,children:"ALL"})}):e.jsx("option",{value:s==null?void 0:s.paymentMetod,selected:!0,children:s==null?void 0:s.paymentMetod})}),t.paymentMethod&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.paymentMethod.message})]})]}),e.jsx("button",{type:"submit",className:"mt-12 w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-xl shadow transition-all",children:"Submit Payment"})]})]})})};export{A as default};
