import{a as P,b as S,r as m,j as e,m as T,d as z}from"./index.BV23clpT.js";import{P as O}from"./ProductCard.B9uPuqlI.js";import{u as K,P as M}from"./usePagination.CopvNDwc.js";import{N as D}from"./NotDataFound.DWGsRwwZ.js";import{K as b,h as N,u as E,P as H}from"./dialog.BELqWu_E.js";const A=async s=>{const{data:t}=await S.get("/get-product",{params:s});return t},B=async s=>{const{data:t}=await S.get(`/product-details/${s}`);return t},R=({category:s,subcategory:t,brand:r,_id:a,pageSize:c=10,pageNumber:l=1,sort:x})=>{const n={pageSize:c,pageNumber:l,...s&&{category:s},...t&&{subcategory:t},...r&&{brand:r},...a&&{_id:a},...x&&{sort:x}};return P({queryKey:["products",n],queryFn:()=>A(n)})},re=s=>P({queryKey:["product",s],queryFn:()=>B(s),enabled:!!s,staleTime:1e3*60*5}),V=()=>{const[s,t]=m.useState({}),[r,a]=m.useState("relevance");return{filters:s,setFilters:t,sorts:r,setSorts:a}},I=async s=>{const{data:t}=await S.get("/filters",{params:s});return t},Q=({category:s="",subcategory:t=""})=>{const r={...s&&{category:s},...t&&{subcategory:t}};return P({queryKey:["filters"],queryFn:()=>I(r),staleTime:300*1e3})},_=({filters:s,setFilters:t,isMobile:r=!1,category:a,subcategory:c,handleClose:l})=>{const[x,n]=m.useState(s),[i,d]=m.useState({}),{data:g,isLoading:j}=Q({category:a,subcategory:c}),y=o=>{d(u=>({...u,[o]:!u[o]}))},f=(o,u)=>{u!==void 0&&n(h=>{const p=h[o]||[],w=p.includes(u)?p.filter(F=>F!==u):[...p,u];return{...h,[o]:w}})};return j?e.jsx(T,{isNotFixed:!0}):e.jsxs("div",{className:`p-4 space-y-3 ${r?"":"border-b border-gray-200"} max-h-[80vh] overflow-y-auto custom-scroll bg-white rounded-md shadow-sm`,children:[!r&&e.jsx("h2",{className:"text-lg font-semibold mb-3 border-b pb-2 text-gray-800",children:"Filters"}),g?.results?.length?e.jsxs(e.Fragment,{children:[g.results.map(o=>e.jsx(U,{label:G(o.name),queryName:o.queryName,items:o.value||[],open:i[o.queryName]||!1,onToggle:()=>y(o.queryName),filters:x,onFilterToggle:f},o.queryName)),e.jsx("div",{className:"sticky bottom-0 bg-white p-4 border-t",children:e.jsx("button",{className:"w-full py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",onClick:()=>{t(x),l?.()},children:"Apply Filters"})})]}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No filters available."})]})},U=({label:s,queryName:t,items:r,open:a,onToggle:c,filters:l,onFilterToggle:x})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center font-semibold mb-2 px-3 py-2 border rounded-lg cursor-pointer hover:bg-gray-100",onClick:c,role:"button",tabIndex:0,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),c())},children:[s,e.jsx("span",{className:"material-symbols-outlined",children:a?"expand_more":"arrow_forward_ios"})]}),a&&e.jsx("div",{className:"pl-4 max-h-[40vh] custom-scroll overflow-auto",children:r.map(n=>{const i=n._id||n.name||"",d=l[t]?.includes(i)||!1;return e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"checkbox",className:"mr-2 cursor-pointer",onChange:()=>x(t,i),checked:d,id:`${t}-${i}`}),e.jsx("label",{htmlFor:`${t}-${i}`,className:"select-none cursor-pointer",children:n.name})]},i)})})]}),G=s=>s.charAt(0).toUpperCase()+s.slice(1),L=({close:s,sort:t,setSort:r})=>{const a=[{label:"Relevance",value:"relevance"},{label:"Price: Low to High",value:"lowToHigh"},{label:"Price: High to Low",value:"highToLow"}],c=l=>{r(l),s?.()};return e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 border-b pb-2 text-gray-800",children:"Sort"}),a.map(l=>e.jsx("button",{onClick:()=>c(l.value),className:`w-full px-4 py-2 text-left rounded-md ${t===l.value?"bg-blue-100 text-blue-800":"hover:bg-gray-100"}`,children:l.label},l.value))]})},J=({show:s,filters:t,setFilters:r,handleClose:a,category:c,subcategory:l})=>e.jsx(b,{appear:!0,show:s,as:m.Fragment,children:e.jsxs(N,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(b.Child,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(b.Child,{as:m.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(N.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(_,{filters:t,setFilters:r,category:c,subcategory:l,handleClose:a})})]})})})})]})}),W=({show:s,handleClose:t,sort:r,setSort:a})=>e.jsx(b,{appear:!0,show:s,as:m.Fragment,children:e.jsxs(N,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(b.Child,{as:m.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(b.Child,{as:m.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(N.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Sort By"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-800",children:"✕"})]}),e.jsx(L,{close:t,sort:r,setSort:a})]})})})})]})}),X=({category:s,subcategory:t,title:r,horizontal:a=!1,brand:c,showFilters:l=!1,isFullDetail:x=!1})=>{const[n]=z(),i=n.get("category"),d=n.get("subcategory"),g=n.get("brand"),{openModal:j,closeModal:y,isModalOpen:f}=E(),{filters:o,setFilters:u,sorts:h,setSorts:p}=V();console.log(o);const{handlePageChange:w,handlePageSizeChange:F,pageNumber:C,pageSizeValue:k}=K(),{data:v,isLoading:$,isError:q}=R({category:i||s,subcategory:d||t,brand:g||c,pageNumber:C,pageSize:k,...o,sort:h});return console.log(d),e.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[e.jsxs("div",{className:"mx-auto sm:px-8 py-6 grid grid-cols-1 md:grid-cols-4 gap-6",children:[l&&e.jsxs("aside",{className:"hidden md:block md:col-span-1 md:sticky md:top-24 md:self-start bg-white rounded-lg shadow-md border border-gray-200",children:[e.jsx(_,{filters:o,setFilters:u,category:i||s,subcategory:d||t}),e.jsx(L,{sort:h,setSort:p})]}),$?e.jsx(T,{isNotFixed:!0}):q||v?.results&&v?.results.length<1?e.jsx(D,{}):e.jsxs("main",{className:`col-span-1 ${l?"md:col-span-3":"md:col-span-4"}`,children:[r&&e.jsx(H,{title:r||"Product"}),e.jsx(Y,{data:v?.results||[],horizontal:a,isFullDetail:x}),!a&&e.jsx(M,{handlePageChange:w,handlePageSizeChange:F,currentPage:C,pageSize:k,totalCount:v?.pagination?.total||0})]})]}),e.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-lg border-t border-gray-200 flex justify-between items-center px-4 py-3",children:l&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex-1 mr-2 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>j({isSort:!0}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"sort"})," Sort"]}),e.jsxs("button",{className:"flex-1 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>j({isFilter:!0},{}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"filter_list"})," Filter"]})]})}),e.jsx(J,{show:f?.isFilter||!1,handleClose:()=>{y({isFilter:!1})},filters:o,setFilters:u,category:i||s,subcategory:d||t},f?.isFilter+""),e.jsx(W,{show:f.isSort||!1,setSort:p,sort:h,handleClose:()=>y({isSort:!1})})]},[i||"",d||"",g||""].join("-"))},Y=({data:s,horizontal:t=!1,isFullDetail:r=!1})=>e.jsx("div",{className:t?"flex overflow-x-auto space-x-4 pb-2":"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:s.map(a=>e.jsx("div",{className:t?"min-w-[400px] flex-shrink-0":"",children:e.jsx(O,{product:a,isFullDetail:r})},a._id))}),le=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as P,le as a,re as u};
