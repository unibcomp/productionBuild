import{a as P,b as C,j as e,L as E,r as g,m as $,e as I,d as K}from"./index.Bd5MI6R0.js";import{W as D}from"./WishlistButton.C1CkPDOl.js";import{u as H,P as W}from"./usePagination.QrYJxrfP.js";import{N as R}from"./NotDataFound.BRQx-lng.js";import{K as v,h as F,P as V,B as A}from"./ButtonBar.u13QKf1I.js";import{u as Q}from"./useModal.DKJnSpQf.js";const U=async s=>{const{data:t}=await C.get("/get-product",{params:s});return t},G=async s=>{const{data:t}=await C.get(`/product-details/${s}`);return t},J=({category:s,subcategory:t,brand:r,_id:a,pageSize:i=10,pageNumber:l=1,sort:h,slug:o,exclude:m,size:c=[],colour:x=[]})=>{const u={pageSize:i,pageNumber:l,...s&&{category:s},...t&&{subcategory:t},...r&&{brand:r},...a&&{_id:a},...h&&{sort:h},...o&&{slug:o},...m&&{exclude:m},...c.length>0&&{size:c},...x.length>0&&{colour:x}};return P({queryKey:["products",u],queryFn:()=>U(u)})},ue=s=>P({queryKey:["product",s],queryFn:()=>G(s),enabled:!!s,staleTime:1e3*60*5}),X=({product:s,isFullDetail:t})=>{const r=s.variant?s.variant.images[0]:void 0,a=`/product/detail/${s._id}?variant=${s.variant?._id}&size=${s.variant?.size?._id}`;return e.jsxs("div",{className:"border rounded-lg shadow-sm hover:shadow-md p-3 relative",children:[e.jsx(D,{productId:s._id,variantId:s.variant?._id,isInWishlist:s.isInWishlist}),e.jsxs(E,{to:a,className:"block",children:[r?e.jsx("img",{src:r,alt:s.name,className:"w-full h-40 object-contain rounded-md"}):e.jsx("div",{className:"w-full h-40 bg-gray-200 flex items-center justify-center rounded-md text-gray-500 text-sm",children:"No Image"}),e.jsx("h3",{className:"text-sm font-semibold mt-2 truncate",children:s.name}),e.jsx("p",{className:"text-gray-700 font-bold",children:s.brand.name}),e.jsxs("div",{className:"flex",children:[e.jsxs("p",{className:"text-gray-700 font-bold",children:["₹ ",Number(s.variant?.size?.sell_price).toFixed(2)]}),s.variant?.size&&s.variant?.size?.original_price>s.variant?.size?.sell_price&&e.jsxs("p",{className:"text-gray-500 text-xs line-through flex mt-2 ml-1",children:["₹"," ",Number(s.variant?.size?.original_price).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center bg-green-600 text-white px-1.5 py-0.5 rounded-sm font-semibold",children:[e.jsx("span",{children:s?.ratings?.average.toFixed(1)}),e.jsx("span",{className:"material-symbols-outlined text-xs ml-1",children:"star"})]}),e.jsxs("span",{className:"text-gray-500 font-medium",children:[s?.ratings?.count," Ratings"]})]}),t&&e.jsx("div",{className:"mt-2",children:e.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-700 text-sm",children:s.variant?.size?.highlights?.map((i,l)=>e.jsx("li",{className:"truncate overflow-hidden whitespace-nowrap w-full",title:i,children:i},l))})})]})]})},Y=()=>{const[s,t]=g.useState({}),[r,a]=g.useState("relevance");return{filters:s,setFilters:t,sorts:r,setSorts:a}},Z=async s=>{const{data:t}=await C.get("/filters",{params:s});return t},ee=({category:s="",subcategory:t="",brand:r="",slug:a=""})=>{const i={...s&&{category:s},...t&&{subcategory:t},...r&&{brand:r},...a&&{slug:a}};return P({queryKey:["filters",i],queryFn:()=>Z(i),staleTime:300*1e3})},z=({filters:s,setFilters:t,isMobile:r=!1,category:a,subcategory:i,brand:l,slug:h})=>{const[o,m]=g.useState({}),{data:c,isLoading:x}=ee({category:a,subcategory:i,brand:l,slug:h});g.useEffect(()=>{t({})},[l]);const u=n=>{m(d=>({...d,[n]:!d[n]}))},p=(n,d)=>{d!==void 0&&t(f=>{if(n.toLowerCase()==="brand"){const b=f.brand||[];return{brand:b.includes(d)?b.filter(N=>N!==d):[...b,d]}}const j=f[n]||[],y=j.includes(d)?j.filter(b=>b!==d):[...j,d];return{...f,[n]:y}})};return x?e.jsx($,{isNotFixed:!0}):e.jsxs("div",{className:`p-4 space-y-3 ${r?"":"border-b border-gray-200"} max-h-[80vh] overflow-y-auto custom-scroll bg-white rounded-md shadow-sm`,children:[!r&&e.jsx("h2",{className:"text-lg font-semibold mb-3 border-b pb-2 text-gray-800",children:"Filters"}),c?.results?.length?e.jsx(e.Fragment,{children:c.results.map(n=>e.jsx(se,{label:te(n.name),queryName:n.queryName,items:n.value||[],open:o[n.queryName]||!1,onToggle:()=>u(n.queryName),filters:s,onFilterToggle:p},n.queryName))}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No filters available."})]})},se=({label:s,queryName:t,items:r,open:a,onToggle:i,filters:l,onFilterToggle:h})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center font-semibold mb-2 px-3 py-2 border rounded-lg cursor-pointer hover:bg-gray-100",onClick:i,role:"button",tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),i())},children:[s,e.jsx("span",{className:"material-symbols-outlined",children:a?"expand_more":"arrow_forward_ios"})]}),a&&e.jsx("div",{className:"pl-4 max-h-[40vh] custom-scroll overflow-auto",children:r.map(o=>{const m=o._id||o.name||"",c=l[t]?.includes(m)||!1;return e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"checkbox",className:"mr-2 cursor-pointer",onChange:()=>h(t,m),checked:c,id:`${t}-${m}`}),e.jsx("label",{htmlFor:`${t}-${m}`,className:"select-none cursor-pointer",children:o.name})]},m)})})]}),te=s=>s.charAt(0).toUpperCase()+s.slice(1),L=({close:s,sort:t,setSort:r})=>{const a=[{label:"Relevance",value:"relevance"},{label:"Price: Low to High",value:"lowToHigh"},{label:"Price: High to Low",value:"highToLow"}],i=l=>{r(l),s?.()};return e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 border-b pb-2 text-gray-800",children:"Sort"}),a.map(l=>e.jsx("button",{onClick:()=>i(l.value),className:`w-full px-4 py-2 text-left rounded-md ${t===l.value?"bg-blue-100 text-blue-800":"hover:bg-gray-100"}`,children:l.label},l.value))]})},ae=({show:s,filters:t,setFilters:r,handleClose:a,category:i,subcategory:l,brand:h,slug:o})=>e.jsx(v,{appear:!0,show:s,as:g.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(v.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(v.Child,{as:g.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(F.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(z,{filters:t,setFilters:r,category:i,subcategory:l,handleClose:a,brand:h,slug:o,isMobile:!0})})]})})})})]})}),re=({show:s,handleClose:t,sort:r,setSort:a})=>e.jsx(v,{appear:!0,show:s,as:g.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(v.Child,{as:g.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(v.Child,{as:g.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(F.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Sort By"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-800",children:"✕"})]}),e.jsx(L,{close:t,sort:r,setSort:a})]})})})})]})}),le=({category:s,subcategory:t,title:r,horizontal:a=!1,brand:i,showFilters:l=!1,isFullDetail:h=!1,exclude:o})=>{const m=I(),[c]=K(),x=c.get("category"),u=c.get("subcategory"),p=c.get("slug"),n=c.get("brand"),d=c.get("exclude"),{openModal:f,closeModal:j,isModalOpen:y}=Q(),{filters:b,setFilters:S,sorts:N,setSorts:_}=Y(),{handlePageChange:B,handlePageSizeChange:O,pageNumber:k,pageSizeValue:T}=H(),{data:w,isLoading:M,isError:q}=J({category:x||s,subcategory:u||t,brand:n||i,pageNumber:k,pageSize:T,...b,slug:p?String(p):void 0,sort:N,exclude:d||o});return g.useEffect(()=>{window.scroll(0,0)},[Object.entries(b).flat().join(",")]),e.jsxs("div",{className:`${!a&&"min-h-screen"} bg-gray-50 relative`,children:[e.jsxs("div",{className:"mx-auto sm:px-8 py-2 grid grid-cols-1 md:grid-cols-4 gap-6",children:[l&&e.jsxs("aside",{className:"hidden md:block md:col-span-1 md:sticky md:top-24 md:self-start bg-white rounded-lg shadow-md border border-gray-200",children:[e.jsx(z,{filters:b,setFilters:S,category:x||s,subcategory:u||t,brand:n||i,slug:p||""}),e.jsx(L,{sort:N,setSort:_})]}),M?e.jsx($,{isNotFixed:!0}):q||w?.results&&w?.results.length<1?e.jsx(R,{}):e.jsxs("main",{className:`col-span-1 ${l?"md:col-span-3":"md:col-span-4"}`,children:[r&&e.jsx(V,{title:r,component:e.jsx(A,{buttons:[{label:"View All",onClick:()=>m(`/product?category=${s}&exclude=${o}`),colorClass:"bg-blue-600 text-white hover:bg-blue-700"}]})}),e.jsx(ne,{data:w?.results||[],horizontal:a,isFullDetail:h}),!a&&e.jsx(W,{handlePageChange:B,handlePageSizeChange:O,currentPage:k,pageSize:T,totalCount:w?.pagination?.total||0})]})]}),e.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-lg border-t border-gray-200 flex justify-between items-center px-4 py-3",children:l&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex-1 mr-2 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>f({isSort:!0}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"sort"})," Sort"]}),e.jsxs("button",{className:"flex-1 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>f({isFilter:!0},{}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"filter_list"})," Filter"]})]})}),e.jsx(ae,{show:y?.isFilter||!1,handleClose:()=>{j({isFilter:!1})},filters:b,setFilters:S,category:x||s,subcategory:u||t,brand:n||i,slug:p||""},y?.isFilter+""),e.jsx(re,{show:y.isSort||!1,setSort:_,sort:N,handleClose:()=>j({isSort:!1})})]},[x||"",u||"",n||""].join("-"))},ne=({data:s,horizontal:t=!1,isFullDetail:r=!1})=>e.jsx("div",{className:t?"flex overflow-x-auto space-x-4 pb-2":"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:s.map(a=>e.jsx("div",{className:t?"min-w-[400px] flex-shrink-0":"",children:e.jsx(X,{product:a,isFullDetail:r})},a._id))}),ge=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{le as P,ge as a,ue as u};
