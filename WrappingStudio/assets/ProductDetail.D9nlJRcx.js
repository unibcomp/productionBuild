import{a as se,i as Q,b as O,r as u,j as e,z as T,k as ae,e as H,g as Z,R as te,d as re,u as le,L as q}from"./index.DtIBEexY.js";import{u as X}from"./useModal.Bbkxh3H_.js";import{u as ie}from"./index.esm.BgOUue9R.js";import{P as G}from"./PageHeadline.DeVw2uh8.js";import{u as D}from"./useMutation.CN_b9VxY.js";import{a as ne}from"./queryToast.C1UcMnjS.js";import{K as B,h as U}from"./dialog.m_8JDSvp.js";import{u as oe,a as de}from"./ProductCardShimmer.Dpyy2RPl.js";import{a as ce,u as me}from"./useCart.B_olW39l.js";import{B as xe}from"./ButtonBar.BQ1RJR8G.js";import{c as J}from"./createLucideIcon.BCX05kV3.js";import W from"./Product.BVu0rs8e.js";import{W as K}from"./WishlistButton.Ckbt9Tb5.js";import{N as ue}from"./NotDataFound.h-xYpUgV.js";import"./PaginationSelecctor.C426SQRN.js";import"./usePagination.RCOujgDl.js";import"./proxy.Br7zSXCL.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ge=J("star",he);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],fe=J("thumbs-up",pe),je=async s=>(await O.post("/add-rating",s)).data,ye=async s=>(await O.post(`/like/${s}`)).data,be=async({productId:s,...a})=>(await O.get(`/rating-list/${s}`,a)).data;function ve({productId:s=""}){const a={...s&&{productId:s}};return se({queryKey:["ratings",a],queryFn:()=>be(a),enabled:!!a?.productId})}function Ne(){const s=Q();return D({mutationFn:a=>je(a),onSuccess:(a,n)=>{s.invalidateQueries({queryKey:["ratings",{productId:n.productId}]}),s.invalidateQueries({queryKey:["product",n.productId]})}})}function we(s){const a=Q();return D({mutationFn:n=>ye(n),onSuccess:(n,d)=>{const t=n._doc??n;a.setQueryData(["ratings",{productId:s}],h=>h&&{...h,ratings:h.ratings.map(o=>o._id===d?{...o,likes:t.likes??o.likes,likes_by:t.likes_by??o.likes_by}:o)})}})}function ke(s){return s??(()=>{})}const _e=()=>D({mutationFn:async s=>(await O.post("/uploads",s)).data}),Se=[1,2,3,4,5],Y=({handleClose:s,isAdd:a=!0,show:n,productId:d,refetch:t})=>{const{register:h,handleSubmit:o,setValue:j,watch:g,formState:{errors:v}}=ie({defaultValues:{rating:5,comment:"",productId:d??void 0,title:"",images:null}});u.useEffect(()=>{d&&j("productId",d)},[d,j]);const A=g("rating")??5,p=Ne(),C=_e(),[y,_]=u.useState([]),x=u.useRef(null),r=async f=>{const $=Array.from(f.target.files??[]).filter(m=>m.type.startsWith("image/")),z=6,F=5,E=Math.max(0,z-y.length),c=$.slice(0,E).filter(m=>m.size<=F*1024*1024);if(!c.length){x.current&&(x.current.value="");return}const w=new FormData;c.forEach(m=>{w.append("images",m)});try{const m=await C.mutateAsync(w);if(m?.data){const L=m.data.map(i=>i.url);_(i=>[...i,...L]),T.success("Images uploaded successfully ðŸ‘")}}catch(m){console.error("Upload error:",m);const L=C.error?.response?.data?.message||m?.response?.data?.message||m?.message||"Failed to upload images. Please try again.";T.error(L)}finally{x.current&&(x.current.value="")}},M=f=>{_($=>$.filter((z,F)=>F!==f))},P=async f=>{p.mutate({productId:f.productId,rating:f.rating,title:f.title??void 0,description:f.comment??void 0,images:y},ne(ke(t),s))},S=C.isPending,b=p.isPending,N=S||b;return e.jsx(B,{appear:!0,show:n,as:u.Fragment,children:e.jsxs(U,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(B.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(B.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(U.Panel,{className:"w-full max-w-lg transform overflow-hidden rounded-2xl bg-white p-6 shadow-xl transition-all border border-gray-200",children:[e.jsx(G,{title:a?"Add Rating":"Edit Rating"}),e.jsxs("form",{onSubmit:o(P),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating *"}),e.jsx("div",{className:"flex items-center gap-2",children:Se.map(f=>e.jsx("button",{type:"button",onClick:()=>j("rating",f),className:`p-2 rounded-md transition ${(A??0)>=f?"bg-yellow-400 text-white":"bg-gray-100 text-gray-600"}`,"aria-label":`${f} star`,disabled:N,children:"â˜…"},f))}),v.rating?.message&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.rating?.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Comment"}),e.jsx("textarea",{placeholder:"Write an optional comment...",...h("comment"),className:"mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500",rows:4,disabled:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title (optional)"}),e.jsx("input",{...h("title"),type:"text",placeholder:"Short title (e.g. 'Great quality')",className:"mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500",disabled:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images (optional)"}),e.jsx("input",{ref:x,type:"file",accept:"image/*",multiple:!0,onChange:r,className:"block",disabled:N}),S&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Uploadingâ€¦"}),y.length>0&&e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-3",children:y.map((f,$)=>e.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200",children:[e.jsx("img",{src:f,alt:`Selected ${$+1}`,className:"h-24 w-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>M($),className:"absolute top-1 right-1 h-6 w-6 flex items-center justify-center rounded-full bg-black/70 text-white text-sm opacity-90 group-hover:opacity-100","aria-label":`Remove image ${$+1}`,disabled:N,title:"Remove",children:"Ã—"})]},`${f}-${$}`))})]}),e.jsx("input",{type:"hidden",...h("productId")}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition",disabled:N,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",disabled:N,children:b?"Saving...":a?"Submit":"Save"})]})]})]})})})})]})})},Ae=(s,a)=>{const{_id:n}=ae(),d=H(),{data:t,isLoading:h,refetch:o}=oe(String(n)),{addIteamMutation:j}=ce(),{refetch:g}=me({type:"through_cart"}),[v,A]=u.useState(null),[p,C]=u.useState(!1),[y,_]=u.useState({x:0,y:0}),x=t,r=x?.productVariant??[],[M,P]=u.useState(s||""),[S,b]=u.useState(a||"");u.useEffect(()=>{(r.length>0||s)&&P(s||r[0]._id)},[r,s]);const N=u.useMemo(()=>r.find(c=>c._id===M),[M,r,s]);u.useEffect(()=>{if(N){const c=N.sizes||[];S?c.length>0&&!c.some(w=>w._id===S)&&b(c[0]?._id??""):b(a||(c[0]?._id??""))}},[N,a]);const f=c=>{P(c);const w=r.find(m=>m._id===c);w?.sizes?.length?b(w.sizes[0]._id):b(""),w?.images?.length&&A(w.images[0])},$=c=>{b(c)},z=c=>{const{left:w,top:m,width:L,height:i}=c.currentTarget.getBoundingClientRect(),k=(c.clientX-w)/L*100-20,R=(c.clientY-m)/i*100-20;_({x:k,y:R})},F=c=>{if(!Z()){d("/login");return}j.mutate(c,{onSuccess:w=>{g();const{data:m}=w;if(m.type==="direct"){d(`/checkout?cart_id=${m._id}&&type=direct`);return}T.success("Item added to cart!")},onError:()=>{T.error("Failed to add item to cart.")}})},E=N?.images?.length?N.images:x?.images||["/placeholder.png"];return{product:x,isLoading:h,refetchProduct:o,selectedImg:v,setSelectedImg:A,zoom:p,setZoom:C,mousePos:y,handleMouseMove:z,selectedVariantId:M,selectedVariant:N,selectedSizeId:S,handleColorSelect:f,handleSizeSelect:$,handleAddtoCart:F,addIteamMutation:j,images:E}},I=({label:s,value:a})=>e.jsxs("div",{className:"grid grid-cols-2 gap-2 py-1 border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("div",{className:"text-sm text-gray-900 break-words",children:a??"â€”"})]}),Ce=({manufacturingInfo:s,attributes:a=[],className:n=""})=>{const[d,t]=u.useState(!0),h=()=>!a||a.length===0?null:a.map(o=>{const j=Array.isArray(o.value)?o.value.join(", "):String(o.value);return e.jsx(I,{label:o.name,value:j},o.name)});return e.jsxs("div",{className:`mt-4 rounded-lg bg-white border border-gray-200 shadow-sm overflow-hidden ${n}`,children:[e.jsxs("button",{type:"button",onClick:()=>t(o=>!o),"aria-expanded":d,className:"w-full px-4 py-2 flex items-center justify-between text-left bg-gray-50 hover:bg-gray-100 focus:outline-none transition-all duration-200",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800",children:"Manufacturing Details"}),e.jsx("span",{className:"text-gray-600",children:d?"â–¾":"â–¸"})]}),d&&e.jsxs("div",{className:"px-4 py-3",children:[s?e.jsxs("div",{className:"bg-white p-2",children:[e.jsx(I,{label:"Generic Name",value:s.genericName}),e.jsx(I,{label:"Country of Origin",value:s.countryOfOrigin}),e.jsx(I,{label:"Manufacturer",value:s.manufacturer?`${s.manufacturer.name}${s.manufacturer.address?`, ${s.manufacturer.address}`:""}${s.manufacturer.contact?` (${s.manufacturer.contact})`:""}`:"â€”"}),s.importer&&e.jsx(I,{label:"Importer",value:`${s.importer.name}${s.importer.address?`, ${s.importer.address}`:""}${s.importer.contact?` (${s.importer.contact})`:""}`}),s.packer&&e.jsx(I,{label:"Packer",value:`${s.packer.name}${s.packer.address?`, ${s.packer.address}`:""}${s.packer.contact?` (${s.packer.contact})`:""}`})]}):null,a&&a.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Technical Specifications"}),e.jsx("div",{className:"bg-white p-2",children:h()})]}),!s&&(!a||a.length===0)&&e.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"No specifications available for this product."})]})]})},Pe=({label:s,value:a})=>e.jsxs("div",{className:"grid grid-cols-2 gap-2 py-1 border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:s}),e.jsx("div",{className:"text-sm text-gray-900 break-words",children:a??"â€”"})]}),$e=({attributes:s=[],productVariants:a=[],selectedVariantId:n,selectedSizeId:d,className:t=""})=>{const[h,o]=u.useState(!0),j=u.useMemo(()=>{const g=[];if(Array.isArray(s))for(const v of s)g.push({name:v.name,value:v.value});if(Array.isArray(a)&&a.length>0){const v=a.find(p=>p._id===n)??a[0],A=v?.sizes?.find(p=>p._id===d)??v?.sizes?.[0];if(A&&Array.isArray(A.attributes))for(const p of A.attributes){const C=g.find(y=>y.name===p.name);C?C.value=p.value:g.push({name:p.name,value:p.value})}}return g},[s,a,n,d]);return e.jsxs("div",{className:`mt-4 rounded-lg bg-white border border-gray-200 shadow-sm overflow-hidden ${t}`,children:[e.jsxs("button",{type:"button",onClick:()=>o(g=>!g),"aria-expanded":h,className:"w-full px-4 py-2 flex items-center justify-between text-left bg-gray-50 hover:bg-gray-100 focus:outline-none transition-all duration-200",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-800",children:"Specifications"}),e.jsx("span",{className:"text-gray-600",children:h?"â–¾":"â–¸"})]}),h&&e.jsx("div",{className:"px-4 py-3",children:j&&j.length>0?e.jsx("div",{className:"bg-white p-2",children:j.map(g=>{const v=Array.isArray(g.value)?g.value.join(", "):String(g.value);return e.jsx(Pe,{label:g.name,value:v},g.name)})}):e.jsx("div",{className:"text-sm text-gray-500 text-center py-2",children:"No specifications available for this product."})})]})},Me=({show:s,onClose:a,imageUrl:n})=>e.jsx(B,{appear:!0,show:s,as:u.Fragment,children:e.jsxs(U,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(B.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsx(B.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(U.Panel,{className:"relative max-w-3xl w-full rounded-lg bg-black overflow-hidden",children:[n?e.jsx("img",{src:n,alt:"Preview",className:"w-full h-auto object-contain"}):e.jsx("div",{className:"p-8 text-center text-white",children:"No image found"}),e.jsx("button",{onClick:a,className:"absolute top-3 right-3 text-white text-lg bg-black/60 rounded-full px-3 py-1 hover:bg-black/80 transition",children:"âœ•"})]})})})]})}),Re=()=>{try{const s=localStorage.getItem("token");if(!s)return null;const a=JSON.parse(atob(s.split(".")[1]||""));return a?.id||a?._id||a?.userId||null}catch{return null}},ze=(s,a)=>{const n=Array.isArray(s.likes_by)?s.likes_by:[],d=typeof s.likes=="number"?s.likes:n.length,t=!!(a&&n.includes(a));return{count:d,likedByMe:t}},Fe=({data:s,isError:a,isLoading:n,product_id:d})=>{const{openModal:t,closeModal:h,isModalOpen:o,data:j}=X(),g=H(),[v,A]=te.useState(null),{mutate:p}=we(d),C=Re(),y=r=>{r&&v!==r&&(A(r),p(r,{onSettled:()=>{A(null)},onError:M=>{console.error("Failed to like rating:",M),alert("Failed to like the rating. Please try again.")}}))},_=r=>{t(o,{imageUrl:r})},x=()=>{t(o,{imageUrl:null})};return e.jsxs("div",{className:"mt-6",children:[e.jsx(G,{title:"Review",component:e.jsx(xe,{buttons:[{label:"Add",colorClass:"bg-blue-500",onClick:()=>Z()?t({isRating:!0}):g("/login")}]})}),n?e.jsx("p",{children:"Loading ratings..."}):a?e.jsx("p",{className:"text-red-500",children:"Failed to load ratings"}):s?.ratings?.length?e.jsx("div",{className:"space-y-4 mt-4 max-h-[40vh] custom-scroll",children:s?.ratings?.map(r=>{const{count:M,likedByMe:P}=ze(r,C);return e.jsxs("div",{className:"p-4 border rounded-md bg-white shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"font-medium",children:r.title||"Untitled"}),e.jsx("div",{className:"flex items-center text-yellow-400",children:Array.from({length:5}).map((S,b)=>e.jsx(ge,{size:16,fill:b<(r.rating??0)?"currentColor":"none"},b))})]}),e.jsx("div",{className:"text-sm text-gray-500",children:r.user?.name??"Anonymous"})]}),e.jsx("div",{className:"mt-2 text-gray-700",children:r.description??r.comment??""}),Array.isArray(r.images)&&r.images.length>0&&e.jsx("div",{className:"mt-3 flex gap-2 flex-wrap",children:r.images.map((S,b)=>e.jsx("button",{type:"button",onClick:()=>_(S),className:"block w-16 h-16 border rounded-md overflow-hidden bg-gray-50 focus:outline-none",title:"Click to view",children:e.jsx("img",{src:S,alt:`review-image-${b+1}`,className:"w-full h-full object-cover",loading:"lazy"})},b))}),e.jsxs("div",{className:"flex items-center justify-between mt-3 text-sm text-gray-500",children:[e.jsx("div",{children:r.createdAt?new Date(r.createdAt).toLocaleDateString():""}),e.jsxs("button",{onClick:()=>y(r._id),disabled:v===r._id,className:"flex items-center gap-1 text-gray-600 hover:text-blue-600 transition",children:[e.jsx(fe,{size:16,className:P?"text-white":"text-blue-600",fill:P?"currentColor":"none"}),M]})]})]},r._id)})}):e.jsx("p",{className:"text-gray-500",children:"No ratings yet. Be the first to review!"}),e.jsx(Y,{show:o?.isRating||!1,handleClose:()=>h({isRating:!1}),isAdd:!0,productId:d}),e.jsx(Me,{show:!!j?.imageUrl,onClose:x,imageUrl:j?.imageUrl})]})},l=({className:s})=>e.jsx("div",{className:`animate-pulse bg-gray-200 rounded ${s}`}),Le=()=>e.jsx("div",{className:"p-2 sm:p-4 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(l,{className:"h-4 w-16"}),e.jsx(l,{className:"h-4 w-20"}),e.jsx(l,{className:"h-4 w-32"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"md:col-span-6 space-y-4",children:[e.jsx(l,{className:"h-[65vh] w-full rounded-xl"}),e.jsx("div",{className:"hidden md:flex gap-3",children:Array.from({length:4}).map((s,a)=>e.jsx(l,{className:"h-20 w-20 rounded-md"},a))}),e.jsx("div",{className:"flex md:hidden gap-3",children:Array.from({length:2}).map((s,a)=>e.jsx(l,{className:"h-64 w-full rounded-lg"},a))})]}),e.jsxs("div",{className:"md:col-span-6 space-y-4",children:[e.jsx(l,{className:"h-8 w-3/4"}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(l,{className:"h-5 w-5 rounded-full"}),e.jsx(l,{className:"h-4 w-32"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{className:"h-6 w-14 rounded-md"}),e.jsx(l,{className:"h-4 w-24"})]}),e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsx(l,{className:"h-10 w-32"}),e.jsx(l,{className:"h-6 w-20"}),e.jsx(l,{className:"h-5 w-16"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-5 w-40"}),Array.from({length:3}).map((s,a)=>e.jsx(l,{className:"h-4 w-full"},a))]}),e.jsx("div",{className:"space-y-2",children:Array.from({length:4}).map((s,a)=>e.jsx(l,{className:"h-4 w-full"},a))}),e.jsxs("div",{children:[e.jsx(l,{className:"h-5 w-20 mb-2"}),e.jsx("div",{className:"flex gap-2",children:Array.from({length:4}).map((s,a)=>e.jsx(l,{className:"h-9 w-24 rounded-full"},a))})]}),e.jsxs("div",{children:[e.jsx(l,{className:"h-5 w-16 mb-2"}),e.jsx("div",{className:"flex gap-2",children:Array.from({length:4}).map((s,a)=>e.jsx(l,{className:"h-9 w-24 rounded-full"},a))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-6 w-40"}),Array.from({length:5}).map((s,a)=>e.jsx(l,{className:"h-4 w-full"},a))]}),e.jsxs("div",{className:"hidden md:flex gap-4 mt-4",children:[e.jsx(l,{className:"h-12 w-full rounded-lg"}),e.jsx(l,{className:"h-12 w-full rounded-lg"})]})]})]}),e.jsxs("div",{className:"mt-8 space-y-3",children:[e.jsx(l,{className:"h-6 w-40"}),Array.from({length:3}).map((s,a)=>e.jsx(l,{className:"h-16 w-full rounded-md"},a))]}),e.jsxs("div",{className:"mt-10 space-y-4",children:[e.jsx(l,{className:"h-6 w-48"}),e.jsx("div",{className:"flex gap-4 overflow-hidden",children:Array.from({length:4}).map((s,a)=>e.jsx(l,{className:"h-72 w-56 rounded-lg"},a))})]}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 md:hidden bg-white p-3 flex gap-3 border-t",children:[e.jsx(l,{className:"h-12 w-full rounded-lg"}),e.jsx(l,{className:"h-12 w-full rounded-lg"})]})]})}),Ye=()=>{const[s]=re(),a=s.get("variant"),n=s.get("size"),{user:d}=le(),{product:t,isLoading:h,refetchProduct:o,selectedImg:j,setSelectedImg:g,zoom:v,setZoom:A,mousePos:p,handleMouseMove:C,selectedVariantId:y,selectedVariant:_,selectedSizeId:x,handleColorSelect:r,handleSizeSelect:M,handleAddtoCart:P,addIteamMutation:S,images:b}=Ae(a,n),{openModal:N,closeModal:f,isModalOpen:$}=X(),{data:z,isLoading:F,isError:E}=ve({productId:t?._id||""}),c=z?.ratings&&z?.ratings.length>0,{selectedPrice:w,originalPrice:m,discount:L}=u.useMemo(()=>{const i=_?.sizes.find(ee=>ee._id===x),k=i?.sell_price||0,R=i?.original_price||0,V=R?Math.round((R-k)/R*100):0;return{selectedPrice:k,originalPrice:R,discount:V}},[_,x]);return h?e.jsx(Le,{}):t?e.jsx("div",{className:"p-2 sm:p-4 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-8",children:[e.jsx("div",{className:"md:col-span-6 space-y-4 min-w-0",children:e.jsxs("div",{className:"md:sticky md:top-32 md:self-start",children:[e.jsx("div",{className:"md:hidden w-full overflow-x-auto flex gap-3 snap-x snap-mandatory",children:b.map((i,k)=>e.jsxs("div",{className:"relative w-full flex-shrink-0 h-64",children:[e.jsx("img",{src:i,alt:t.name||"Product image",className:"w-full max-w-full h-64 object-contain rounded-lg border border-gray-200 bg-white snap-center shadow-sm"}),e.jsx(K,{productId:t._id,variantId:y,isInWishlist:t.isInWishlist,className:"absolute top-2 right-2"})]},k))}),e.jsxs("div",{className:"hidden md:flex gap-4 min-w-0",children:[e.jsx("div",{className:"flex flex-col gap-2 overflow-hidden max-h-[70vh] pr-2 min-w-0",children:b.map((i,k)=>e.jsx("div",{className:`w-20 h-20 rounded-md border cursor-pointer transition-all ${j===i?"border-blue-600 ring-2 ring-blue-100 scale-105":"border-gray-200 hover:border-gray-300 hover:scale-105"}`,onClick:()=>g(i),children:e.jsx("img",{src:i,alt:`${t.name||"Product"} image ${k+1}`,className:"w-full h-full object-cover rounded-md"})},k))}),e.jsxs("div",{className:"w-full h-[50vh] md:h-[60vh] lg:h-[73vh]",children:[e.jsxs("div",{className:"relative flex-1 overflow-hidden rounded-xl border border-gray-200 bg-white shadow-md min-w-0 max-w-full h-[45vh] md:h-[55vh] lg:h-[65vh]",children:[e.jsx(K,{productId:t._id,variantId:y,isInWishlist:t.isInWishlist,className:"absolute top-3 right-3 z-20"}),e.jsx("img",{onMouseEnter:()=>A(!0),onMouseLeave:()=>A(!1),onMouseMove:C,src:j||b[0],alt:t.name||"Product",className:"w-full h-full object-contain"})]}),x&&_&&e.jsxs("div",{className:"hidden md:flex gap-4 mt-2",children:[e.jsx("button",{disabled:S.isPending,onClick:()=>P({product_id:t._id,size_Id:x,variant_id:y,type:"through_cart"}),className:"flex-1 py-3 bg-yellow-400 hover:bg-yellow-500 rounded-lg font-semibold transition disabled:opacity-70",children:"Add to Cart"}),e.jsx("button",{disabled:S.isPending,onClick:()=>P({product_id:t._id,size_Id:x,variant_id:y,type:"direct"}),className:"flex-1 py-3 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-semibold transition disabled:opacity-70",children:"Buy Now"})]})]})]})]})}),e.jsxs("div",{className:"md:col-span-6 flex flex-col space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 space-x-1",children:[e.jsx(q,{to:"/",className:"hover:underline text-gray-500",children:"Home"}),e.jsx("span",{children:"â†’"}),e.jsx(q,{to:"/product",className:"hover:underline text-gray-500",children:"Products"}),e.jsx("span",{children:"â†’"}),t.category?.name&&e.jsxs(e.Fragment,{children:[e.jsx(q,{to:`/product?category_id=${t.category._id}`,className:"hover:underline text-gray-500",children:t.category.name}),e.jsx("span",{children:"â†’"})]}),e.jsx("span",{className:"text-gray-800 font-medium",children:t.name})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("img",{src:de,alt:"Assured Logo",className:"w-5 h-5 object-contain mix-blend-multiply rounded-full"}),e.jsx("span",{className:"text-xs font-medium text-green-600",children:"Assured"})]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("p",{className:"text-sm text-gray-700 truncate",children:[t.category?.name," â€“ ",t.brand?.name]})]}),t?.ratings?.average>0&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center bg-green-600 text-white px-1.5 py-0.5 rounded-sm font-semibold",children:[e.jsx("span",{children:t?.ratings?.average.toFixed(1)}),e.jsx("span",{className:"material-symbols-outlined text-xs ml-1",children:"star"})]}),e.jsxs("span",{className:"text-gray-500 font-medium",children:[t?.ratings?.count," Ratings"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-4xl font-bold text-green-700",children:["â‚¹",w.toLocaleString("en-IN")]}),m>w&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xl line-through text-gray-500",children:["â‚¹",m.toLocaleString("en-IN")]}),e.jsxs("span",{className:"bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded",children:[L,"% off"]})]})]}),t.offers?.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Available offers"}),e.jsx("ul",{className:"text-xs space-y-1",children:t.offers.map((i,k)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600 text-lg",children:"âœ”"}),e.jsx("span",{children:i})]},k))}),t.offers.length>3&&e.jsxs("button",{className:"text-blue-600 text-xs mt-1",children:["View ",t.offers.length-3," more offers"]})]}),_&&_.sizes.length>0&&e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 space-y-1",children:(_.sizes[0].highlights||[]).map((i,k)=>e.jsx("li",{children:i},k))}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800 mb-2",children:"Color"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:t.productVariant.map(i=>e.jsx("button",{onClick:()=>r(i._id),className:`px-4 py-2 rounded-full border transition-all ${y===i._id?"border-blue-600 bg-blue-100 text-blue-800 shadow-sm":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"} text-sm font-medium`,children:i.color},i._id))})]}),_&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800 mb-2",children:"Size"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:_.sizes.map(i=>{const k=i.attributes.find(V=>V.name==="Storage"),R=k?k.value:null;return e.jsxs("button",{onClick:()=>M(i._id),className:`px-4 py-2 rounded-full border transition-all ${x===i._id?"border-green-600 bg-green-100 text-green-800 shadow-sm":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"} text-sm font-medium`,children:[i.size," ",R&&`/ ${R}`]},i._id)})})]}),e.jsx($e,{attributes:t.attributes,productVariants:t.productVariant,selectedVariantId:y,selectedSizeId:x}),e.jsx(Ce,{manufacturingInfo:t.manufacturingInfo,attributes:t.attributes}),d&&!c&&e.jsx("button",{onClick:()=>N({isRating:!0}),className:"px-6 py-3 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition shadow-md",children:"Rate this product"}),e.jsx(Fe,{data:z,isError:E,isLoading:F,product_id:t._id})]})]}),v&&e.jsx("div",{className:"fixed right-24 top-28 z-50 w-[600px] h-[450px] overflow-hidden rounded-xl border-2 border-gray-200 bg-white shadow-md",children:e.jsx("img",{src:j||b[0],alt:"Zoomed view",className:"w-full h-full object-contain transition-transform duration-200 ease-out",style:{transform:`scale(2) translate(-${p.x}%, -${p.y}%)`,transformOrigin:`${p.x}% ${p.y}%`}})}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-md flex md:hidden gap-3 p-3 z-10",children:[e.jsx("button",{disabled:S.isPending,onClick:()=>P({product_id:t._id,type:"through_cart",size_Id:x,variant_id:y}),className:"flex-1 py-3 bg-yellow-400 hover:bg-yellow-500 rounded-lg font-semibold transition disabled:opacity-70",children:"Add to Cart"}),e.jsx("button",{disabled:S.isPending,onClick:()=>P({product_id:t._id,type:"direct",size_Id:x,variant_id:y}),className:"flex-1 py-3 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-semibold transition disabled:opacity-70",children:"Buy Now"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(W,{category:t.category?._id,title:"Related Products",exclude:t._id,horizontal:!0}),e.jsx(W,{horizontal:!0,title:"Recent View",productType:"recent_look"})]}),e.jsx(Y,{show:$?.isRating||!1,handleClose:()=>f({isRating:!1}),isAdd:!0,productId:t._id,refetch:o})]})}):e.jsx(ue,{message:"Product Not Found"})};export{Ye as default};
