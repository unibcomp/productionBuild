import{r as o,d as P,j as e,i as j}from"./index.CuO4JxmZ.js";import{u as v,r as N}from"./useDepositInit.BGLJYEwn.js";import"./useMutation.BHH0QUaa.js";import"./queryToast.BPRLz0la.js";const R=()=>{const[p,s]=o.useState("â³ Navigating to payment gateway..."),[r,a]=o.useState("loading"),[l]=P(),n=l.get("payment_session_id"),{depositProcessMutation:y}=v(),{openRazorpayCheckout:g}=N(),[c,x]=o.useState(0);return o.useEffect(()=>{if(!n){a("error"),s("âŒ Payment link is invalid, expired, or already used.");return}y.mutate(n,{onSuccess:t=>{if(!t||!t.data){a("error"),s("âŒ Invalid response from server.");return}const{paymentMode:d,data:f}=t,{key:m,order_id:u,amount:i,customer:h}=f;d==="razorpay"?m&&u&&i?(x(i),g({key:m,order_id:u,amount:i,customer:h,currency:"INR"}),a("success"),s("ğŸš€ Redirecting to Razorpay...")):(a("error"),s("âŒ Missing Razorpay configuration.")):(a("error"),s(`âŒ Payment mode ${d} not supported yet.`))},onError:t=>{console.error("Deposit API Error:",t),a("error"),s("âŒ Payment link is invalid, expired, or already used.")}})},[n]),e.jsx("div",{className:"deposit-container",children:e.jsxs("div",{className:"deposit-card",children:[r==="loading"&&e.jsx(j,{}),e.jsxs("p",{className:`message ${r}`,children:[r==="loading"&&"â³ ",p]}),r==="error"&&e.jsx("button",{className:"retry-btn",onClick:()=>window.history.back(),children:"ğŸ” Try Again"}),r==="success"&&c&&e.jsx("div",{className:"text-gray-600",children:e.jsxs("p",{className:"text-sm",children:["Please wait while we process your payment of â‚¹",c]})})]})})};export{R as default};
