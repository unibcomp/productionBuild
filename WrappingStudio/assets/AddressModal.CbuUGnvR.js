import{a as y,l as b,b as l,n as q,r as n,j as e,z as x}from"./index.kHeCUqgD.js";import{u as k}from"./index.esm.DAdEF9-a.js";import{u}from"./useMutation.tTKQ-mwc.js";import{P as A}from"./PageHeadline.D63AtBSz.js";import{K as c,h as g,B as F}from"./ButtonBar.BSGV4Iyl.js";const P=async s=>(await l.get("/get-address",{params:s})).data,S=async s=>(await l.post("/create-address",s)).data,L=async s=>(await l.delete(`/delete-address/${s}`)).data,V=({pageNumber:s=1,pageSize:t=10}={})=>{const o={pageNumber:s,pageSize:t};return y({queryKey:["address",o],queryFn:()=>P(o)})},$=()=>{const s=b();return u({mutationFn:S,onSuccess:()=>s.invalidateQueries({queryKey:["address"],exact:!1})})},z=()=>{const s=b();return u({mutationFn:L,onSuccess:()=>s.invalidateQueries({queryKey:["address"],exact:!1})})},B=()=>u({mutationFn:async s=>(await l.put("/update-profile",s,{})).data}),K=async s=>(await q.get(`https://api.postalpincode.in/pincode/${s}`)).data,D=s=>y({queryKey:["pincodeData",s],queryFn:()=>K(s),enabled:s.length===6,staleTime:1e3*60*5}),I=({show:s,handleClose:t,isAdd:o,data:h,refetch:f})=>{const{register:a,handleSubmit:j,reset:v,watch:N,formState:{errors:r}}=k({defaultValues:h||{}}),w=N("postalCode"),{data:m}=D(w||""),i=n.useMemo(()=>m?.[0]?.PostOffice?.[0],[m]),p=$(),C=d=>{o&&p.mutate(d,{onSuccess:()=>{x.success("Address added successfully"),f?.(),v(),t()},onError:()=>{x.error("Failed to add address")}})};return e.jsx(c,{appear:!0,show:s,as:n.Fragment,children:e.jsxs(g,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(c.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm transition-opacity"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(c.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(g.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white p-6 shadow-xl transition-all border border-gray-200",children:[e.jsx(A,{title:o?"Add New Address":"Edit Address",component:e.jsx(F,{buttons:[{label:"X",onClick:t,colorClass:"bg-red-500"}]})}),e.jsxs("form",{onSubmit:j(C),className:"space-y-6 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name *"}),e.jsx("input",{type:"text",placeholder:"Enter full name",...a("name",{required:"Name is required"}),className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 ${r.name?"border-red-500":""}`}),r.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone *"}),e.jsx("input",{type:"text",placeholder:"Phone number",...a("phone",{required:"Phone is required"}),onInput:d=>{d.target.value=d.target.value.replace(/[^0-9]/g,"").slice(0,10)},className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 ${r.phone?"border-red-500":""}`}),r.phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.phone.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address Line 1 *"}),e.jsx("input",{type:"text",placeholder:"Street address",...a("addressLine1",{required:"Address Line 1 is required"}),className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 ${r.addressLine1?"border-red-500":""}`}),r.addressLine1&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.addressLine1.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address Line 2"}),e.jsx("input",{type:"text",placeholder:"Apartment, suite, etc. (optional)",...a("addressLine2"),className:"mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Postal Code *"}),e.jsx("input",{type:"text",placeholder:"ZIP / Postal Code",...a("postalCode",{required:"Postal Code is required"}),className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 focus:ring-indigo-500 focus:border-indigo-500 ${r.postalCode?"border-red-500":""}`,onInput:d=>{d.target.value=d.target.value.replace(/[^0-9]/g,"").slice(0,6)}}),r.postalCode&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.postalCode.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City *"}),e.jsx("input",{type:"text",placeholder:"City",defaultValue:i?.District||"",readOnly:!0,...a("city",{required:"City is required"}),className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 bg-gray-100 ${r.city?"border-red-500":""}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"State *"}),e.jsx("input",{type:"text",placeholder:"State",defaultValue:i?.State||"",readOnly:!0,...a("state",{required:"State is required"}),className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 bg-gray-100 ${r.state?"border-red-500":""}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Country *"}),e.jsx("input",{type:"text",placeholder:"Country",defaultValue:i?.Country||"",readOnly:!0,...a("country",{required:"Country is required"}),className:`mt-1 block w-full rounded-lg border border-gray-300 shadow-sm p-3 bg-gray-100 ${r.country?"border-red-500":""}`})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:t,className:"px-5 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition",disabled:p.isPending,children:"Save"})]})]})]})})})})]})})};export{I as A,B as a,z as b,V as u};
