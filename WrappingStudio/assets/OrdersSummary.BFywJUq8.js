import{c as _,q as Z,r as T,e as ee,j as e,m as te,L as H}from"./index.DSuwYhne.js";import{u as se,P as ne}from"./usePagination.Cgzfhmu5.js";import{a as re}from"./useOrder.BCNivxUk.js";import"./useMutation.YGYLZE1r.js";var V,X;function ae(){if(X)return V;X=1;var l="Expected a function",o=NaN,b="[object Symbol]",N=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,h=/^0o[0-7]+$/i,I=parseInt,L=typeof _=="object"&&_&&_.Object===Object&&_,$=typeof self=="object"&&self&&self.Object===Object&&self,y=L||$||Function("return this")(),z=Object.prototype,D=z.toString,F=Math.max,s=Math.min,n=function(){return y.Date.now()};function u(t,a,c){var p,S,E,j,i,x,w=0,q=!1,C=!1,R=!0;if(typeof t!="function")throw new TypeError(l);a=W(a)||0,v(c)&&(q=!!c.leading,C="maxWait"in c,E=C?F(W(c.maxWait)||0,a):E,R="trailing"in c?!!c.trailing:R);function M(r){var m=p,k=S;return p=S=void 0,w=r,j=t.apply(k,m),j}function J(r){return w=r,i=setTimeout(P,a),q?M(r):j}function K(r){var m=r-x,k=r-w,G=a-m;return C?s(G,E-k):G}function B(r){var m=r-x,k=r-w;return x===void 0||m>=a||m<0||C&&k>=E}function P(){var r=n();if(B(r))return U(r);i=setTimeout(P,K(r))}function U(r){return i=void 0,R&&p?M(r):(p=S=void 0,j)}function Q(){i!==void 0&&clearTimeout(i),w=0,p=x=S=i=void 0}function Y(){return i===void 0?j:U(n())}function A(){var r=n(),m=B(r);if(p=arguments,S=this,x=r,m){if(i===void 0)return J(x);if(C)return i=setTimeout(P,a),M(x)}return i===void 0&&(i=setTimeout(P,a)),j}return A.cancel=Q,A.flush=Y,A}function v(t){var a=typeof t;return!!t&&(a=="object"||a=="function")}function O(t){return!!t&&typeof t=="object"}function g(t){return typeof t=="symbol"||O(t)&&D.call(t)==b}function W(t){if(typeof t=="number")return t;if(g(t))return o;if(v(t)){var a=typeof t.valueOf=="function"?t.valueOf():t;t=v(a)?a+"":a}if(typeof t!="string")return t===0?t:+t;t=t.replace(N,"");var c=f.test(t);return c||h.test(t)?I(t.slice(2),c?2:8):d.test(t)?o:+t}return V=u,V}var ie=ae();const ce=Z(ie),le=(l,o=500)=>{const[b,N]=T.useState(l),d=T.useMemo(()=>ce(h=>{N(h)},o),[o]);return T.useEffect(()=>(d(l),()=>{d.cancel()}),[l,d]),b},xe=()=>{const{pageNumber:l,pageSizeValue:o,handlePageChange:b,handlePageSizeChange:N}=se(),d=ee(),[f,h]=T.useState(""),[I,L]=T.useState([]),$=le(f,500),{data:y,isLoading:z,isError:D}=re({pageNumber:l,pageSize:o,search:$,statusFilter:I.join(",")}),F=s=>{L(n=>n.includes(s)?n.filter(u=>u!==s):[...n,s])};return z?e.jsx(te,{}):D?e.jsx("p",{className:"p-6 text-center text-red-500",children:"Failed to load orders"}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("aside",{className:"w-full md:w-64",children:e.jsxs("div",{className:"sticky top-20 bg-white p-4 rounded shadow",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Filters"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"ORDER STATUS"}),["Placed","Pending","Processing","Delivered","Cancelled"].map(s=>e.jsxs("label",{className:"block cursor-pointer select-none",children:[e.jsx("input",{type:"checkbox",className:"mr-2",checked:I.includes(s),onChange:()=>F(s)}),s]},s))]})]})}),e.jsxs("main",{className:"flex-1",children:[e.jsx("div",{className:"top-20 z-20 mb-4",children:e.jsx("div",{className:"relative bg-white rounded shadow p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsxs("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"11",cy:"11",r:"6"}),e.jsx("path",{d:"M21 21l-4.35-4.35"})]}),e.jsx("input",{type:"text",placeholder:"Search your orders here",value:f,onChange:s=>h(s.target.value),className:"w-full pl-10 pr-3 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-300"})]}),f&&e.jsx("button",{onClick:()=>h(""),className:"px-3 py-2 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Clear"})]})})}),e.jsx("div",{className:"space-y-4",children:y?.results?.length?y.results.map(s=>{const n=s.item,u=n?.quantity||0,v=encodeURIComponent(s._id),O=encodeURIComponent(n?._id||""),g=O?`/order-details?order_id=${v}&item_id=${O}`:"";return e.jsxs("div",{className:"bg-white p-4 rounded shadow flex flex-col sm:grid sm:grid-cols-[1fr_auto] gap-4",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2 sm:hidden",children:[e.jsx("button",{onClick:()=>{d(`/product/detail/${n?.product}`)},children:n?.image&&e.jsx("img",{src:n.image,alt:n.name,className:"w-12 h-12 object-cover rounded"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h2",{className:"font-semibold text-lg truncate",children:[n?.name||"No item"," (",u," item",u>1?"s":"",")"]}),e.jsx("p",{className:`text-sm font-semibold ${s.orderStatus==="Delivered"?"text-green-600":s.orderStatus==="Pending"?"text-yellow-600":"text-red-600"}`,children:s.orderStatus})]}),g?e.jsx(H,{to:g,className:"text-blue-600 text-sm ml-2",children:"View"}):e.jsx("span",{className:"text-gray-400 text-sm ml-2",children:"No details"})]}),e.jsxs("div",{className:"hidden sm:flex sm:flex-row items-center gap-4",children:[n?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{d(`/product/detail/${n?.product}`)},children:e.jsx("img",{src:n.image,alt:n.name,className:"w-16 h-16 object-cover rounded"})}),e.jsxs("div",{className:"min-w-0 w-40",children:[e.jsx("h2",{className:"font-semibold text-lg truncate",children:n.name}),n.color&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Color: ",n.color]}),n.size?.sizeName&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Size: ",n.size.sizeName]})]})]}):e.jsx("p",{className:"text-gray-500 italic",children:"No items in this order"}),e.jsxs("div",{className:"ml-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Transaction:"," ",e.jsx("span",{className:"font-mono",children:s.transaction_id})]}),e.jsxs("p",{className:"text-sm",children:["Payment:"," ",e.jsx("span",{className:s.paymentStatus==="Completed"?"text-green-600":"text-yellow-600",children:s.paymentStatus})]})]})]}),e.jsxs("div",{className:"hidden sm:block text-right mt-2 sm:mt-0 space-y-2",children:[e.jsxs("p",{className:"font-bold text-lg",children:["₹",s.totalAmount.toLocaleString()]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[u," item(s)"]}),e.jsx("p",{className:`text-sm font-semibold ${s.orderStatus==="Delivered"?"text-green-600":s.orderStatus==="Pending"?"text-yellow-600":"text-red-600"}`,children:s.orderStatus}),g?e.jsx(H,{to:g,className:"text-blue-600 text-sm block",children:"View Details →"}):e.jsx("span",{className:"text-gray-400 text-sm block",children:"No details"})]})]},`${s._id}-${n?._id}`)}):e.jsx("p",{className:"text-center text-gray-500",children:"No orders found."})}),e.jsx(ne,{currentPage:l,handlePageChange:b,pageSize:o,handlePageSizeChange:N,totalCount:y?.pagination?.total||0})]})]})})})};export{xe as default};
