import{a as S,b as P,r as x,j as e,m as T,d as K}from"./index.C1zK8HYA.js";import{P as M}from"./ProductCard.CvgR_ZoJ.js";import{u as D,P as E}from"./usePagination.VwZ5_HsY.js";import{N as H}from"./NotDataFound.CnYD5pwj.js";import{K as b,h as F,u as A,P as B}from"./dialog.ByJYHmTR.js";const R=async s=>{const{data:t}=await P.get("/get-product",{params:s});return t},V=async s=>{const{data:t}=await P.get(`/product-details/${s}`);return t},I=({category:s,subcategory:t,brand:r,_id:a,pageSize:d=10,pageNumber:l=1,sort:g,slug:i,exclude:o})=>{const c={pageSize:d,pageNumber:l,...s&&{category:s},...t&&{subcategory:t},...r&&{brand:r},...a&&{_id:a},...g&&{sort:g},...i&&{slug:i},...o&&{exclude:o}};return S({queryKey:["products",c],queryFn:()=>R(c)})},oe=s=>S({queryKey:["product",s],queryFn:()=>V(s),enabled:!!s,staleTime:1e3*60*5}),Q=()=>{const[s,t]=x.useState({}),[r,a]=x.useState("relevance");return{filters:s,setFilters:t,sorts:r,setSorts:a}},U=async s=>{const{data:t}=await P.get("/filters",{params:s});return t},G=({category:s="",subcategory:t=""})=>{const r={...s&&{category:s},...t&&{subcategory:t}};return S({queryKey:["filters"],queryFn:()=>U(r),staleTime:300*1e3})},_=({filters:s,setFilters:t,isMobile:r=!1,category:a,subcategory:d,handleClose:l})=>{const[g,i]=x.useState(s),[o,c]=x.useState({}),{data:u,isLoading:y}=G({category:a,subcategory:d}),f=n=>{c(m=>({...m,[n]:!m[n]}))},v=(n,m)=>{m!==void 0&&i(h=>{const p=h[n]||[],j=p.includes(m)?p.filter(N=>N!==m):[...p,m];return{...h,[n]:j}})};return y?e.jsx(T,{isNotFixed:!0}):e.jsxs("div",{className:`p-4 space-y-3 ${r?"":"border-b border-gray-200"} max-h-[80vh] overflow-y-auto custom-scroll bg-white rounded-md shadow-sm`,children:[!r&&e.jsx("h2",{className:"text-lg font-semibold mb-3 border-b pb-2 text-gray-800",children:"Filters"}),u?.results?.length?e.jsxs(e.Fragment,{children:[u.results.map(n=>e.jsx(J,{label:W(n.name),queryName:n.queryName,items:n.value||[],open:o[n.queryName]||!1,onToggle:()=>f(n.queryName),filters:g,onFilterToggle:v},n.queryName)),e.jsx("div",{className:"sticky bottom-0 bg-white p-4 border-t",children:e.jsx("button",{className:"w-full py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",onClick:()=>{t(g),l?.()},children:"Apply Filters"})})]}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No filters available."})]})},J=({label:s,queryName:t,items:r,open:a,onToggle:d,filters:l,onFilterToggle:g})=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center font-semibold mb-2 px-3 py-2 border rounded-lg cursor-pointer hover:bg-gray-100",onClick:d,role:"button",tabIndex:0,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),d())},children:[s,e.jsx("span",{className:"material-symbols-outlined",children:a?"expand_more":"arrow_forward_ios"})]}),a&&e.jsx("div",{className:"pl-4 max-h-[40vh] custom-scroll overflow-auto",children:r.map(i=>{const o=i._id||i.name||"",c=l[t]?.includes(o)||!1;return e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("input",{type:"checkbox",className:"mr-2 cursor-pointer",onChange:()=>g(t,o),checked:c,id:`${t}-${o}`}),e.jsx("label",{htmlFor:`${t}-${o}`,className:"select-none cursor-pointer",children:i.name})]},o)})})]}),W=s=>s.charAt(0).toUpperCase()+s.slice(1),L=({close:s,sort:t,setSort:r})=>{const a=[{label:"Relevance",value:"relevance"},{label:"Price: Low to High",value:"lowToHigh"},{label:"Price: High to Low",value:"highToLow"}],d=l=>{r(l),s?.()};return e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3 border-b pb-2 text-gray-800",children:"Sort"}),a.map(l=>e.jsx("button",{onClick:()=>d(l.value),className:`w-full px-4 py-2 text-left rounded-md ${t===l.value?"bg-blue-100 text-blue-800":"hover:bg-gray-100"}`,children:l.label},l.value))]})},X=({show:s,filters:t,setFilters:r,handleClose:a,category:d,subcategory:l})=>e.jsx(b,{appear:!0,show:s,as:x.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(b.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(b.Child,{as:x.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(F.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(_,{filters:t,setFilters:r,category:d,subcategory:l,handleClose:a})})]})})})})]})}),Y=({show:s,handleClose:t,sort:r,setSort:a})=>e.jsx(b,{appear:!0,show:s,as:x.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(b.Child,{as:x.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(b.Child,{as:x.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(F.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Sort By"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-800",children:"✕"})]}),e.jsx(L,{close:t,sort:r,setSort:a})]})})})})]})}),Z=({category:s,subcategory:t,title:r,horizontal:a=!1,brand:d,showFilters:l=!1,isFullDetail:g=!1,exclude:i})=>{const[o]=K(),c=o.get("category"),u=o.get("subcategory"),y=o.get("slug"),f=o.get("brand"),{openModal:v,closeModal:n,isModalOpen:m}=A(),{filters:h,setFilters:p,sorts:j,setSorts:N}=Q();console.log(h);const{handlePageChange:$,handlePageSizeChange:q,pageNumber:C,pageSizeValue:k}=D(),{data:w,isLoading:z,isError:O}=I({category:c||s,subcategory:u||t,brand:f||d,pageNumber:C,pageSize:k,...h,slug:y?String(y):void 0,sort:j,exclude:i});return console.log(u),e.jsxs("div",{className:"min-h-screen bg-gray-50 relative",children:[e.jsxs("div",{className:"mx-auto sm:px-8 py-2 grid grid-cols-1 md:grid-cols-4 gap-6",children:[l&&e.jsxs("aside",{className:"hidden md:block md:col-span-1 md:sticky md:top-24 md:self-start bg-white rounded-lg shadow-md border border-gray-200",children:[e.jsx(_,{filters:h,setFilters:p,category:c||s,subcategory:u||t}),e.jsx(L,{sort:j,setSort:N})]}),z?e.jsx(T,{isNotFixed:!0}):O||w?.results&&w?.results.length<1?e.jsx(H,{}):e.jsxs("main",{className:`col-span-1 ${l?"md:col-span-3":"md:col-span-4"}`,children:[r&&e.jsx(B,{title:r||"Product"}),e.jsx(ee,{data:w?.results||[],horizontal:a,isFullDetail:g}),!a&&e.jsx(E,{handlePageChange:$,handlePageSizeChange:q,currentPage:C,pageSize:k,totalCount:w?.pagination?.total||0})]})]}),e.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-lg border-t border-gray-200 flex justify-between items-center px-4 py-3",children:l&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex-1 mr-2 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>v({isSort:!0}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"sort"})," Sort"]}),e.jsxs("button",{className:"flex-1 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>v({isFilter:!0},{}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"filter_list"})," Filter"]})]})}),e.jsx(X,{show:m?.isFilter||!1,handleClose:()=>{n({isFilter:!1})},filters:h,setFilters:p,category:c||s,subcategory:u||t},m?.isFilter+""),e.jsx(Y,{show:m.isSort||!1,setSort:N,sort:j,handleClose:()=>n({isSort:!1})})]},[c||"",u||"",f||""].join("-"))},ee=({data:s,horizontal:t=!1,isFullDetail:r=!1})=>e.jsx("div",{className:t?"flex overflow-x-auto space-x-4 pb-2":"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:s.map(a=>e.jsx("div",{className:t?"min-w-[400px] flex-shrink-0":"",children:e.jsx(M,{product:a,isFullDetail:r})},a._id))}),ne=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));export{Z as P,ne as a,oe as u};
