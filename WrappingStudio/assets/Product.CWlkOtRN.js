import{a as P,b as C,j as e,L as I,r as u,m as $,e as K,d as D}from"./index.CGZbVMlQ.js";import{W as H}from"./WishlistButton.CBLBZrhu.js";import{u as W,P as R}from"./usePagination.mf-c2P6t.js";import{N as V}from"./NotDataFound.4LR68M-3.js";import{K as y,h as F,P as A,B as Q}from"./ButtonBar.DBFN_AtQ.js";import{u as U}from"./useModal.CpaDqCV-.js";const G=async s=>{const{data:t}=await C.get("/get-product",{params:s});return t},J=async s=>{const{data:t}=await C.get(`/product-details/${s}`);return t},X=({category:s,subcategory:t,brand:r,_id:a,pageSize:l=10,pageNumber:n=1,sort:c,slug:i,exclude:g,size:d=[],colour:m=[]})=>{const x={pageSize:l,pageNumber:n,...s&&{category:s},...t&&{subcategory:t},...r&&{brand:r},...a&&{_id:a},...c&&{sort:c},...i&&{slug:i},...g&&{exclude:g},...d.length>0&&{size:d},...m.length>0&&{colour:m}};return P({queryKey:["products",x],queryFn:()=>G(x)})},ge=s=>P({queryKey:["product",s],queryFn:()=>J(s),enabled:!!s,staleTime:1e3*60*5}),Y=({product:s,isFullDetail:t})=>{const r=s.variant?.images?.[0],a=`/product/detail/${s._id}?variant=${s.variant?._id}&size=${s.variant?.size?._id}`,l=s?.name?.length>60?`${s.name.slice(0,57)}...`:s?.name;return e.jsxs("div",{className:"relative flex flex-col h-full border border-gray-200 rounded-xl bg-white shadow-sm hover:shadow-md hover:border-gray-300 transition-all duration-200 overflow-hidden group",children:[e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsx(H,{productId:s._id,variantId:s.variant?._id,isInWishlist:s.isInWishlist})}),e.jsxs(I,{to:a,className:"flex flex-col flex-grow p-3",children:[r?e.jsx("img",{src:r,alt:l,loading:"lazy",className:"w-full h-44 object-contain rounded-lg transition-transform duration-300 group-hover:scale-105"}):e.jsx("div",{className:"w-full h-44 bg-gray-100 flex items-center justify-center rounded-lg text-gray-400 text-sm",children:"No Image"}),e.jsxs("div",{className:"mt-3 flex flex-col flex-grow justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold truncate w-full text-gray-900",title:s.name,children:s.name}),e.jsx("p",{className:"text-xs text-gray-500 font-medium truncate",children:s.brand?.name})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsxs("p",{className:"text-base font-bold text-gray-900",children:["₹ ",Number(s.variant?.size?.sell_price).toFixed(2)]}),s.variant?.size&&s.variant?.size?.original_price>s.variant?.size?.sell_price&&e.jsxs("p",{className:"text-gray-400 text-xs line-through",children:["₹ ",Number(s.variant?.size?.original_price).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm mt-2",children:[e.jsxs("div",{className:"flex items-center bg-green-600 text-white px-2 py-0.5 rounded-md font-semibold",children:[e.jsx("span",{children:s?.ratings?.average.toFixed(1)}),e.jsx("span",{className:"material-symbols-outlined text-xs ml-1",children:"star"})]}),e.jsxs("span",{className:"text-gray-500 font-medium",children:[s?.ratings?.count||0," Ratings"]})]}),t&&e.jsx("div",{className:"mt-3 border-t border-gray-100 pt-2",children:e.jsx("ul",{className:"list-disc list-inside space-y-1 text-gray-700 text-xs",children:s?.variant?.size?.highlights.map((n,c)=>e.jsx("li",{className:"truncate",title:n,children:n},c))})})]})]})]})},Z=()=>{const[s,t]=u.useState({}),[r,a]=u.useState("relevance");return{filters:s,setFilters:t,sorts:r,setSorts:a}},ee=async s=>{const{data:t}=await C.get("/filters",{params:s});return t},se=({category:s="",subcategory:t="",brand:r="",slug:a=""})=>{const l={...s&&{category:s},...t&&{subcategory:t},...r&&{brand:r},...a&&{slug:a}};return P({queryKey:["filters",l],queryFn:()=>ee(l),staleTime:300*1e3})},q=({filters:s,setFilters:t,isMobile:r=!1,category:a,subcategory:l,brand:n,handleClose:c,slug:i})=>{const[g,d]=u.useState({}),{data:m,isLoading:x}=se({category:a,subcategory:l,brand:n,slug:i});u.useEffect(()=>t({}),[n]);const b=o=>d(h=>({...h,[o]:!h[o]})),f=(o,h)=>{h&&(t(v=>{const p=v[o]||[],j=p.includes(h)?p.filter(N=>N!==h):[...p,h];return{...v,[o]:j}}),c?.())};return x?e.jsx($,{isNotFixed:!0}):e.jsxs("div",{className:`p-3 space-y-2 ${r?"":"border-b border-gray-200"} max-h-[80vh] w-64 overflow-y-auto custom-scroll bg-white rounded-lg shadow-md`,children:[!r&&e.jsx("h2",{className:"text-md font-semibold mb-2 border-b pb-1 text-gray-800",children:"Filters"}),m?.results?.length?m.results.map(o=>e.jsx(te,{label:ae(o.name),queryName:o.queryName,items:o.value||[],open:g[o.queryName]||!1,onToggle:()=>b(o.queryName),filters:s,onFilterToggle:f},o.queryName)):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No filters available."})]})},te=({label:s,queryName:t,items:r,open:a,onToggle:l,filters:n,onFilterToggle:c})=>e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between items-center font-medium mb-1 px-2 py-1 border rounded-md cursor-pointer hover:bg-gray-100",onClick:l,role:"button",tabIndex:0,onKeyDown:i=>{(i.key==="Enter"||i.key===" ")&&(i.preventDefault(),l())},children:[s,e.jsx("span",{className:"material-symbols-outlined text-sm",children:a?"expand_more":"arrow_forward_ios"})]}),a&&e.jsx("div",{className:"pl-3 max-h-40 overflow-auto custom-scroll",children:r.map(i=>{const g=i._id||i.name||"",d=n[t]?.includes(g)||!1;return e.jsxs("label",{className:"flex items-center mb-1 cursor-pointer text-sm",children:[e.jsx("input",{type:"checkbox",className:"mr-2",checked:d,onChange:()=>c(t,g)}),i.name]},g)})})]}),ae=s=>s.charAt(0).toUpperCase()+s.slice(1),L=({close:s,sort:t,setSort:r})=>{const a=[{label:"Relevance",value:"relevance"},{label:"Price: Low to High",value:"lowToHigh"},{label:"Price: High to Low",value:"highToLow"}];return e.jsxs("div",{className:"p-3 space-y-2 w-64 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-md font-semibold mb-2 border-b pb-1 text-gray-800",children:"Sort"}),a.map(l=>e.jsx("button",{onClick:()=>{r(l.value),s?.()},className:`w-full px-3 py-1 text-left rounded-md text-sm ${t===l.value?"bg-blue-100 text-blue-800":"hover:bg-gray-100"}`,children:l.label},l.value))]})},re=({show:s,filters:t,setFilters:r,handleClose:a,category:l,subcategory:n,brand:c,slug:i})=>e.jsx(y,{appear:!0,show:s,as:u.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:a,children:[e.jsx(y.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(y.Child,{as:u.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(F.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Filters"}),e.jsx("button",{onClick:a,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsx("div",{className:"flex-1 p-4",children:e.jsx(q,{filters:t,setFilters:r,category:l,subcategory:n,handleClose:a,brand:c,slug:i,isMobile:!0})})]})})})})]})}),le=({show:s,handleClose:t,sort:r,setSort:a})=>e.jsx(y,{appear:!0,show:s,as:u.Fragment,children:e.jsxs(F,{as:"div",className:"relative z-50",onClose:t,children:[e.jsx(y.Child,{as:u.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx(y.Child,{as:u.Fragment,enter:"ease-in-out duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"ease-in-out duration-200",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsxs(F.Panel,{className:"pointer-events-auto absolute right-0 top-0 h-full w-80 bg-white shadow-xl overflow-y-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Sort By"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-800",children:"✕"})]}),e.jsx(L,{close:t,sort:r,setSort:a})]})})})})]})}),ie=({category:s,subcategory:t,title:r,horizontal:a=!1,brand:l,showFilters:n=!1,isFullDetail:c=!1,exclude:i})=>{const g=K(),[d]=D(),m=d.get("category"),x=d.get("subcategory"),b=d.get("slug"),f=d.get("brand"),o=d.get("exclude"),{openModal:h,closeModal:v,isModalOpen:p}=U(),{filters:j,setFilters:N,sorts:S,setSorts:_}=Z(),{handlePageChange:B,handlePageSizeChange:M,pageNumber:k,pageSizeValue:T}=W(),{data:w,isLoading:O,isError:E}=X({category:m||s,subcategory:x||t,brand:f||l,pageNumber:k,pageSize:T,...j,slug:b?String(b):void 0,sort:S,exclude:o||i});return u.useEffect(()=>{window.scroll(0,0)},[Object.entries(j).flat().join(",")]),e.jsxs("div",{className:`${!a&&"min-h-screen"} bg-gray-50 relative`,children:[e.jsxs("div",{className:"mx-auto sm:px-8 py-2 grid grid-cols-1 md:grid-cols-4 gap-6",children:[n&&e.jsx("aside",{className:"hidden md:flex md:flex-col md:col-span-1 md:sticky md:top-36 md:bottom-36 space-y-4 self-start ",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-4 flex flex-col space-y-4",children:[e.jsx(q,{filters:j,setFilters:N,category:m||s,subcategory:x||t,brand:f||l,slug:b||""}),e.jsx(L,{sort:S,setSort:_})]})}),O?e.jsx($,{isNotFixed:!0}):E||w?.results&&w?.results.length<1?e.jsx(V,{}):e.jsxs("main",{className:`col-span-1 ${n?"md:col-span-3":"md:col-span-4"}`,children:[r&&a&&e.jsx(A,{title:r,component:e.jsx(Q,{buttons:[{label:"View All",onClick:()=>{const z=[s?`category=${s}`:"",i?`exclude=${i}`:""].filter(Boolean).join("&");g(`/product${z?`?${z}`:""}`)},colorClass:"bg-blue-600 text-white hover:bg-blue-700"}]})}),e.jsx(ne,{data:w?.results||[],horizontal:a,isFullDetail:c}),!a&&e.jsx(R,{handlePageChange:B,handlePageSizeChange:M,currentPage:k,pageSize:T,totalCount:w?.pagination?.total||0})]})]}),n&&e.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white shadow-lg border-t border-gray-200 flex justify-between items-center px-4 py-3",children:e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"flex-1 mr-2 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>h({isSort:!0}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"sort"})," Sort"]}),e.jsxs("button",{className:"flex-1 bg-gray-100 text-gray-800 font-semibold py-2 rounded-md flex items-center justify-center gap-1",onClick:()=>h({isFilter:!0},{}),children:[e.jsx("span",{className:"material-symbols-outlined",children:"filter_list"})," Filter"]})]})}),e.jsx(re,{show:p?.isFilter||!1,handleClose:()=>{v({isFilter:!1})},filters:j,setFilters:N,category:m||s,subcategory:x||t,brand:f||l,slug:b||""},p?.isFilter+""),e.jsx(le,{show:p.isSort||!1,setSort:_,sort:S,handleClose:()=>v({isSort:!1})})]},[m||"",x||"",f||""].join("-"))},ne=({data:s,horizontal:t=!1,isFullDetail:r=!1})=>e.jsx("div",{className:t?"flex custom-scroll space-x-4 pb-2":"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:s.map(a=>e.jsx("div",{className:t?"w-[300px] flex-shrink-0":"",children:e.jsx(Y,{product:a,isFullDetail:r})},a._id))}),he=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{ie as P,he as a,ge as u};
